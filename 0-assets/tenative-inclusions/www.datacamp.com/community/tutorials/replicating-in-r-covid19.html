<!DOCTYPE html>
<html>
  <!-- Mirrored from www.datacamp.com/community/tutorials/replicating-in-r-covid19 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 18 Feb 2021 21:27:24 GMT -->
  <!-- Added by HTTrack -->
  <meta
    http-equiv="content-type"
    content="text/html;charset=utf-8"
  /><!-- /Added by HTTrack -->

  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, user-scalable=no"
    />
    <meta
      name="google-site-verification"
      content="NXbTi7gyLQESV4NIskeE9Ka0Am8KjAtzg5gm8g38HbU"
    />
    <meta
      name="keywords"
      content="r, replicating, r programming, statistics, covid-19"
    />
    <meta name="description" content=" " />
    <title>
      (Tutorial) Estimating COVID-19&#x27;s ùëÖùë° in Real-Time (Replicating in R) -
      DataCamp
    </title>
    <link rel="canonical" href="replicating-in-r-covid19.html" />
    <link rel="author" href="https://plus.google.com/u/0/+Datacamp/" />
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="https://learn.datacamp.com/favicon.ico"
    />
    <link
      rel="chrome-webstore-item"
      href="https://chrome.google.com/webstore/detail/lbbhbkehmgbndgfdbncbmikooblghdbi"
    />
    <meta
      property="og:title"
      content="(Tutorial) Estimating COVID-19&#x27;s ùëÖùë° in Real-Time (Replicating in R)"
    />
    <meta
      property="og:image"
      content="https://cdn.datacamp.com/community/logos/medium/placeholder.jpg"
    />
    <meta property="og:url" content="replicating-in-r-covid19.html" />
    <meta property="og:type" content="article" />
    <meta property="og:published_time" content="2020-04-17T16:00:00.000Z" />
    <meta property="og:author" content="Ramnath Vaidyanathan" />
    <meta property="og:description" content=" " />
    <meta property="og:site_name" content="DataCamp Community" />
    <meta
      name="twitter:title"
      content="(Tutorial) Estimating COVID-19&#x27;s ùëÖùë° in Real-Time (Replicating in R)"
    />
    <meta name="twitter:description" content=" " />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@DataCamp" />
    <meta name="twitter:creator" content="@DataCamp" />
    <meta name="twitter:domain" content="www.datacamp.com" />
    <meta
      name="twitter:image"
      content="https://cdn.datacamp.com/community/logos/medium/placeholder.jpg"
    />
    <meta name="twitter:image:width" content="1200" />
    <meta name="twitter:image:height" content="628" />
    <meta
      name="twitter:image:alt"
      content="(Tutorial) Estimating COVID-19&#x27;s ùëÖùë° in Real-Time (Replicating in R)"
    />
    <meta
      name="article:publisher"
      content="https://www.facebook.com/DataCamp-726282547396228"
    />
    <meta name="fb:app_id" content="726282547396228" />
    <script async="" src="https://promo.datacamp.com/banner.js"></script>
    <script async="" src="https://compliance.datacamp.com/base.js"></script>
    <meta name="next-head-count" content="33" />
    <link
      rel="preload"
      href="../_next/static/chunks/main-f0b5624c3014889b3762.js"
      as="script"
    />
    <link
      rel="preload"
      href="../_next/static/chunks/webpack-8da9cabe58c6d2aa3bdd.js"
      as="script"
    />
    <link
      rel="preload"
      href="../_next/static/chunks/framework.ad7002b3a551c278f5f0.js"
      as="script"
    />
    <link
      rel="preload"
      href="../_next/static/chunks/commons.aeba1b501ee5096455a7.js"
      as="script"
    />
    <link
      rel="preload"
      href="../_next/static/chunks/pages/_app-87c1170f38154f9c4d0d.js"
      as="script"
    />
    <link
      rel="preload"
      href="../_next/static/chunks/ac46388c.70f445eb5557aa9dec72.js"
      as="script"
    />
    <link
      rel="preload"
      href="../_next/static/chunks/68f504b0.bba56c4f391a1db0815a.js"
      as="script"
    />
    <link
      rel="preload"
      href="../_next/static/chunks/78537f27.8279c7505c61cb8fea60.js"
      as="script"
    />
    <link
      rel="preload"
      href="../_next/static/chunks/adf1b103b565b7865a0f98ea967b51b3e3660c18.095266edfcdd9f646efd.js"
      as="script"
    />
    <link
      rel="preload"
      href="../_next/static/chunks/8ffc5858bf71a15f52361e7319c3ad5ceec7c325.576033b2f3878dbe8c10.js"
      as="script"
    />
    <link
      rel="preload"
      href="../_next/static/chunks/1ea862844a52e07ea30f2afd84cc366b3979d6b4.e27afa73a93d521c36e1.js"
      as="script"
    />
    <link
      rel="preload"
      href="../_next/static/chunks/de2bd6607f0d09174f6b5f6ccd214f4f3c8d6fb9.e2051ed48ad4791c2328.js"
      as="script"
    />
    <link
      rel="preload"
      href="../_next/static/chunks/0f6d78b899a1ada8a069577d0a0f2d60f5d91117.4019acfb783e806a75cb.js"
      as="script"
    />
    <link
      rel="preload"
      href="../_next/static/chunks/pages/community/tutorial-ab49573adb58f7e29045.js"
      as="script"
    />
    <style id="__jsx-3673784144">
      .logoContainer.jsx-3673784144 {
        padding-left: 10px;
      }

      .SidebarMenu.jsx-3673784144 {
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-flex-direction: row;
        -ms-flex-direction: row;
        flex-direction: row;
        -webkit-box-pack: justify;
        -webkit-justify-content: space-between;
        -ms-flex-pack: justify;
        justify-content: space-between;
        -webkit-align-items: center;
        -webkit-box-align: center;
        -ms-flex-align: center;
        align-items: center;
        position: fixed;
        z-index: 300;
        width: 100vw;
        height: 50px;
        background-color: #05192d;
      }

      .Layout--banner .SidebarMenu.jsx-3673784144 {
        top: 55px;
      }

      .icon.jsx-3673784144 {
        text-align: right;
      }

      .icon.jsx-3673784144 svg {
        margin-right: 9px;
        width: 20px;
        height: 20px;
        fill: #ffffff;
      }

      @media (min-width: 800px) {
        .SidebarMenu.jsx-3673784144 {
          z-index: 200;
          width: 220px;
          -webkit-align-items: stretch;
          -webkit-box-align: stretch;
          -ms-flex-align: stretch;
          align-items: stretch;
          top: 0;
          left: 0;
          background-image: none;
        }

        .logoContainer.jsx-3673784144 {
          padding-left: 20px;
          padding-top: 16px;
        }

        .Layout--banner .SidebarMenu.jsx-3673784144 {
          top: 80px;
        }
      }
    </style>
    <style id="__jsx-2576226853">
      .Menu.jsx-2576226853 {
        -webkit-flex: 1 1 auto;
        -ms-flex: 1 1 auto;
        flex: 1 1 auto;
        padding-top: 13px;
        background-color: #05192d;
      }

      .Layout--banner .Menu.jsx-2576226853 {
        margin-top: 105px;
      }

      .Layout--openMenu .Menu.jsx-2576226853 {
        min-height: calc(100vh - 50px - 134px);
      }

      .Layout--openMenu.Layout--banner .Menu.jsx-2576226853 {
        min-height: calc(100vh - 105px - 134px);
      }

      .section.jsx-2576226853 {
        margin-bottom: 20px;
      }

      .section.jsx-2576226853 h5.jsx-2576226853 {
        margin: 0;
        font-size: 13px;
        line-height: 36px;
        text-align: left;
        text-transform: uppercase;
        padding-left: 16px;
        background-color: #05192d;
      }

      .section.jsx-2576226853 h5.jsx-2576226853 .title.jsx-2576226853 {
        opacity: 0.7;
        -webkit-letter-spacing: 3px;
        -moz-letter-spacing: 3px;
        -ms-letter-spacing: 3px;
        letter-spacing: 3px;
        color: #ffffff;
      }

      .item.jsx-2576226853 {
        margin-bottom: 1px;
        padding-left: 12px;
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-flex-direction: row;
        -ms-flex-direction: row;
        flex-direction: row;
        -webkit-align-content: center;
        -ms-flex-line-pack: center;
        align-content: center;
        font-size: 15px;
        -webkit-letter-spacing: 0.2px;
        -moz-letter-spacing: 0.2px;
        -ms-letter-spacing: 0.2px;
        letter-spacing: 0.2px;
        line-height: 40px;
        -webkit-text-decoration: none;
        text-decoration: none;
        color: #ffffff;
      }

      .statusIcon.jsx-2576226853 {
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-align-self: center;
        -ms-flex-item-align: center;
        align-self: center;
        padding: 10px;
      }

      .active.jsx-2576226853 {
        background-color: #213147;
      }

      a.jsx-2576226853:hover {
        background-color: #213147;
      }

      .image.jsx-2576226853 {
        margin-top: 2px;
        margin-right: 3px;
        -webkit-flex: 0 0 auto;
        -ms-flex: 0 0 auto;
        flex: 0 0 auto;
        width: 30px;
        height: 30px;
        text-align: center;
      }

      .image.jsx-2576226853 svg {
        color: #ffffff;
        fill: #ffffff;
      }

      .active.jsx-2576226853 svg,
      a.jsx-2576226853:hover svg {
        color: #03ef62;
        fill: #03ef62;
      }

      .text.jsx-2576226853 {
        -webkit-flex: 1 1 auto;
        -ms-flex: 1 1 auto;
        flex: 1 1 auto;
      }

      .subMenu.jsx-2576226853 {
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
      }

      @media (min-width: 800px) {
        .Menu.jsx-2576226853 {
          position: fixed;
          width: 220px;
          margin-top: 50px;
        }

        .Layout--banner .Menu.jsx-2576226853 {
          margin-top: 130px;
        }

        .section.jsx-2576226853 h5.jsx-2576226853 {
          padding-left: 16;
        }
      }
    </style>
    <style id="__jsx-1169100422">
      .Button.jsx-1169100422 {
        display: -webkit-inline-box;
        display: -webkit-inline-flex;
        display: -ms-inline-flexbox;
        display: inline-flex;
        -webkit-box-pack: center;
        -webkit-justify-content: center;
        -ms-flex-pack: center;
        justify-content: center;
        -webkit-align-items: center;
        -webkit-box-align: center;
        -ms-flex-align: center;
        align-items: center;
        -webkit-flex: 0 0 auto;
        -ms-flex: 0 0 auto;
        flex: 0 0 auto;
        height: 33px;
        margin: auto 5px;
        padding: 0 15px;
        font-size: 13px;
        font-weight: bold;
        -webkit-letter-spacing: 0.2px;
        -moz-letter-spacing: 0.2px;
        -ms-letter-spacing: 0.2px;
        letter-spacing: 0.2px;
        white-space: nowrap;
        color: #3a3a3a;
        border: 1px solid transparent;
        border-radius: 4px;
        background-color: transparent;
        cursor: pointer;
        outline: none;
      }

      .Button.jsx-1169100422::before,
      .Button.jsx-1169100422::after {
        content: "";
        -webkit-flex: 1 0 auto;
        -ms-flex: 1 0 auto;
        flex: 1 0 auto;
      }

      .icon.jsx-1169100422 {
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        min-height: 20px;
      }

      .icon.jsx-1169100422 svg {
        -webkit-flex: 1 1 0;
        -ms-flex: 1 1 0;
        flex: 1 1 0;
        height: 20px;
        -webkit-align-self: center;
        -ms-flex-item-align: center;
        align-self: center;
        fill: #06bdfc;
      }

      .greyIcon.jsx-1169100422 .icon.jsx-1169100422 svg {
        min-width: 16px;
        min-height: 16px;
        fill: #3a3a3a;
      }

      .same.jsx-1169100422 .icon.jsx-1169100422 {
        min-width: 13px;
        height: 13px;
        margin-right: 5px;
      }

      .same.jsx-1169100422 .icon.jsx-1169100422 svg {
        height: 13px;
      }

      .Button.jsx-1169100422:disabled,
      .Button.jsx-1169100422:hover.jsx-1169100422:disabled {
        color: #d1d3d8;
        background-color: #e6eaeb;
      }

      .primary.jsx-1169100422 {
        background-color: #ffc844;
      }

      .primary.jsx-1169100422:hover {
        background-color: #fbe28d;
      }

      .secondary.jsx-1169100422 {
        color: #ffffff;
        background-color: #06bdfc;
      }

      .secondary.jsx-1169100422:hover {
        background-color: #7ecce2;
      }

      .red.jsx-1169100422 {
        color: #ffffff;
        background-color: #fe5c5c;
      }

      .green.jsx-1169100422 {
        height: 35px;
        color: #ffffff;
        background-color: #ffffff;
      }

      .green.jsx-1169100422 .icon.jsx-1169100422 svg {
        fill: #36d57d;
        width: 35px;
        height: 35px;
      }

      .grey.jsx-1169100422 {
        color: #3d4251;
        background-color: #d1d3d8;
      }

      .grey.jsx-1169100422:hover {
        color: #3d4251;
        background-color: #e6eaeb;
      }

      .big.jsx-1169100422 {
        font-size: 15px;
        height: 42px;
      }

      .extra.jsx-1169100422 {
        font-size: 17px;
        height: 45px;
      }

      .border.jsx-1169100422 {
        border: 1px solid #e3e7e8;
      }

      .border.jsx-1169100422:hover {
        border: 1px solid #06bdfc;
      }

      .seeAll.jsx-1169100422 {
        border: 1px solid #06bdfc;
      }

      .seeAll.jsx-1169100422:hover {
        border: 1px solid #ffc844;
      }

      .iconButton.jsx-1169100422:hover {
        color: #06bdfc;
      }

      .minWidth.jsx-1169100422 {
        min-width: 85px;
      }

      .noPadding.jsx-1169100422 {
        padding: 0;
      }

      @media (min-width: 800px) {
        .icon.jsx-1169100422 {
          min-width: 13px;
          height: 13px;
          margin-right: 5px;
        }

        .icon.jsx-1169100422 svg {
          height: 13px;
        }

        .big.jsx-1169100422 .icon.jsx-1169100422 {
          min-width: 15px;
          height: 15px;
        }

        .big.jsx-1169100422 svg {
          height: 15px;
        }

        .extra.jsx-1169100422 .icon.jsx-1169100422,
        .extraIcon.jsx-1169100422 {
          min-width: 17px;
          height: 17px;
        }

        .extra.jsx-1169100422 svg,
        .extraIcon.jsx-1169100422 svg {
          height: 17px;
        }

        .green.jsx-1169100422 {
          padding: 0 15px;
          color: #ffffff;
          background-color: #36d57d;
        }

        .green.jsx-1169100422 .icon.jsx-1169100422 svg {
          width: 13px;
          height: 13px;
          fill: #ffffff;
        }

        .forcePadding.jsx-1169100422 {
          padding: 0 15px;
        }
      }
    </style>
    <style id="__jsx-2098455175">
      .ActionBarSearch.jsx-2098455175 {
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-flex-direction: row;
        -ms-flex-direction: row;
        flex-direction: row;
        -webkit-align-items: center;
        -webkit-box-align: center;
        -ms-flex-align: center;
        align-items: center;
        -webkit-box-pack: start;
        -webkit-justify-content: flex-start;
        -ms-flex-pack: start;
        justify-content: flex-start;
      }
    </style>
    <style id="__jsx-3698045554">
      .ActionBarAuth.jsx-3698045554 {
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-flex-direction: row;
        -ms-flex-direction: row;
        flex-direction: row;
        -webkit-align-items: center;
        -webkit-box-align: center;
        -ms-flex-align: center;
        align-items: center;
        -webkit-box-pack: end;
        -webkit-justify-content: flex-end;
        -ms-flex-pack: end;
        justify-content: flex-end;
      }

      .wrapper.jsx-3698045554 {
        display: -webkit-inline-box;
        display: -webkit-inline-flex;
        display: -ms-inline-flexbox;
        display: inline-flex;
        -webkit-flex-direction: row;
        -ms-flex-direction: row;
        flex-direction: row;
        -webkit-align-items: center;
        -webkit-box-align: center;
        -ms-flex-align: center;
        align-items: center;
        cursor: pointer;
      }

      .name.jsx-3698045554 {
        margin-right: 9px;
        font-size: 13px;
        font-weight: bold;
        color: #3d4251;
        -webkit-text-decoration: none;
        text-decoration: none;
      }

      .name.jsx-3698045554:hover {
        color: #06bdfc;
      }

      .logout.jsx-3698045554 {
        font-size: 15px;
        padding: 10px;
        color: #3d4251;
        display: inline-block;
        min-width: 100px;
      }

      .logout.jsx-3698045554:hover {
        background-color: #f0f4f5;
        border-bottom: solid 1px #e3e7e8;
      }

      .menuList.jsx-3698045554 a.jsx-3698045554 {
        display: block;
      }
    </style>
    <style id="__jsx-588888136">
      .ActionBar.jsx-588888136 {
        height: 50px;
        margin-top: 50px;
        padding: 0 5px;
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-flex-direction: row;
        -ms-flex-direction: row;
        flex-direction: row;
        -webkit-box-pack: justify;
        -webkit-justify-content: space-between;
        -ms-flex-pack: justify;
        justify-content: space-between;
        -webkit-align-items: center;
        -webkit-box-align: center;
        -ms-flex-align: center;
        align-items: center;
        background-color: #ffffff;
        border-bottom: 1px solid #e3e7e8;
      }

      .authBlock.jsx-588888136 {
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-fles-direction: row;
        -ms-fles-direction: row;
        fles-direction: row;
      }

      .Page.content .ActionBar {
        margin-bottom: 10px;
      }

      @media (min-width: 800px) {
        .ActionBar.jsx-588888136 {
          width: calc(100% - 220px);
          height: 50px;
          margin-top: 0;
          margin-bottom: 0;
          padding: 0 25px;
          position: fixed;
          z-index: 300;
        }
      }
    </style>
    <style id="__jsx-1582297868">
      .Title.jsx-1582297868 {
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-flex-direction: row;
        -ms-flex-direction: row;
        flex-direction: row;
        -webkit-box-pack: center;
        -webkit-justify-content: center;
        -ms-flex-pack: center;
        justify-content: center;
        -webkit-align-items: center;
        -webkit-box-align: center;
        -ms-flex-align: center;
        align-items: center;
      }

      .Title.jsx-1582297868 .icon.jsx-1582297868 {
        -webkit-flex: 0 0 auto;
        -ms-flex: 0 0 auto;
        flex: 0 0 auto;
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        min-width: 18px;
        height: 18px;
      }

      .icon.jsx-1582297868 svg {
        -webkit-flex: 1 1 0;
        -ms-flex: 1 1 0;
        flex: 1 1 0;
        height: 18px;
        -webkit-align-self: center;
        -ms-flex-item-align: center;
        align-self: center;
        fill: #06bdfc;
      }

      .Title.jsx-1582297868 .h1.jsx-1582297868,
      .Title.jsx-1582297868 h1.jsx-1582297868 {
        -webkit-flex: 0 0 auto;
        -ms-flex: 0 0 auto;
        flex: 0 0 auto;
        margin: auto 0 auto 9px;
        font-size: 22px;
        text-transform: capitalize;
      }

      .Title.jsx-1582297868 .status.jsx-1582297868 {
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-align-self: center;
        -ms-flex-item-align: center;
        align-self: center;
        padding: 10px;
      }
    </style>
    <style id="__jsx-1615743782">
      .TitleBar.jsx-1615743782 {
        height: 50px;
        padding: 0 5px;
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-flex-direction: row;
        -ms-flex-direction: row;
        flex-direction: row;
        -webkit-flex-wrap: wrap;
        -ms-flex-wrap: wrap;
        flex-wrap: wrap;
        -webkit-box-pack: justify;
        -webkit-justify-content: space-between;
        -ms-flex-pack: justify;
        justify-content: space-between;
        -webkit-align-items: center;
        -webkit-box-align: center;
        -ms-flex-align: center;
        align-items: center;
        line-height: 50px;
        background-color: #ffffff;
        border-bottom: 1px solid #e3e7e8;
        margin-bottom: 65px;
      }

      .filter.jsx-1615743782 {
        -webkit-flex: 1 1 auto;
        -ms-flex: 1 1 auto;
        flex: 1 1 auto;
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-align-items: center;
        -webkit-box-align: center;
        -ms-flex-align: center;
        align-items: center;
        height: 48px;
      }

      .action.jsx-1615743782 {
        -webkit-flex: 0 0 auto;
        -ms-flex: 0 0 auto;
        flex: 0 0 auto;
        line-height: normal;
      }

      .title.jsx-1615743782 {
        height: 65px;
        line-height: 65px;
        -webkit-flex: 0 0 100%;
        -ms-flex: 0 0 100%;
        flex: 0 0 100%;
        -webkit-order: 1;
        -ms-flex-order: 1;
        order: 1;
        text-align: center;
      }

      h1.jsx-1615743782 {
        margin: 0 0;
      }

      .Page.content .TitleBar {
        display: none;
      }

      @media (min-width: 800px) {
        .TitleBar.jsx-1615743782 {
          height: 50px;
          padding: 0 25px;
          display: -webkit-box !important;
          display: -webkit-flex !important;
          display: -ms-flexbox !important;
          display: flex !important;
          -webkit-flex-direction: row;
          -ms-flex-direction: row;
          flex-direction: row;
          -webkit-flex-wrap: nowrap;
          -ms-flex-wrap: nowrap;
          flex-wrap: nowrap;
          -webkit-box-pack: justify;
          -webkit-justify-content: space-between;
          -ms-flex-pack: justify;
          justify-content: space-between;
          -webkit-align-items: center;
          -webkit-box-align: center;
          -ms-flex-align: center;
          align-items: center;
          margin-bottom: 29px;
          margin-top: 50px;
          background-color: #ffffff;
          border-bottom: 1px solid #e3e7e8;
        }

        .filter.jsx-1615743782 {
          -webkit-flex: 0 0 33%;
          -ms-flex: 0 0 33%;
          flex: 0 0 33%;
          line-height: normal;
        }

        .action.jsx-1615743782 {
          display: -webkit-box;
          display: -webkit-flex;
          display: -ms-flexbox;
          display: flex;
          -webkit-box-pack: end;
          -webkit-justify-content: flex-end;
          -ms-flex-pack: end;
          justify-content: flex-end;
          line-height: normal;
          -webkit-flex: 0 0 33%;
          -ms-flex: 0 0 33%;
          flex: 0 0 33%;
        }

        .action.jsx-1615743782 a {
          line-height: 0;
        }

        .title.jsx-1615743782 {
          -webkit-order: 0;
          -ms-flex-order: 0;
          order: 0;
          -webkit-flex: 1 1 auto;
          -ms-flex: 1 1 auto;
          flex: 1 1 auto;
          text-align: center;
        }

        h1.jsx-1615743782 {
          margin: 0 0;
        }
      }
    </style>
    <style id="__jsx-765279523">
      .CommentCounter.jsx-765279523 {
        width: 54px;
        height: 54px;
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-flex-direction: column;
        -ms-flex-direction: column;
        flex-direction: column;
        -webkit-box-pack: center;
        -webkit-justify-content: center;
        -ms-flex-pack: center;
        justify-content: center;
        -webkit-align-items: center;
        -webkit-box-align: center;
        -ms-flex-align: center;
        align-items: center;
        border-radius: 4px;
        border: 1px solid #e6eaeb;
        background-color: #f0f4f5;
        cursor: pointer;
      }

      .CommentCounter.jsx-765279523 .icon.jsx-765279523 {
        font-size: 13px;
        line-height: 0;
        color: #06bdfc;
      }

      .CommentCounter.jsx-765279523 .icon.jsx-765279523 svg {
        width: 16px;
        height: 16px;
        fill: #06bdfc;
      }

      .CommentCounter.jsx-765279523 .count.jsx-765279523 {
        font-size: 13px;
        font-weight: bold;
        -webkit-letter-spacing: 0.2px;
        -moz-letter-spacing: 0.2px;
        -ms-letter-spacing: 0.2px;
        letter-spacing: 0.2px;
        color: #686f75;
      }

      .CommentCounter.jsx-765279523:hover {
        background-color: #ffffff;
      }
    </style>
    <style id="__jsx-1727309017">
      .Upvote.jsx-1727309017 {
        position: relative;
        width: 54px;
        height: 54px;
        overflow: hidden;
        border-radius: 4px;
        border: 1px solid #e6eaeb;
        background-color: #f0f4f5;
        cursor: pointer;
      }

      .Upvote.news.jsx-1727309017 {
        width: 45px;
        height: 35px;
        border: none;
        background-color: transparent;
      }

      .Upvote.comment.jsx-1727309017 {
        width: 45px;
        height: 25px;
        border: none;
        background-color: transparent;
      }

      .Upvote.jsx-1727309017 > div.jsx-1727309017 {
        position: absolute;
        top: 0;
        -webkit-transition: all 0.15s ease-in-out;
        transition: all 0.15s ease-in-out;
      }

      .Upvote.upvoted.jsx-1727309017 > div.jsx-1727309017 {
        top: -54px;
      }

      .Upvote.upvoted.news.jsx-1727309017 > div.jsx-1727309017 {
        top: -35px;
      }

      .Upvote.upvoted.comment.jsx-1727309017 > div.jsx-1727309017 {
        top: -25px;
      }

      .Upvote.jsx-1727309017 > div.jsx-1727309017 > div.jsx-1727309017 {
        display: -webkit-inline-box;
        display: -webkit-inline-flex;
        display: -ms-inline-flexbox;
        display: inline-flex;
        -webkit-flex-direction: column;
        -ms-flex-direction: column;
        flex-direction: column;
        -webkit-align-items: center;
        -webkit-box-align: center;
        -ms-flex-align: center;
        align-items: center;
        -webkit-box-pack: center;
        -webkit-justify-content: center;
        -ms-flex-pack: center;
        justify-content: center;
        width: 54px;
        height: 54px;
      }

      .Upvote.news.jsx-1727309017 > div.jsx-1727309017 > div.jsx-1727309017 {
        width: 45px;
        height: 35px;
      }

      .Upvote.comment.jsx-1727309017 > div.jsx-1727309017 > div.jsx-1727309017 {
        width: 45px;
        height: 25px;
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-flex-direction: row;
        -ms-flex-direction: row;
        flex-direction: row;
      }

      .Upvote.jsx-1727309017 .icon.jsx-1727309017 {
        font-size: 13px;
        line-height: 0;
        color: #06bdfc;
      }

      .Upvote.comment.jsx-1727309017 .icon.jsx-1727309017 {
        padding-right: 5px;
      }

      .Upvote.comment.jsx-1727309017 .count.jsx-1727309017 {
        padding-bottom: 1px;
      }

      .Upvote.jsx-1727309017 .icon.jsx-1727309017 svg {
        width: 12px;
        height: 12px;
        fill: #06bdfc;
      }

      .Upvote.jsx-1727309017 .count.jsx-1727309017 {
        font-size: 13px;
        font-weight: bold;
        -webkit-letter-spacing: 0.2px;
        -moz-letter-spacing: 0.2px;
        -ms-letter-spacing: 0.2px;
        letter-spacing: 0.2px;
        color: #686f75;
      }

      .Upvote.jsx-1727309017:hover {
        background-color: #ffffff;
      }

      .Upvote.news.jsx-1727309017:hover,
      .Upvote.comment.jsx-1727309017:hover {
        background-color: #ebf4f7;
      }

      .Upvote.news.jsx-1727309017:hover .count.jsx-1727309017,
      .Upvote.comment.jsx-1727309017:hover .count.jsx-1727309017 {
        color: #06bdfc;
      }

      .Upvote.jsx-1727309017 .voted.jsx-1727309017 {
        background-color: #06bdfc;
        border-color: #06bdfc;
      }

      .Upvote.news.jsx-1727309017 .voted.jsx-1727309017,
      .Upvote.comment.jsx-1727309017 .voted.jsx-1727309017 {
        background-color: #ffffff;
        border: none;
      }

      .Upvote.jsx-1727309017 .voted.jsx-1727309017 .icon.jsx-1727309017 svg {
        fill: undefined;
      }

      .Upvote.news.jsx-1727309017
        .voted.jsx-1727309017
        .icon.jsx-1727309017
        svg,
      .Upvote.comment.jsx-1727309017
        .voted.jsx-1727309017
        .icon.jsx-1727309017
        svg {
        fill: #36d57d;
      }

      .Upvote.jsx-1727309017 .voted.jsx-1727309017 .count.jsx-1727309017 {
        color: #ffffff;
      }

      .Upvote.news.jsx-1727309017 .voted.jsx-1727309017 .count.jsx-1727309017,
      .Upvote.comment.jsx-1727309017
        .voted.jsx-1727309017
        .count.jsx-1727309017 {
        color: #36d57d;
      }

      @media (min-width: 800px) {
        .Upvote.news.jsx-1727309017 {
          height: 45px;
        }

        .Upvote.comment.jsx-1727309017 {
          height: 25px;
        }

        .Upvote.upvoted.news.jsx-1727309017 > div.jsx-1727309017 {
          top: -45px;
        }

        .Upvote.upvoted.comment.jsx-1727309017 > div.jsx-1727309017 {
          top: -25px;
        }

        .Upvote.news.jsx-1727309017 > div.jsx-1727309017 > div.jsx-1727309017 {
          height: 45px;
        }

        .Upvote.comment.jsx-1727309017
          > div.jsx-1727309017
          > div.jsx-1727309017 {
          height: 25px;
        }
      }
    </style>
    <style id="__jsx-2027482828">
      .Social.jsx-2027482828 {
        -webkit-flex: 0 0 auto;
        -ms-flex: 0 0 auto;
        flex: 0 0 auto;
      }

      .icons.jsx-2027482828 {
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-flex-direction: row;
        -ms-flex-direction: row;
        flex-direction: row;
        -webkit-box-pack: center;
        -webkit-justify-content: center;
        -ms-flex-pack: center;
        justify-content: center;
        -webkit-align-items: center;
        -webkit-box-align: center;
        -ms-flex-align: center;
        align-items: center;
      }

      .icon.jsx-2027482828 {
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-box-pack: center;
        -webkit-justify-content: center;
        -ms-flex-pack: center;
        justify-content: center;
        -webkit-align-items: center;
        -webkit-box-align: center;
        -ms-flex-align: center;
        align-items: center;
        width: 28px;
        height: 28px;
        border: 1px solid #e3e7e8;
        background-color: #ffffff;
        border-radius: 50%;
      }

      .icon.jsx-2027482828:hover {
        background-color: #f0f4f5;
      }

      .centerIcon.jsx-2027482828 {
        margin: 0 10px;
      }

      .icon.jsx-2027482828 svg {
        fill: #686f75;
        -webkit-align-self: center;
        -ms-flex-item-align: center;
        align-self: center;
        -webkit-flex: 1 1 auto;
        -ms-flex: 1 1 auto;
        flex: 1 1 auto;
      }

      @media (min-width: 800px) {
        .Social.jsx-2027482828 {
          margin-top: 18px;
        }

        .vertical.jsx-2027482828 {
          margin-top: 10px;
        }

        .vertical.jsx-2027482828 .icons.jsx-2027482828 {
          -webkit-flex-direction: column;
          -ms-flex-direction: column;
          flex-direction: column;
        }

        .vertical.jsx-2027482828 .centerIcon.jsx-2027482828 {
          margin: 10px 0;
        }
      }
    </style>
    <style id="__jsx-1670412252">
      .Avatar.jsx-1670412252 {
        display: inline-block;
        background-size: cover;
        background-color: #e6eaeb;
        background-repeat: no-repeat;
      }
    </style>
    <style id="__jsx-886169423">
      .Author.jsx-886169423 a.jsx-886169423 {
        display: -webkit-inline-box;
        display: -webkit-inline-flex;
        display: -ms-inline-flexbox;
        display: inline-flex;
        -webkit-flex-direction: row;
        -ms-flex-direction: row;
        flex-direction: row;
        -webkit-align-items: center;
        -webkit-box-align: center;
        -ms-flex-align: center;
        align-items: center;
        cursor: pointer;
      }

      .info.jsx-886169423 {
        margin-left: 9px;
        white-space: nowrap;
      }

      .mirrored.jsx-886169423 .info.jsx-886169423 {
        margin: 0 9px 0 0;
        -webkit-order: -1;
        -ms-flex-order: -1;
        order: -1;
      }

      .name.jsx-886169423 {
        font-size: 13px;
        font-weight: bold;
        -webkit-letter-spacing: 0.2px;
        -moz-letter-spacing: 0.2px;
        -ms-letter-spacing: 0.2px;
        letter-spacing: 0.2px;
        color: #3d4251;
        -webkit-text-decoration: none;
        text-decoration: none;
      }

      .name.jsx-886169423:hover {
        color: #06bdfc;
      }

      .date.jsx-886169423 {
        font-size: 11px;
        -webkit-letter-spacing: 0.2px;
        -moz-letter-spacing: 0.2px;
        -ms-letter-spacing: 0.2px;
        letter-spacing: 0.2px;
        color: #686f75;
      }
    </style>
    <style id="__jsx-3073944448">
      .Tag.jsx-3073944448 {
        display: inline-block;
        border-radius: 4px;
        background-color: #f0f4f5;
        border: solid 1px #e6eaeb;
        -webkit-letter-spacing: 0.2px;
        -moz-letter-spacing: 0.2px;
        -ms-letter-spacing: 0.2px;
        letter-spacing: 0.2px;
        color: #686f75;
        cursor: default;
      }

      .title.jsx-3073944448 {
        line-height: 20px;
        padding: 0 8px;
        font-size: 11px;
        text-transform: uppercase;
      }

      .Tag.mustRead.jsx-3073944448 {
        background-color: #ad86ce;
        border-color: #ad86ce;
        color: #ffffff;
        font-weight: bold;
      }

      .Tag.jsx-3073944448:hover {
        background-color: #ffffff;
      }

      .Tag.mustRead.jsx-3073944448:hover {
        background-color: #ceabec;
        border-color: #ceabec;
      }
    </style>
    <style id="__jsx-3846131586">
      .TagLine.jsx-3846131586 {
        display: inline-block;
        white-space: nowrap;
      }

      .TagLine.jsx-3846131586 > .Tag {
        margin-right: 10px;
      }

      .more.jsx-3846131586 {
        font-size: 11px;
      }
    </style>
    <style id="__jsx-1575957864">
      .markdown {
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-flex-direction: column;
        -ms-flex-direction: column;
        flex-direction: column;
        -webkit-box-pack: start;
        -webkit-justify-content: flex-start;
        -ms-flex-pack: start;
        justify-content: flex-start;
        -webkit-align-items: flex-start;
        -webkit-box-align: flex-start;
        -ms-flex-align: flex-start;
        align-items: flex-start;
        font-family: "Lora", serif;
        font-size: 16px;
        padding: 1.5em;
      }

      .markdown [data-datacamp-exercise] {
        overflow: hidden;
      }

      .markdown > div {
        width: 100%;
      }

      .markdown div {
        outline: none;
      }

      .markdown hr {
        border: 0;
        border-bottom: 1px solid #e6eaeb;
        margin: 3em 0;
      }

      .markdown div[data-type="mathjax"] {
        margin: 1.5em 0;
      }

      .markdown p {
        font-family: "Lora", serif;
        font-size: 1em;
        line-height: 1.8em;
        color: #3d4251;
      }

      .markdown .powered-by-datacamp + p {
        margin-top: 1.5em !important;
      }

      .markdown p + p,
      .markdown p + img,
      .markdown p + div,
      .markdown p + table,
      .markdown p + ol,
      .markdown p + ul,
      .markdown p + nav,
      .markdown div + p,
      .markdown p + iframe,
      .markdown iframe + p,
      .markdown pre + img,
      .markdown pre + p {
        margin-top: 1.5em !important;
      }

      .markdown h2 {
        font-family: "Lato", sans-serif;
        font-size: 1.5em;
        font-weight: 700;
        color: #3d4251;
        line-height: 1.3em;
        margin: 1.5em 0 0.5em;
      }

      .markdown h3 {
        font-family: "Lato", sans-serif;
        font-size: 1.1em;
        font-weight: 700;
        color: #3d4251;
        line-height: 1.2em;
        margin: 1.5em 0 0.5em;
      }

      .markdown h4 {
        font-family: "Lato", sans-serif;
        font-size: 1em;
        font-weight: 700;
        color: #3d4251;
        line-height: 1.2em;
        margin: 1.5em 0 0.5em;
      }

      .markdown .videoWrapper {
        position: relative;
        padding-bottom: 47.25%;
        padding-top: 25px;
        height: 0;
        margin-bottom: 1.5em;
      }

      .markdown .videoWrapper iframe {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
      }

      .markdown p code,
      .markdown li code {
        display: inline-block;
        padding: 0 5px;
        border-radius: 4px;
        font-family: "Roboto Mono", monospace;
        font-size: 0.9em;
        line-height: 1.6em;
        color: #3d4251;
        background-color: #e6eaeb;
      }

      .markdown a code {
        color: #009bd8;
      }

      .markdown pre {
        padding: 1em 1.5em;
        font-family: "Roboto Mono", monospace;
        font-size: 0.9em;
        background-color: #002b36 !important;
        border-radius: 4px;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
      }

      .markdown pre code {
        padding: 0;
        font-size: 0.9em;
        line-height: 2em;
        background-color: #002b36;
        overflow-x: visible;
        -webkit-overflow-scrolling: touch;
      }

      .markdown img {
        display: block;
        -webkit-flex: 1 1 auto;
        -ms-flex: 1 1 auto;
        flex: 1 1 auto;
        margin: auto;
        max-width: 100%;
        height: auto !important;
      }

      .markdown img + p {
        margin-top: 1.5em !important;
      }

      .markdown nav + p,
      .markdown nav + div {
        margin-top: 1.5em !important;
      }

      .markdown iframe {
        width: 100%;
      }

      .markdown ul,
      .markdown ol {
        font-family: "Lora", serif;
        color: #3d4251;
        padding: 0 0 0 1em;
      }

      .markdown ul + p,
      .markdown ol + p,
      .markdown ul + div,
      .markdown ol + div,
      .markdown ul + pre,
      .markdown ol + pre {
        margin-top: 1.5em !important;
      }

      .markdown div.datacamp-exercise ul,
      .markdown div.datacamp-exercise ol {
        background-color: initial;
        margin: initial;
        padding: initial;
        width: initial;
        list-style-position: initial;
        line-height: initial;
      }

      .markdown ul.oneliner,
      .markdown ol.oneliner {
        padding: 0;
        list-style-position: inside;
        line-height: 1.5em;
      }

      .markdown li {
        line-height: 1.8em;
      }

      .markdown li + li {
        margin-top: 1em;
      }

      .markdown div.datacamp-exercise li {
        padding-left: initial;
        background-color: initial;
        font-size: initial;
        font-weight: initial;
        line-height: initial;
      }

      .markdown li p {
        margin: 0;
        font-size: 1em;
        line-height: 1.8em;
      }

      .markdown ul.oneliner li,
      .markdown ol.oneliner li {
        padding-left: 0;
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
      }

      .markdown ul ul {
        margin: 0;
        list-style: circle;
      }

      .markdown ol ol {
        margin: 0;
      }

      .markdown ol ul,
      .markdown ul ol {
        margin: 0;
      }

      .markdown a {
        font-weight: 400;
        -webkit-text-decoration: none;
        text-decoration: none;
        color: #009bd8;
      }

      .markdown a:hover {
        -webkit-text-decoration: underline;
        text-decoration: underline;
      }

      .markdown div.datacamp-exercise a {
        font-weight: initial;
        -webkit-text-decoration: initial;
        text-decoration: initial;
      }

      .markdown div.datacamp-exercise a:hover {
        -webkit-text-decoration: initial;
        text-decoration: initial;
      }

      .markdown div.datacamp-exercise li + li {
        margin-top: unset;
      }

      .markdown blockquote {
        margin: 1.5em 0;
        font-family: "Lato", sans-serif;
        color: #3d4251;
        font-weight: 300;
        font-size: 1.5em;
        font-style: italic;
        line-height: 2em;
      }

      .markdown blockquote::before {
        display: block;
        margin-bottom: 15px;
        width: 35px;
        height: 35px;
        font-family: "Lora", serif;
        font-size: 36px;
        font-weight: bold;
        font-style: normal;
        line-height: 60px;
        text-align: center;
        color: #06bdfc;
        content: "‚Äú";
        border: 1px solid #e3e7e8;
        border-radius: 50%;
      }

      .markdown table {
        width: 100% !important;
        border: 1px solid #e3e7e8;
        border-radius: 4px;
        overflow: hidden;
        border-collapse: separate;
        border-spacing: 0;
      }

      .markdown table th,
      .markdown table td {
        padding: 0.75em;
      }

      .markdown table tr th,
      .markdown table tr td {
        border: 1px solid #e3e7e8;
        vertical-align: middle;
      }

      .markdown table thead tr th {
        font-family: "Lato", sans-serif;
        background-color: #f0f4f5;
      }

      .markdown table tr:nth-child(even) {
        background-color: #f0f4f5;
      }

      .markdown table + p {
        margin-top: 1.5em !important;
      }

      .markdown table + img {
        margin-top: 1.5em !important;
      }

      .markdown table + div {
        margin-top: 1.5em !important;
      }

      .markdown .dcl-content--tab-body {
        margin-top: 0 !important;
      }

      @media (min-width: 800px) {
        .markdown {
          font-size: 20px;
          padding: 0;
        }

        .markdown h2,
        .markdown h3,
        .markdown h4 {
          margin: 1.5em 0 0.5em;
        }

        .markdown p {
          margin: 0;
        }

        .markdown li p {
          font-size: inherit;
          line-height: inherit;
        }

        .markdown ul + p,
        .markdown ol + p,
        .markdown ul + div,
        .markdown ol + div,
        .markdown ul + pre,
        .markdown ol + pre {
          margin-top: 1.5em !important;
        }

        .markdown blockquote {
          position: relative;
          margin: 50px 55px;
        }

        .markdown blockquote::before {
          position: absolute;
          left: -55px;
        }
      }

      .output_wrapper {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
      }
    </style>
    <style id="__jsx-2326038540">
      .SidebarSocial.jsx-2326038540 {
        -webkit-flex: 1 1 auto;
        -ms-flex: 1 1 auto;
        flex: 1 1 auto;
        font-size: 11px;
        font-weight: bold;
      }

      .rss.jsx-2326038540 {
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-flex-direction: row;
        -ms-flex-direction: row;
        flex-direction: row;
        -webkit-box-pack: center;
        -webkit-justify-content: center;
        -ms-flex-pack: center;
        justify-content: center;
        -webkit-align-items: center;
        -webkit-box-align: center;
        -ms-flex-align: center;
        align-items: center;
        line-height: 50px;
      }

      .rss.jsx-2326038540 svg {
        padding-right: 7px;
        fill: #ffc844;
      }

      .rss.jsx-2326038540 a.jsx-2326038540 {
        -webkit-text-decoration: none;
        text-decoration: none;
        color: #ffffff;
      }

      .rss.jsx-2326038540 a.jsx-2326038540:hover {
        -webkit-text-decoration: none;
        text-decoration: none;
        color: #ffc844;
      }

      .icons.jsx-2326038540 {
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-flex-direction: row;
        -ms-flex-direction: row;
        flex-direction: row;
        -webkit-box-pack: center;
        -webkit-justify-content: center;
        -ms-flex-pack: center;
        justify-content: center;
        -webkit-align-items: center;
        -webkit-box-align: center;
        -ms-flex-align: center;
        align-items: center;
      }

      .icon.jsx-2326038540 {
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-box-pack: center;
        -webkit-justify-content: center;
        -ms-flex-pack: center;
        justify-content: center;
        -webkit-align-items: center;
        -webkit-box-align: center;
        -ms-flex-align: center;
        align-items: center;
        margin: 0 7px;
        width: 30px;
        height: 30px;
      }

      .icon.jsx-2326038540 svg {
        fill: #ffffff;
        -webkit-align-self: center;
        -ms-flex-item-align: center;
        align-self: center;
        -webkit-flex: 1 1 0;
        -ms-flex: 1 1 0;
        flex: 1 1 0;
      }

      .icon.jsx-2326038540:hover svg {
        fill: #03ef62;
      }

      .menu.jsx-2326038540 {
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-flex-direction: row;
        -ms-flex-direction: row;
        flex-direction: row;
        -webkit-box-pack: center;
        -webkit-justify-content: center;
        -ms-flex-pack: center;
        justify-content: center;
        -webkit-align-items: center;
        -webkit-box-align: center;
        -ms-flex-align: center;
        align-items: center;
        line-height: 44px;
      }

      .menuItem.jsx-2326038540 {
        -webkit-flex: 0 0 auto;
        -ms-flex: 0 0 auto;
        flex: 0 0 auto;
        padding: 5px;
        -webkit-text-decoration: none;
        text-decoration: none;
        color: #ffffff;
      }

      .menuItem--active.jsx-2326038540,
      a.jsx-2326038540:hover {
        color: #03ef62;
      }

      @media (min-width: 800px) and (min-height: 585px) {
        .SidebarSocial.jsx-2326038540 {
          width: 220px;
          position: fixed;
          bottom: 0;
          left: 0;
        }
      }
    </style>
    <style id="__jsx-1777972523">
      .Layout.jsx-1777972523 {
        -webkit-flex: 1 1 auto;
        -ms-flex: 1 1 auto;
        flex: 1 1 auto;
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-flex-direction: column;
        -ms-flex-direction: column;
        flex-direction: column;
        -webkit-box-pack: start;
        -webkit-justify-content: flex-start;
        -ms-flex-pack: start;
        justify-content: flex-start;
        -webkit-align-items: stretch;
        -webkit-box-align: stretch;
        -ms-flex-align: stretch;
        align-items: stretch;
        background-color: #05192d;
      }

      .Layout--openMenu.jsx-1777972523 {
        min-height: 100vh;
      }

      .Main.jsx-1777972523 {
        min-height: 100vh;
        -webkit-flex: 1 1 auto;
        -ms-flex: 1 1 auto;
        flex: 1 1 auto;
        background-color: #f7f3eb;
      }

      .Layout--banner.jsx-1777972523 .Main.jsx-1777972523 {
        margin-top: 55px;
        min-height: calc(100vh - 55px);
      }

      .Layout.bar.jsx-1777972523:not(.Layout--openMenu) .SidebarSocial {
        margin-bottom: 90px;
      }

      .Layout.editor.jsx-1777972523:not(.Layout--openMenu) .SidebarSocial {
        margin-bottom: 300px;
      }

      @media (min-width: 800px) {
        .Main.jsx-1777972523 {
          margin-left: 220px;
        }

        .Layout--banner.jsx-1777972523 .Main.jsx-1777972523 {
          margin-top: 80px;
          min-height: calc(100vh - 80px);
        }

        .Layout.bar.jsx-1777972523:not(.Layout--openMenu) .SidebarSocial,
        .Layout.editor.jsx-1777972523:not(.Layout--openMenu) .SidebarSocial {
          margin-bottom: 0;
        }

        .Layout.bar.jsx-1777972523 .Main > div:last-child {
          margin-bottom: 90px;
        }

        .Layout.editor.jsx-1777972523 .Main > div:last-child {
          margin-bottom: 300px;
        }
      }
    </style>
    <style id="__jsx-1851940463">
      .Tutorial.jsx-1851940463 {
        margin: 0 0px 30px;
        padding: 20px 0 0;
        background-color: #ffffff;
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-flex-direction: column;
        -ms-flex-direction: column;
        flex-direction: column;
      }

      .preface.jsx-1851940463 {
        margin: 0 20px;
      }

      .author.jsx-1851940463 {
        margin-bottom: 10px;
      }

      h1.jsx-1851940463 {
        margin-top: 20px;
      }

      .illustration.jsx-1851940463 {
        margin-bottom: 30px;
      }

      .illustration.jsx-1851940463 img.jsx-1851940463 {
        max-width: 100%;
      }

      .Tutorial.jsx-1851940463 .social__top .voteAndSocial,
      .social__bottom.jsx-1851940463 .voteAndSocial.jsx-1851940463 {
        padding: 40px 20px 20px;
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-flex-direction: row;
        -ms-flex-direction: row;
        flex-direction: row;
        -webkit-box-pack: justify;
        -webkit-justify-content: space-between;
        -ms-flex-pack: justify;
        justify-content: space-between;
        -webkit-align-items: flex-end;
        -webkit-box-align: flex-end;
        -ms-flex-align: flex-end;
        align-items: flex-end;
      }

      .Tutorial.jsx-1851940463
        .voteAndSocial.jsx-1851940463
        > div.jsx-1851940463 {
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-flex-direction: row;
        -ms-flex-direction: row;
        flex-direction: row;
        -webkit-box-pack: start;
        -webkit-justify-content: flex-start;
        -ms-flex-pack: start;
        justify-content: flex-start;
        -webkit-align-items: center;
        -webkit-box-align: center;
        -ms-flex-align: center;
        align-items: center;
      }

      .Tutorial.jsx-1851940463
        .voteAndSocial.jsx-1851940463
        > div.jsx-1851940463
        .CommentCounter {
        margin-left: 10px;
      }

      @media (min-width: 800px) {
        .Tutorial.jsx-1851940463 {
          margin: 0 auto 30px;
          padding: 30px 100px 100px;
          max-width: 1120px;
          border-radius: 4px;
          border: 1px solid #e3e7e8;
        }

        .preface.jsx-1851940463 {
          margin: 0;
        }

        .Tutorial.jsx-1851940463 .social__top {
          position: absolute;
          margin-top: 220px;
        }

        .Tutorial.jsx-1851940463 .social__top .voteAndSocial {
          position: absolute;
          left: -100px;
          top: 0;
          width: 100px;
          height: auto;
          -webkit-flex-direction: column;
          -ms-flex-direction: column;
          flex-direction: column;
          -webkit-box-pack: start;
          -webkit-justify-content: flex-start;
          -ms-flex-pack: start;
          justify-content: flex-start;
          -webkit-align-items: center;
          -webkit-box-align: center;
          -ms-flex-align: center;
          align-items: center;
        }

        .Tutorial.jsx-1851940463
          .voteAndSocial.jsx-1851940463
          > div.jsx-1851940463 {
          -webkit-flex-direction: column;
          -ms-flex-direction: column;
          flex-direction: column;
        }

        .Tutorial.jsx-1851940463 .voteAndSocial > div .CommentCounter {
          margin-left: 0;
          margin-bottom: 10px;
        }
      }
    </style>
    <style id="__jsx-2124067752">
      * {
        box-sizing: border-box;
      }

      html,
      body {
        min-height: 100vh;
        margin: 0;
        padding: 0;
        background-image: linear-gradient(207deg, #2388b0, #33aacc);
        background-size: 100vw 100vh;
        background-attachment: fixed;
        background-repeat: no-repeat;
      }

      body.ReactModal__Body--open {
        overflow: hidden;
      }

      .ReactModal__Content {
        width: 100%;
      }

      img {
        margin: auto;
      }

      .mobileOnlyShow {
        display: block !important;
      }

      .mobileOnlyHide {
        display: none !important;
      }

      .mobileOnly {
        display: block !important;
      }

      .desktopOnly {
        display: none !important;
      }

      @media (min-width: 800px) {
        body {
          background-image: linear-gradient(207deg, #2388b0, #33aacc);
          background-size: 220px 100vh;
          background-attachment: fixed;
          background-repeat: no-repeat;
        }

        .ReactModal__Content {
          width: auto;
        }

        .mobileOnlyShow {
          display: block !important;
        }

        .mobileOnlyHide {
          display: block !important;
        }

        .mobileOnly {
          display: none !important;
        }

        .desktopOnly {
          display: block !important;
        }
      }
    </style>
    <style id="__jsx-3928222068">
      body,
      input,
      button,
      select,
      textarea {
        font-family: "Lato", sans-serif;
        color: #686f75;
        font-size: 15px;
      }

      h1,
      .h1,
      h2,
      h3,
      h4,
      h5 {
        font-family: "Lato", sans-serif;
      }

      .pageTitle {
        font-family: "Lato", sans-serif;
        font-size: 32px;
        font-weight: bold;
        line-height: 1.3em;
        margin-bottom: 0.5em;
      }

      .pageDescription {
        font-family: "Lora", serif;
        font-size: 20.8px;
        line-height: 1.5em;
        margin-bottom: 1.4em;
        color: #3d4251;
      }

      h1,
      .h1 {
        font-size: 29px;
        color: #3d4251;
        font-weight: bold;
      }

      h2 {
        font-size: 20px;
        -webkit-letter-spacing: 0.3px;
        -moz-letter-spacing: 0.3px;
        -ms-letter-spacing: 0.3px;
        letter-spacing: 0.3px;
        line-height: 1.33;
        font-weight: bold;
        margin: 18px 0px;
        color: #3d4251;
      }

      h2.blue {
        color: #06bdfc;
      }

      a {
        color: #06bdfc;
        -webkit-text-decoration: none;
        text-decoration: none;
      }

      .blocText {
        font-size: 15px;
        -webkit-letter-spacing: 0.2px;
        -moz-letter-spacing: 0.2px;
        -ms-letter-spacing: 0.2px;
        letter-spacing: 0.2px;
        line-height: 1.47;
        color: #686f75;
      }

      label {
        display: block;
        width: 100%;
        margin-bottom: 8px;
        font-size: 13px;
      }

      label span {
        float: right;
        font-weight: 300;
      }

      input,
      textarea {
        padding: 15px;
        font-weight: 300;
        color: #3d4251;
        background-color: #f0f4f5;
        border: 1px solid transparent;
        border-radius: 4px;
        outline-style: none;
      }

      input:disabled,
      textarea:disabled {
        color: #686f75;
        background-color: #e6eaeb;
      }

      input.error,
      textarea.error {
        border: 1px solid #fe5c5c;
      }

      input:focus,
      textarea:focus {
        border: 1px solid #06bdfc;
        -webkit-transition: border 150ms ease-out;
        transition: border 150ms ease-out;
      }

      input::-webkit-input-placeholder,
      textarea::-webkit-input-placeholder {
        color: #06bdfc;
        -webkit-transition: color 150ms ease-out;
        transition: color 150ms ease-out;
      }

      input::-moz-placeholder,
      textarea::-moz-placeholder {
        color: #06bdfc;
        -webkit-transition: color 150ms ease-out;
        transition: color 150ms ease-out;
      }

      input:-ms-input-placeholder,
      textarea:-ms-input-placeholder {
        color: #06bdfc;
        -webkit-transition: color 150ms ease-out;
        transition: color 150ms ease-out;
      }

      input::placeholder,
      textarea::placeholder {
        color: #06bdfc;
        -webkit-transition: color 150ms ease-out;
        transition: color 150ms ease-out;
      }

      input:focus::-webkit-input-placeholder,
      textarea:focus::-webkit-input-placeholder {
        color: transparent;
      }

      input:focus::-moz-placeholder,
      textarea:focus::-moz-placeholder {
        color: transparent;
      }

      input:focus:-ms-input-placeholder,
      textarea:focus:-ms-input-placeholder {
        color: transparent;
      }

      input:focus::placeholder,
      textarea:focus::placeholder {
        color: transparent;
      }

      input.small,
      textarea.small {
        margin-bottom: 19px;
        padding: 8px 10px;
        font-size: 13px;
      }

      textarea.small {
        min-height: 55px;
      }

      @media (min-width: 800px) {
        h1,
        .h1 {
          font-size: 36px;
        }

        h2 {
          font-size: 32px;
        }

        .pageTitle {
          font-size: 40px;
        }

        .pageDescription {
          font-size: 26px;
        }
      }
    </style>
    <script
      async
      src="https://www.datacamp.com/cdn-cgi/bm/cv/669835187/api.js"
    ></script>
  </head>

  <body>
    <div id="__next">
      <div class="Page content">
        <div class="jsx-1777972523 Layout">
          <div class="jsx-3673784144 SidebarMenu">
            <div class="jsx-3673784144 logoContainer">
              <div css="[object Object]">
                <a href="https://www.datacamp.com/"
                  ><svg
                    height="29"
                    viewBox="0 0 173 36"
                    width="139.36111111111111"
                  >
                    <g fill="none" fill-rule="evenodd">
                      <path
                        d="M42.56 27.1a5.694 5.694 0 110-11.39 5.694 5.694 0 010 11.39m5.704-20.623v8.853a8.334 8.334 0 100 12.148v1.836h2.632V6.477h-2.632zm73.28 20.622a5.694 5.694 0 110-11.389 5.694 5.694 0 010 11.39m8.333-5.695v-8.247h-2.63v2.172a8.334 8.334 0 100 12.148v1.836h2.631v-7.91h-.001zm20.987-7.634a1.296 1.296 0 011.109-.622h.507c1.075 0 1.947.872 1.947 1.947v14.218h-2.686V17.269c-1.239 2-5.674 9.25-7.003 11.424a1.296 1.296 0 01-1.108.62h-.548a1.298 1.298 0 01-1.298-1.297V17.238a1909.582 1909.582 0 00-7.31 11.954l-.074.122h-2.574v-16.16h2.684v.033l-.062 11.147 6.438-10.56a1.3 1.3 0 011.11-.622h.51c1.073 0 1.944.869 1.947 1.942 0 2.972.014 8.383.014 9.17l6.397-10.493zm-37.92 12.541a8.331 8.331 0 11.21-9.502l-2.524 1.312a5.533 5.533 0 10-.379 6.88l2.693 1.31zm51.542.8a5.693 5.693 0 01-5.68-5.352v-.682a5.694 5.694 0 115.684 6.036m0-14.028a8.298 8.298 0 00-5.684 2.24v-2.168h-2.632V35.91h2.632v-8.4a8.333 8.333 0 105.684-14.425M75.277 15.68v9.938c0 .589.478 1.067 1.067 1.067h3.064v2.629h-3.062a3.7 3.7 0 01-3.696-3.696l-.01-9.938h-2.838v-2.56h2.838V8.702h2.635v4.428h4.672v2.55h-4.67zm12.757 11.418a5.694 5.694 0 110-11.39 5.694 5.694 0 010 11.39m5.702-13.941v2.173a8.334 8.334 0 100 12.148v1.836h2.632v-16.16l-2.632.003zM60.285 27.099a5.694 5.694 0 110-11.389 5.694 5.694 0 010 11.39m5.702-13.942v2.172a8.334 8.334 0 100 12.148v1.836h2.63v-16.16l-2.63.004z"
                        fill="#ffffff"
                      ></path>
                      <path
                        d="M11.7 8.514v8.332L2.857 21.89V3.44l8.841 5.074zm2.86 17.507v-7.51l11.84-6.757-2.88-1.65-8.96 5.112V7.68a1.44 1.44 0 00-.718-1.242L3.056.256A2.066 2.066 0 000 2.07v21.184a2.067 2.067 0 002.971 1.866l.082-.042 8.64-4.932v6.72c.002.513.276.987.721 1.243L23.502 34.4l2.88-1.651L14.56 26.02z"
                        fill="#03EF62"
                      ></path>
                    </g></svg
                ></a>
              </div>
            </div>
            <div class="jsx-3673784144 icon mobileOnly">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 80 70">
                <path
                  d="M6 1a6 6 0 1 0 0 12h68a6 6 0 0 0 0-12H6zm0 28a6 6 0 1 0 0 12h68a6 6 0 0 0 0-12H6zm0 28a6 6 0 1 0 0 12h68a6 6 0 0 0 0-12H6z"
                ></path>
              </svg>
            </div>
          </div>
          <div class="jsx-2576226853 Menu mobileOnlyHide">
            <div class="jsx-2576226853 section">
              <h5 class="jsx-2576226853">
                <div class="jsx-2576226853 title">community</div>
              </h5>
              <nav class="jsx-2576226853">
                <div>
                  <a
                    target="_self"
                    href="https://www.datacamp.com/community"
                    class="jsx-2576226853 item"
                  >
                    <div class="jsx-2576226853 image">
                      <svg
                        height="14"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 23 23"
                      >
                        <path
                          id="a"
                          d="M2 4.5h20a1.5 1.5 0 0 1 0 3H2a1.5 1.5 0 0 1 0-3zm0 6h14a1.5 1.5 0 0 1 0 3H2a1.5 1.5 0 0 1 0-3zm0 6h20a1.5 1.5 0 0 1 0 3H2a1.5 1.5 0 0 1 0-3z"
                        ></path>
                      </svg>
                    </div>
                    <div class="jsx-2576226853 text">News</div>
                  </a>
                </div>
                <div>
                  <a
                    target="_self"
                    href="../tutorials.html"
                    class="jsx-2576226853 item active"
                  >
                    <div class="jsx-2576226853 image">
                      <svg
                        height="14"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 32 24.22"
                      >
                        <path
                          d="M16.23 24.22a2 2 0 0 1-.73-.14L7 20.79a2 2 0 0 1-1.29-1.88v-4a1.5 1.5 0 0 1 3 0v3.36l7.54 2.92 7.54-2.92v-3.45a1.5 1.5 0 0 1 3 0v4.09a2 2 0 0 1-1.29 1.88L17 24.08a2 2 0 0 1-.77.14zm-.35-2.94zm.7 0z"
                        ></path>
                        <path
                          d="M16.23 13.35a2 2 0 0 1-.62-.1C9.17 11.16 2.36 9 1.61 8.76a2 2 0 0 1-.25-3.87l14-4.78a2 2 0 0 1 1.3 0l14 4.78a2 2 0 0 1 0 3.81l-13.8 4.55a2 2 0 0 1-.63.1zm-.31-3zM5.21 6.74c3.49 1.11 9.07 2.92 11 3.56l10.68-3.53L16 3.05z"
                        ></path>
                      </svg>
                    </div>
                    <div class="jsx-2576226853 text">Tutorials</div>
                  </a>
                </div>
                <div>
                  <a
                    target="_self"
                    href="../data-science-cheatsheets.html"
                    class="jsx-2576226853 item"
                  >
                    <div class="jsx-2576226853 image">
                      <svg
                        height="14"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 24 26"
                      >
                        <path
                          d="M18.5 26h-13A5.51 5.51 0 0 1 0 20.5v-15A5.51 5.51 0 0 1 5.5 0h13A5.51 5.51 0 0 1 24 5.5v15a5.51 5.51 0 0 1-5.5 5.5zM5.5 3A2.5 2.5 0 0 0 3 5.5v15A2.5 2.5 0 0 0 5.5 23h13a2.5 2.5 0 0 0 2.5-2.5v-15A2.5 2.5 0 0 0 18.5 3z"
                        ></path>
                        <path
                          d="M16 11H8a1.5 1.5 0 0 1 0-3h8a1.5 1.5 0 0 1 0 3zM16 18H8a1.5 1.5 0 0 1 0-3h8a1.5 1.5 0 0 1 0 3z"
                        ></path>
                      </svg>
                    </div>
                    <div class="jsx-2576226853 text">Cheat Sheets</div>
                  </a>
                </div>
                <div>
                  <a
                    target="_self"
                    href="../open-courses.html"
                    class="jsx-2576226853 item"
                  >
                    <div class="jsx-2576226853 image">
                      <svg
                        height="14"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 34 26"
                      >
                        <path
                          d="M28.5 26h-23A5.51 5.51 0 0 1 0 20.5v-15A5.51 5.51 0 0 1 5.5 0h23A5.51 5.51 0 0 1 34 5.5v15a5.51 5.51 0 0 1-5.5 5.5zM5.5 3A2.5 2.5 0 0 0 3 5.5v15A2.5 2.5 0 0 0 5.5 23h23a2.5 2.5 0 0 0 2.5-2.5v-15A2.5 2.5 0 0 0 28.5 3z"
                        ></path>
                        <path
                          d="M13.5 26a1.5 1.5 0 0 1-1.5-1.5v-22a1.5 1.5 0 0 1 3 0v22a1.5 1.5 0 0 1-1.5 1.5zM27 11h-8a1.5 1.5 0 0 1 0-3h8a1.5 1.5 0 0 1 0 3zM27 18h-8a1.5 1.5 0 0 1 0-3h8a1.5 1.5 0 0 1 0 3z"
                        ></path>
                      </svg>
                    </div>
                    <div class="jsx-2576226853 text">Open Courses</div>
                  </a>
                </div>
                <div>
                  <a
                    target="_self"
                    href="../podcast.html"
                    class="jsx-2576226853 item"
                  >
                    <div class="jsx-2576226853 image">
                      <svg
                        height="14"
                        xmlns="http://www.w3.org/2000/svg"
                        width="18"
                        viewBox="0 0 18 18"
                      >
                        <path
                          d="M9.415 11.077h-.369a2.777 2.777 0 0 1-2.769-2.77V2.77A2.777 2.777 0 0 1 9.047 0h.368a2.777 2.777 0 0 1 2.77 2.77v5.538a2.777 2.777 0 0 1-2.77 2.769zm5.008-7.615c.573 0 1.039.464 1.039 1.038v3.462c0 3.08-2.25 5.64-5.193 6.136v1.825h2.077a1.038 1.038 0 1 1 0 2.077h-6.23a1.038 1.038 0 1 1 0-2.077h2.076v-1.825C5.25 13.602 3 11.042 3 7.962V4.5a1.038 1.038 0 1 1 2.077 0v3.462a4.158 4.158 0 0 0 4.154 4.153 4.158 4.158 0 0 0 4.154-4.153V4.5c0-.574.465-1.038 1.038-1.038z"
                        ></path>
                      </svg>
                    </div>
                    <div class="jsx-2576226853 text">Podcast - DataFramed</div>
                  </a>
                </div>
                <div>
                  <a
                    target="_self"
                    href="../chat.html"
                    class="jsx-2576226853 item"
                  >
                    <div class="jsx-2576226853 image">
                      <svg
                        height="14"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 18 16"
                      >
                        <g transform="translate(0 -1)">
                          <path
                            id="path-1"
                            d="M12.595 13.364c.01-.111.02-.197.028-.251.058-.405.372-.702.74-.702h1.257c1.035-.002 1.875-.934 1.88-2.082V4.764c-.001-1.155-.842-2.092-1.878-2.094H3.38c-1.034.002-1.873.931-1.88 2.076v5.565c.001 1.156.842 2.092 1.878 2.094h6.626c.292 0 .557.189.68.484.408.977 1.07 1.576 1.94 1.85a6.004 6.004 0 0 1-.03-1.375h.001zm1.51 1.119c.048.314.136.521.235.606.566.487.258 1.497-.458 1.497-1.87 0-3.423-.785-4.33-2.51H3.376C1.513 14.07.004 12.39 0 10.311V4.74C.014 2.673 1.52 1.004 3.378 1h11.245c1.864.004 3.373 1.686 3.377 3.763v5.57c-.01 2.07-1.518 3.744-3.378 3.748h-.551c.004.138.016.273.035.402h-.001zm-8.423-5.81a1.115 1.115 0 1 0 0-2.229 1.115 1.115 0 0 0 0 2.229zm3.268 0a1.115 1.115 0 1 0 0-2.229 1.115 1.115 0 0 0 0 2.229zm3.318 0a1.114 1.114 0 1 0 0-2.229 1.114 1.114 0 0 0 0 2.229z"
                          ></path>
                        </g>
                      </svg>
                    </div>
                    <div class="jsx-2576226853 text">Chat</div>
                  </a>
                </div>
              </nav>
            </div>
            <div class="jsx-2576226853 section">
              <h5 class="jsx-2576226853">
                <div class="jsx-2576226853 title">datacamp</div>
              </h5>
              <nav class="jsx-2576226853">
                <div>
                  <a
                    target="_self"
                    href="../blog.html"
                    class="jsx-2576226853 item"
                  >
                    <div class="jsx-2576226853 image">
                      <svg
                        viewBox="0 0 18 18"
                        aria-hidden="false"
                        height="18"
                        role="img"
                        width="18"
                      >
                        <title>DataCamp</title>
                        <path
                          d="M8.122 4.454v4.36l-4.627 2.64V1.799l4.627 2.655zm1.497 9.161v-3.93l6.195-3.535-1.507-.863L9.62 7.96V4.018a.754.754 0 00-.376-.65L3.599.133a1.08 1.08 0 00-1.6.95l.001 11.085a1.082 1.082 0 001.555.976l.042-.022 4.522-2.581v3.516c0 .27.144.517.377.651L14.298 18l1.507-.864-6.186-3.52z"
                          fill="currentColor"
                          fill-rule="evenodd"
                        ></path>
                      </svg>
                    </div>
                    <div class="jsx-2576226853 text">Official Blog</div>
                  </a>
                </div>
                <div>
                  <a
                    target="_self"
                    href="https://www.datacamp.com/resources"
                    class="jsx-2576226853 item"
                  >
                    <div class="jsx-2576226853 image">
                      <svg
                        height="14"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 24 26"
                      >
                        <path
                          d="M18.5 26h-13A5.51 5.51 0 0 1 0 20.5v-15A5.51 5.51 0 0 1 5.5 0h13A5.51 5.51 0 0 1 24 5.5v15a5.51 5.51 0 0 1-5.5 5.5zM5.5 3A2.5 2.5 0 0 0 3 5.5v15A2.5 2.5 0 0 0 5.5 23h13a2.5 2.5 0 0 0 2.5-2.5v-15A2.5 2.5 0 0 0 18.5 3z"
                        ></path>
                        <path
                          d="M16 11H8a1.5 1.5 0 0 1 0-3h8a1.5 1.5 0 0 1 0 3zM16 18H8a1.5 1.5 0 0 1 0-3h8a1.5 1.5 0 0 1 0 3z"
                        ></path>
                      </svg>
                    </div>
                    <div class="jsx-2576226853 text">Resource Center</div>
                  </a>
                </div>
                <div>
                  <a
                    target="_self"
                    href="https://www.datacamp.com/discover/webinars"
                    class="jsx-2576226853 item"
                  >
                    <div class="jsx-2576226853 image">
                      <svg
                        height="14"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 21.75 29.76"
                      >
                        <path
                          d="M15.56 22.57a1.5 1.5 0 0 1-1.5-1.5 7.66 7.66 0 0 1 2.47-5.29 7.38 7.38 0 0 0 2.21-5.31A7.48 7.48 0 0 0 11.28 3h-.82a7.47 7.47 0 0 0-5.2 12.83 7.63 7.63 0 0 1 2.42 5.23 1.5 1.5 0 0 1-3 0 4.65 4.65 0 0 0-1.45-3A10.47 10.47 0 0 1 10.47 0h.82a10.47 10.47 0 0 1 7.28 18 4.68 4.68 0 0 0-1.5 3.08 1.5 1.5 0 0 1-1.51 1.49zM16.5 24.26a5.5 5.5 0 0 1-11 0"
                        ></path>
                        <path
                          d="M10.89 22.56a1.5 1.5 0 0 1-1.5-1.5v-8.84a1.5 1.5 0 0 1 3 0v8.84a1.5 1.5 0 0 1-1.5 1.5z"
                        ></path>
                      </svg>
                    </div>
                    <div class="jsx-2576226853 text">Upcoming Events</div>
                  </a>
                </div>
              </nav>
            </div>
          </div>
          <main class="jsx-1777972523 Main">
            <div class="jsx-588888136 ActionBar">
              <div>
                <div class="jsx-2098455175 ActionBarSearch">
                  <button
                    style="font-weight: normal"
                    class="jsx-1169100422 Button extra noPadding"
                  >
                    <div class="jsx-1169100422 icon">
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 20.03 23"
                      >
                        <path
                          d="M10.39 19.29A9.65 9.65 0 1 1 20 9.65a9.66 9.66 0 0 1-9.61 9.64zm0-17.06a7.42 7.42 0 1 0 7.42 7.42 7.43 7.43 0 0 0-7.42-7.42z"
                        ></path>
                        <path
                          d="M1.11 23a1.11 1.11 0 0 1-.89-1.78l4.1-5.47a1.11 1.11 0 1 1 1.78 1.34L2 22.56a1.11 1.11 0 0 1-.89.44z"
                        ></path>
                      </svg>
                    </div>
                    <div class="jsx-1169100422 desktopOnly">Search</div>
                  </button>
                </div>
              </div>
              <div class="jsx-588888136 authBlock">
                <div></div>
                <div class="jsx-3698045554 ActionBarAuth">
                  <div class="jsx-3698045554">
                    <a
                      href="https://www.datacamp.com/users/sign_in?redirect=https://www.datacamp.com/community"
                      class="jsx-3698045554"
                      ><button class="jsx-1169100422 Button border minWidth">
                        <div class="jsx-1169100422">Log in</div>
                      </button></a
                    ><button class="jsx-1169100422 Button primary">
                      <div class="jsx-1169100422">Create Free Account</div>
                    </button>
                  </div>
                </div>
              </div>
            </div>
            <div class="jsx-1615743782 TitleBar">
              <div class="jsx-1615743782 filter">
                <button class="jsx-1169100422 Button iconButton noPadding">
                  <div class="jsx-1169100422 icon">
                    <svg
                      id="R√©teg_1"
                      xmlns="http://www.w3.org/2000/svg"
                      viewBox="0 0 7 12"
                    >
                      <path
                        id="path-1_1_"
                        d="M5.9 0c.4 0 .9.3 1 .7s.1.9-.2 1.2L2.7 6l4 4.1c.3.5.3 1.1-.1 1.6s-1.1.4-1.5.1l-4.8-5c-.4-.4-.4-1.2 0-1.6L5.1.3c.2-.2.5-.3.8-.3z"
                      ></path>
                    </svg>
                  </div>
                  <div class="jsx-1169100422 desktopOnly">
                    Back to Tutorials
                  </div>
                </button>
              </div>
              <div class="jsx-1615743782 title">
                <div class="jsx-1582297868 Title">
                  <div class="jsx-1582297868 icon">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      viewBox="0 0 32 24.22"
                    >
                      <path
                        d="M16.23 24.22a2 2 0 0 1-.73-.14L7 20.79a2 2 0 0 1-1.29-1.88v-4a1.5 1.5 0 0 1 3 0v3.36l7.54 2.92 7.54-2.92v-3.45a1.5 1.5 0 0 1 3 0v4.09a2 2 0 0 1-1.29 1.88L17 24.08a2 2 0 0 1-.77.14zm-.35-2.94zm.7 0z"
                      ></path>
                      <path
                        d="M16.23 13.35a2 2 0 0 1-.62-.1C9.17 11.16 2.36 9 1.61 8.76a2 2 0 0 1-.25-3.87l14-4.78a2 2 0 0 1 1.3 0l14 4.78a2 2 0 0 1 0 3.81l-13.8 4.55a2 2 0 0 1-.63.1zm-.31-3zM5.21 6.74c3.49 1.11 9.07 2.92 11 3.56l10.68-3.53L16 3.05z"
                      ></path>
                    </svg>
                  </div>
                  <div class="jsx-1582297868 h1">Tutorials</div>
                </div>
              </div>
              <div class="jsx-1615743782 action"></div>
            </div>
            <div class="jsx-1851940463 Tutorial">
              <div>
                <div>
                  <div></div>
                  <div class="jsx-undefined social__top desktopOnly">
                    <div class="jsx-undefined voteAndSocial">
                      <div class="jsx-undefined">
                        <a href="#comments" class="jsx-765279523 CommentCounter"
                          ><span class="jsx-765279523 icon"
                            ><svg
                              xmlns="http://www.w3.org/2000/svg"
                              viewBox="0 0 18 18"
                            >
                              <path
                                d="M12.595 13.364c.01-.111.02-.197.028-.251.058-.405.372-.702.74-.702h1.257c1.035-.002 1.875-.934 1.88-2.082V4.764c-.001-1.155-.842-2.092-1.878-2.094H3.38c-1.034.002-1.873.931-1.88 2.076v5.565c.001 1.156.842 2.092 1.878 2.094h6.626c.292 0 .557.189.68.484.408.977 1.07 1.576 1.94 1.85a6.004 6.004 0 0 1-.03-1.375zm1.51 1.119c.048.314.136.521.235.606.566.487.258 1.497-.458 1.497-1.87 0-3.423-.785-4.33-2.51H3.376C1.513 14.07.004 12.39 0 10.311V4.74C.014 2.673 1.52 1.004 3.378 1h11.245c1.864.004 3.373 1.686 3.377 3.763v5.57c-.01 2.07-1.518 3.744-3.378 3.748h-.551c.004.138.016.273.035.402zm-8.423-5.81a1.114 1.114 0 1 0 0-2.229 1.114 1.114 0 0 0 0 2.229zm3.268 0a1.114 1.114 0 1 0 0-2.229 1.114 1.114 0 0 0 0 2.229zm3.318 0a1.114 1.114 0 1 0 0-2.229 1.114 1.114 0 0 0 0 2.229z"
                              ></path></svg></span
                          ><span class="jsx-765279523 count">0</span></a
                        >
                        <div class="jsx-1727309017 Upvote">
                          <div class="jsx-1727309017">
                            <div class="jsx-1727309017 normal">
                              <span class="jsx-1727309017 icon"
                                ><svg
                                  xmlns="http://www.w3.org/2000/svg"
                                  width="12"
                                  height="12"
                                  viewBox="0 0 12 12"
                                >
                                  <path d="M1 10L6 0l5 10z"></path></svg></span
                              ><span class="jsx-1727309017 count">28</span>
                            </div>
                            <div class="jsx-1727309017 voted">
                              <span class="jsx-1727309017 icon"
                                ><svg
                                  xmlns="http://www.w3.org/2000/svg"
                                  width="12"
                                  height="12"
                                  viewBox="0 0 12 12"
                                >
                                  <path d="M1 10L6 0l5 10z"></path></svg></span
                              ><span class="jsx-1727309017 count">28</span>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="jsx-2027482828 Social vertical">
                        <div class="jsx-2027482828 icons">
                          <a
                            href="https://www.facebook.com/sharer.php?u=https://www.datacamp.com/community/tutorials/replicating-in-r-covid19"
                            target="_blank"
                            rel="noopener noreferrer"
                            class="jsx-2027482828 icon"
                            ><svg
                              height="12"
                              xmlns="http://www.w3.org/2000/svg"
                              viewBox="0 0 11.73 22.58"
                            >
                              <path
                                d="M7.61 22.58v-10.3h3.46l.52-4h-4V5.7c0-1.16.32-2 2-2h2.13V.16A28.47 28.47 0 0 0 8.63 0C5.56 0 3.47 1.87 3.47 5.31v3H0v4h3.47v10.3h4.14z"
                              ></path></svg></a
                          ><a
                            href="https://twitter.com/intent/tweet?url=https://www.datacamp.com/community/tutorials/replicating-in-r-covid19"
                            target="_blank"
                            rel="noopener noreferrer"
                            class="jsx-2027482828 icon centerIcon"
                            ><svg
                              height="10"
                              xmlns="http://www.w3.org/2000/svg"
                              viewBox="0 0 20.42 16.67"
                            >
                              <path
                                d="M10 5.18c0-.28-.06-.53-.07-.78a4 4 0 0 1 .73-2.57A4.08 4.08 0 0 1 13.93 0 4 4 0 0 1 17 1.15a.43.43 0 0 0 .46.12 8.68 8.68 0 0 0 2.2-.84l.2-.1a4.36 4.36 0 0 1-1.75 2.28A9 9 0 0 0 20.42 2l-.21.3a3.83 3.83 0 0 1-.23.3A8.45 8.45 0 0 1 18.5 4a.28.28 0 0 0-.13.27A12 12 0 0 1 17 10.18a11.8 11.8 0 0 1-3.37 4.11 11.17 11.17 0 0 1-4.39 2.06 12.53 12.53 0 0 1-4.44.22 11.87 11.87 0 0 1-4.74-1.73L0 14.79a8.6 8.6 0 0 0 6.16-1.74 4.28 4.28 0 0 1-3.91-2.91h.95a6.18 6.18 0 0 0 .89-.12A4.2 4.2 0 0 1 .8 5.88a4 4 0 0 0 1.81.49 4.23 4.23 0 0 1-1.78-3A4.07 4.07 0 0 1 1.38.79 12.06 12.06 0 0 0 10 5.18z"
                                id="iOjKBC.tif"
                              ></path></svg></a
                          ><a
                            href="https://www.linkedin.com/cws/share?url=https://www.datacamp.com/community/tutorials/replicating-in-r-covid19"
                            target="_blank"
                            rel="noopener noreferrer"
                            class="jsx-2027482828 icon"
                            ><svg
                              height="10"
                              xmlns="http://www.w3.org/2000/svg"
                              viewBox="0 0 16.99 17"
                            >
                              <path
                                d="M3.85 17H.34V5.67h3.51zM2.07 4.18a2.09 2.09 0 1 1 2.08-2.09 2.08 2.08 0 0 1-2.08 2.09zM17 17h-3.5v-5.95c0-1.63-.62-2.54-1.91-2.54s-2.14.95-2.14 2.54V17H6.09V5.67h3.36v1.52a4 4 0 0 1 3.42-1.87c2.4 0 4.12 1.47 4.12 4.5V17z"
                              ></path></svg
                          ></a>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="jsx-1851940463 preface">
                  <div class="jsx-1851940463 author">
                    <div class="jsx-886169423 Author">
                      <a
                        href="https://www.datacamp.com/profile/ramnath"
                        target="_blank"
                        rel="noopener noreferrer"
                        class="jsx-886169423"
                      >
                        <div
                          style="
                            background-image: url(https://res.cloudinary.com/dyd911kmh/image/fetch/t_avatar_thumbnail/https://assets.datacamp.com/users/avatars/000/837/953/square/ramnathaboutpic.jpg?1493158575);
                            border-radius: 20px;
                            min-width: 40px;
                            min-height: 40px;
                          "
                          class="jsx-1670412252 Avatar"
                        ></div>
                        <div class="jsx-886169423 info">
                          <div class="jsx-886169423 name">
                            Ramnath Vaidyanathan
                          </div>
                          <div class="jsx-886169423 date">
                            <span>April 17th, 2020</span>
                          </div>
                        </div>
                      </a>
                    </div>
                  </div>
                  <div class="jsx-1851940463 tags">
                    <div class="jsx-3846131586 TagLine">
                      <div class="jsx-3073944448 Tag mustRead">
                        <span class="jsx-3073944448 title">must read</span>
                      </div>
                      <div class="jsx-3073944448 Tag">
                        <span class="jsx-3073944448 title">r programming</span>
                      </div>
                    </div>
                  </div>
                  <h1 class="jsx-1851940463 pageTitle">
                    Estimating COVID-19&#x27;s ùëÖùë° in Real-Time (Replicating in
                    R)
                  </h1>
                  <div class="jsx-1851940463 description pageDescription"></div>
                </div>
                <div class="markdown">
                  <div>
                    <p>
                      Give
                      <a href="https://twitter.com/ramnath_vaidya"
                        >Ramnath Vaidyanathan</a
                      >
                      a follow on Twitter. This analysis was originally
                      published on
                      <a
                        href="https://colab.research.google.com/drive/1iV1eRHaxirA--kmGIGbR1D67t8z8dUWN#scrollTo=KBj5NShH9hOw"
                        >Google Colab</a
                      >.
                    </p>
                    <p>
                      <a href="https://twitter.com/kevin">Kevin Systrom</a>
                      published a
                      <a
                        href="http://systrom.com/blog/the-metric-we-need-to-manage-covid-19/"
                        >really interesting article</a
                      >
                      on estimating $R_t$, the measure known as effective
                      reproduction number. In his article, Kevin describes this
                      number as:
                    </p>
                    <blockquote>
                      <p>
                        The number of people who become infected per infectious
                        person at time ùë°
                      </p>
                    </blockquote>
                    <p>
                      Kevin was kind enough to publish his code as a
                      <a
                        href="https://github.com/k-sys/covid-19/blob/master/Realtime R0.ipynb"
                        >notebook on github</a
                      >. I wanted to do more with his model, and also apply it
                      to other countries. However, given that I am a lot more
                      proficient in <a href="https://cran.r-project.org/">R</a>,
                      I wanted to first replicate his results in R.
                    </p>
                    <p>
                      Before you read the rest of this post, I would strongly
                      recommend that you read the
                      <a
                        href="http://systrom.com/blog/the-metric-we-need-to-manage-covid-19/"
                        >original article</a
                      >
                      to get a more detailed sense of the modeling approach
                      used, as this post is more focused on the code.
                    </p>
                    <p>
                      All credit for the modeling approach and code goes to
                      Kevin üëç. This notebook is my humble attempt at
                      translating his model into R. Any mistakes that remain are
                      solely mine.
                    </p>
                    <h2 id="bettencourt-ribeiro">Bettencourt &amp; Ribeiro</h2>
                    <p>
                      We will use the same approach outlined by Kevin in his
                      article, which uses the paper by
                      <a
                        href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0002185"
                        >Bettencourt &amp; Ribeiro</a
                      >
                      as its underlying basis.
                    </p>
                    <h3 id="modeling-arrivals">Modeling arrivals</h3>
                    <p>
                      The first step is to model the 'arrival' process of
                      infections. A popular choice for the distribution of
                      arrivals amongst statisticians is the
                      <a
                        href="https://en.wikipedia.org/wiki/Poisson_distribution"
                        >Poisson Distribution</a
                      >. Accordingly, if we let $\lambda$ represent the average
                      rate of infections per day, then the probability that we
                      are likely to see $k$ new cases on a day, is given by
                    </p>
                    <p>$$P(k|\lambda) = \frac{\lambda^k e^{-\lambda}}{k!}$$</p>
                    <p>
                      Given this setup, we can construct the probability
                      distribution of new cases for a set of $\lambda$s. Before
                      we can start writing code, we need to load the
                      <code>tidyverse</code> set of packages, and customize some
                      plotting options (plot dimensions, plotting them etc). You
                      can feel free to skip reading this section, as it is not
                      critical to the narrative, but do make sure to execute the
                      code.
                    </p>
                    <h3 id="packages-options">Packages &amp; options</h3>
                    <pre><code class="lang-python"># Load packages
library(tidyverse)

# Plot options

## Jupyter notebooks use the repr package to create viewable representations
## of R objects (https://github.com/IRkernel/repr). I am updating the default
## plot dimensions to 12 x 6.
options(repr.plot.width = 12, repr.plot.height = 6)

## We will use ggplot2 for all plots. I am defining a custom theme here
## that mainly updates the backgrounds and legend position. We set this
## custom theme as the default, and also update the default for line size.
theme_custom &lt;- function(base_size, ...){
  ggplot2::theme_gray(base_size = base_size, ...) +
  ggplot2::theme(
    plot.title = element_text(face = 'bold'),
    plot.subtitle = element_text(color = '#333333'),
    panel.background = element_rect(fill = "#EBF4F7"),
    strip.background = element_rect(fill = "#33AACC"),
    legend.position = "bottom"
  )
}
ggplot2::theme_set(theme_custom(base_size = 20))
ggplot2::update_geom_defaults("line", list(size = 1.5))

# Utility functions

## We will use a utility function to display the head of dataframes.
## Note that we need this hack mainly to add the class 'dataframe' to
## the tables that are printed. This should ideally be handled
## by the `repr` package, and I will be sending a PR.
display_df &lt;- function(x){
  d &lt;- as.character(
    knitr::kable(x, format = 'html', table.attr = "class='dataframe'")
  )
  IRdisplay::display_html(d)
}

display_head &lt;- function(x, n = 6){
   display_df(head(x, n))
}

display_random &lt;- function(x, n = 6){
   display_df(dplyr::sample_n(x, n))
}
</code></pre>
                    <pre><code>‚îÄ‚îÄ [1mAttaching packages[22m ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse 1.3.0 ‚îÄ‚îÄ

[32m‚úî[39m [34mggplot2[39m 3.3.0     [32m‚úî[39m [34mpurrr  [39m 0.3.3
[32m‚úî[39m [34mtibble [39m 3.0.0     [32m‚úî[39m [34mdplyr  [39m 0.8.5
[32m‚úî[39m [34mtidyr  [39m 1.0.2     [32m‚úî[39m [34mstringr[39m 1.4.0
[32m‚úî[39m [34mreadr  [39m 1.3.1     [32m‚úî[39m [34mforcats[39m 0.5.0

‚îÄ‚îÄ [1mConflicts[22m ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse_conflicts() ‚îÄ‚îÄ
[31m‚úñ[39m [34mdplyr[39m::[32mfilter()[39m masks [34mstats[39m::filter()
[31m‚úñ[39m [34mdplyr[39m::[32mlag()[39m    masks [34mstats[39m::lag()
</code></pre>
                    <h3 id="poisson-distribution">Poisson distribution</h3>
                    <p>
                      We can use the <code>crossing</code> function from
                      <code>purrr</code> to compute probability densities across
                      a combination of $k$s and $\lambda$s. This is an elegant
                      approach, although computationally suboptimal, since we
                      are not really taking advantage of the vectorization
                      capabilities of <code>dpois</code>. You will see a more
                      computationally efficient approach in a later section.
                    </p>
                    <pre><code class="lang-python"># Number of new cases observed in a day
k = 0:69

# Arrival rate of new infections per day
lambda = c(10, 20, 30, 40)

poisson_densities = crossing(lambda = lambda, k = k) %&gt;%
  mutate(p = dpois(k, lambda))

display_head(poisson_densities)
</code></pre>
                    <div class="output_wrapper">
                      <table class="dataframe">
                        <thead>
                          <tr>
                            <th style="text-align: right">lambda</th>
                            <th style="text-align: right">k</th>
                            <th style="text-align: right">p</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td style="text-align: right">10</td>
                            <td style="text-align: right">0</td>
                            <td style="text-align: right">0.0000454</td>
                          </tr>
                          <tr>
                            <td style="text-align: right">10</td>
                            <td style="text-align: right">1</td>
                            <td style="text-align: right">0.0004540</td>
                          </tr>
                          <tr>
                            <td style="text-align: right">10</td>
                            <td style="text-align: right">2</td>
                            <td style="text-align: right">0.0022700</td>
                          </tr>
                          <tr>
                            <td style="text-align: right">10</td>
                            <td style="text-align: right">3</td>
                            <td style="text-align: right">0.0075667</td>
                          </tr>
                          <tr>
                            <td style="text-align: right">10</td>
                            <td style="text-align: right">4</td>
                            <td style="text-align: right">0.0189166</td>
                          </tr>
                          <tr>
                            <td style="text-align: right">10</td>
                            <td style="text-align: right">5</td>
                            <td style="text-align: right">0.0378333</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>

                    <p>
                      We can visualize these probabilities using
                      <code>ggplot2</code>. Note how we make use of
                      <a
                        href="https://www.rdocumentation.org/packages/base/topics/expression"
                        >expression</a
                      >
                      to render math symbols in plots. You can read more about
                      this in the documentation for
                      <a
                        href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath"
                        >plotmath</a
                      >.
                    </p>
                    <pre><code class="lang-python">poisson_densities %&gt;%
  # We convert lambda to a factor so that each line gets a discrete color
  mutate(lambda = factor(lambda)) %&gt;%
  ggplot(aes(x = k, y = p, color = lambda)) +
  geom_line() +
  labs(
    title = expression(paste("Probability of k new cases P(k|", lambda, ")")),
    x = 'Number of new cases',
    y = NULL,
    color = expression(lambda)
  )
</code></pre>
                    <center>
                      <img
                        src="https://res.cloudinary.com/dyd911kmh/image/upload/f_auto,q_auto:best/v1587080366/output_10_0_vhfi4y.png"
                      />
                    </center>

                    <h3 id="poisson-likelihood">Poisson likelihood</h3>
                    <p>
                      Modeling the arrival process as a Poisson distribution
                      allows us to predict the distribution of new cases in a
                      day as a function of the arrival rate $\lambda$. However,
                      in reality, we only observe the number of arrivals. So the
                      key question now is how do we go from the observed number
                      of arrivals to get a sense of the distribution of
                      $\lambda$. Thankfully, the answer to this question is
                      simple.
                    </p>
                    <p>$$L(\lambda| k) = \frac{\lambda^k e^{-\lambda}}{k!}$$</p>
                    <p>
                      The distribution of $\lambda$ over k is called the
                      <strong>likelihood</strong> function, and it has the same
                      mathematical expression as the
                      <strong>probability mass function</strong> we used
                      earlier. We can visualize the likelihood function by
                      fixing the number of new cases observed (k), and computing
                      the likelihood function over a range of values of
                      $\lambda$.
                    </p>
                    <pre><code class="lang-python"># Number of new cases observed in a day
k = 20

# Arrival rates of new infections per day
lambdas = seq(1, 45, length = 90)

# Compute likelihood and visualize them
tibble(lambda = lambdas, p = dpois(k, lambdas)) %&gt;%
  ggplot(aes(x = lambda, y = p)) +
  geom_line(color = 'black') +
  labs(
    title = expression(paste("Poisson Likelihood L(", lambda, " | k"[t], ")")),
    x = expression(lambda),
    y = NULL
  )
</code></pre>
                    <center>
                      <img
                        src="https://res.cloudinary.com/dyd911kmh/image/upload/f_auto,q_auto:best/v1587080366/output_13_0_n1hnih.png"
                      />
                    </center>

                    <h3 id="connecting-lambda-and-r_t-">
                      Connecting $\lambda$ and $R_t$
                    </h3>
                    <p>
                      All this is good, but you might be wondering where is the
                      effective infection rate, $R_t$, we talked about in the
                      beginning. How is it related to the arrival rate
                      $\lambda$. According to this paper by
                      <a
                        href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0002185"
                        >Bettencourt &amp; Ribeiro</a
                      >, the relationship is rather simple
                    </p>
                    <p>$$ \lambda = k_{t-1}e^{\gamma(R_t-1)}$$</p>
                    <p>
                      Note that $\gamma$ here is the reciprocal of the serial
                      interval (<a
                        href="https://wwwnc.cdc.gov/eid/article/26/6/20-0357_article"
                        >about 4 days for COVID19</a
                      >), and $k_{t-1}$ is the number of new cases observed in
                      the time interval $t-1$.
                    </p>
                    <p>
                      We can use this expression for $\lambda$ and reformulate
                      the likelihood function in terms of $R_t$.
                    </p>
                    <p>
                      $$\mathcal{L}\left(R_t|k\right) = \frac{\lambda^k
                      e^{-\lambda}}{k!}$$
                    </p>
                    <p>
                      Before we move on, let us set up some core parameters.
                    </p>
                    <pre><code class="lang-python"># r_t_range is a vector of possible values for R_t
R_T_MAX = 12
r_t_range = seq(0, R_T_MAX, length = R_T_MAX*100 + 1)

# Gamma is 1/serial interval
# https://wwwnc.cdc.gov/eid/article/26/6/20-0357_article
GAMMA = 1/4

# New cases by day
k =  c(20, 40, 55, 90)
</code></pre>
                    <p>
                      The code below showcases a more computationally efficient
                      way to compute the likelihoods. Rather than generating the
                      lambdas and likelihoods for each combination separately,
                      we use the vectorized nature of functions in R, and the
                      ability to have nested dataframes. This allows us to
                      generate a vector of lambdas and likelihoods for each day,
                      and then use <code>tidyr::unnest</code> to unpack it into
                      a flat table.
                    </p>
                    <p>
                      Apart from the computational efficiency, I would argue
                      that this code is more readable and translates the
                      mathematical formulae with minimal overhead.
                    </p>
                    <pre><code class="lang-python">likelihoods &lt;- tibble(day = seq_along(k) - 1, k = k) %&gt;%
  # Compute a vector of likelihoods
  mutate(
    r_t = list(r_t_range),
    lambda = map(lag(k, 1), ~ .x * exp(GAMMA * (r_t_range - 1))),
    likelihood_r_t = map2(k, lambda, ~ dpois(.x, .y)/sum(dpois(.x, .y)))
  ) %&gt;%
  # Ignore the 0th day
  filter(day &gt; 0) %&gt;%
  # Unnest the data to flatten it.
  select(-lambda) %&gt;%
  unnest(c(r_t, likelihood_r_t))

display_random(likelihoods)
</code></pre>
                    <div class="output_wrapper">
                      <table class="dataframe">
                        <thead>
                          <tr>
                            <th style="text-align: right">day</th>
                            <th style="text-align: right">k</th>
                            <th style="text-align: right">r_t</th>
                            <th style="text-align: right">likelihood_r_t</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td style="text-align: right">1</td>
                            <td style="text-align: right">40</td>
                            <td style="text-align: right">7.26</td>
                            <td style="text-align: right">0.0000000</td>
                          </tr>
                          <tr>
                            <td style="text-align: right">1</td>
                            <td style="text-align: right">40</td>
                            <td style="text-align: right">2.54</td>
                            <td style="text-align: right">0.0011292</td>
                          </tr>
                          <tr>
                            <td style="text-align: right">2</td>
                            <td style="text-align: right">55</td>
                            <td style="text-align: right">3.54</td>
                            <td style="text-align: right">0.0003426</td>
                          </tr>
                          <tr>
                            <td style="text-align: right">2</td>
                            <td style="text-align: right">55</td>
                            <td style="text-align: right">5.62</td>
                            <td style="text-align: right">0.0000000</td>
                          </tr>
                          <tr>
                            <td style="text-align: right">1</td>
                            <td style="text-align: right">40</td>
                            <td style="text-align: right">7.03</td>
                            <td style="text-align: right">0.0000000</td>
                          </tr>
                          <tr>
                            <td style="text-align: right">3</td>
                            <td style="text-align: right">90</td>
                            <td style="text-align: right">10.84</td>
                            <td style="text-align: right">0.0000000</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>

                    <p>
                      We can now plot the likelihood conditional on the number
                      of new cases observed.
                    </p>
                    <pre><code class="lang-python">likelihoods %&gt;%  
  ggplot(aes(x = r_t, y = likelihood_r_t, color = factor(k))) +
  geom_line() +
  labs(
    title = expression(paste("Likelihood of R"[t], " given k")),
    subtitle = expression(paste("L(R"[t], "|k)")),
    x = expression("R"[t]),
    y = NULL, color = 'k'
  )
</code></pre>
                    <center>
                      <img
                        src="https://res.cloudinary.com/dyd911kmh/image/upload/f_auto,q_auto:best/v1587080366/output_20_0_xq1fvw.png"
                      />
                    </center>

                    <h3 id="estimating-r_t-">Estimating $R_t$</h3>
                    <p>
                      We have made good progress in linking the number of new
                      cases, $k$, and the effective infection rate, $R_t$.
                      However, we still don't have a tangible approach to
                      estimate its values from the time series of observed new
                      cases. Here is where the ubiquitous
                      <a href="https://en.wikipedia.org/wiki/Bayes%27_theorem"
                        >Bayes' rule</a
                      >
                      comes extremely handy. Bettencourt &amp; Ribeiro express
                      the probability distribution of $R_t$ as
                    </p>
                    <p>
                      $$
                      P(R_t|k_t)=\frac{P(R_t)\cdot\mathcal{L}(k_t|R_t)}{P(k_t)}
                      $$
                    </p>
                    <p>
                      Kevin unpacks this complex equation in much simpler terms.
                    </p>
                    <blockquote>
                      <p>
                        This says that, having seen ùëò new cases, we believe the
                        distribution of ùëÖùë° is equal to:
                      </p>
                      <ul>
                        <li>
                          The <strong>prior</strong> beliefs of the value of
                          $P(R_t)$ without the data ...
                        </li>
                        <li>
                          times the <strong>likelihood</strong> of seeing $k$
                          new cases given $R_t$ ...
                        </li>
                        <li>
                          divided by the probability of seeing this many cases
                          in general.
                        </li>
                      </ul>
                    </blockquote>
                    <p>
                      If we use the posterior probability of the previous
                      period, $P(R_{t-1} | k_{t-1})$, as the prior, $P(R_t)$,
                      for the current period, then we can rewrite the previous
                      equation as:
                    </p>
                    <p>
                      $$ P(R_t|k_t) \propto
                      P(R_{t-1}|k_{t-1})\cdot\mathcal{L}(k_t|R_t) $$
                    </p>
                    <p>
                      Iterating across periods all the way back to $t = 0$, we
                      get
                    </p>
                    <p>
                      $$ P(R_t|k_t) \propto P(R_0) \cdot {\displaystyle
                      \prod^{T}_{t=0}}\mathcal{L}(k_t|R_t) $$
                    </p>
                    <p>With a uniform prior $P(R_0)$, this reduces to:</p>
                    <p>
                      $$ P(R_t|k_t) \propto {\displaystyle
                      \prod^{T}_{t=0}}\mathcal{L}\left(k_t|R_t\right) $$
                    </p>
                    <p>
                      We can now use this mathematical expression to compute the
                      posterior from the likelihoods. Once again, we use the
                      vectorized function <code>cumprod</code> to generate
                      posteriors for all days at once, and then normalize it.
                    </p>
                    <pre><code class="lang-python">posteriors &lt;- likelihoods %&gt;%
  group_by(r_t) %&gt;%
  arrange(day) %&gt;%
  mutate(posterior = cumprod(likelihood_r_t)) %&gt;%
  group_by(k) %&gt;%
  mutate(posterior = posterior / sum(posterior)) %&gt;%
  ungroup()

display_random(posteriors)
</code></pre>
                    <div class="output_wrapper">
                      <table class="dataframe">
                        <thead>
                          <tr>
                            <th style="text-align: right">day</th>
                            <th style="text-align: right">k</th>
                            <th style="text-align: right">r_t</th>
                            <th style="text-align: right">likelihood_r_t</th>
                            <th style="text-align: right">posterior</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td style="text-align: right">3</td>
                            <td style="text-align: right">90</td>
                            <td style="text-align: right">5.85</td>
                            <td style="text-align: right">0.0000000</td>
                            <td style="text-align: right">0.0000000</td>
                          </tr>
                          <tr>
                            <td style="text-align: right">3</td>
                            <td style="text-align: right">90</td>
                            <td style="text-align: right">2.35</td>
                            <td style="text-align: right">0.0033847</td>
                            <td style="text-align: right">0.0025235</td>
                          </tr>
                          <tr>
                            <td style="text-align: right">3</td>
                            <td style="text-align: right">90</td>
                            <td style="text-align: right">7.68</td>
                            <td style="text-align: right">0.0000000</td>
                            <td style="text-align: right">0.0000000</td>
                          </tr>
                          <tr>
                            <td style="text-align: right">2</td>
                            <td style="text-align: right">55</td>
                            <td style="text-align: right">0.01</td>
                            <td style="text-align: right">0.0000047</td>
                            <td style="text-align: right">0.0000000</td>
                          </tr>
                          <tr>
                            <td style="text-align: right">1</td>
                            <td style="text-align: right">40</td>
                            <td style="text-align: right">0.79</td>
                            <td style="text-align: right">0.0000009</td>
                            <td style="text-align: right">0.0000009</td>
                          </tr>
                          <tr>
                            <td style="text-align: right">3</td>
                            <td style="text-align: right">90</td>
                            <td style="text-align: right">10.81</td>
                            <td style="text-align: right">0.0000000</td>
                            <td style="text-align: right">0.0000000</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>

                    <p>We can now visualize the posterior distribution.</p>
                    <pre><code class="lang-python">posteriors %&gt;%
  ggplot(aes(x = r_t, y = posterior, color = factor(day))) +
  geom_line() +
  labs(
    title = expression(paste("Posterior probability of R"[t], " given k")),
    subtitle = expression(paste("P(R"[t], "| k)")),
    x = expression("R"[t]), y = NULL, color = 'day'
  )
</code></pre>
                    <center>
                      <img
                        src="https://res.cloudinary.com/dyd911kmh/image/upload/f_auto,q_auto:best/v1587080366/output_25_0_pu0oiu.png"
                      />
                    </center>

                    <p>
                      These posteriors now allow us to answer the all important
                      question:
                    </p>
                    <blockquote>
                      <p>What is the most likely value of $R_t$ each day?</p>
                    </blockquote>
                    <p>
                      While estimating any quantity, it is very important to
                      provide a sense of the error surrounding the estimate. A
                      popular way of doing this is to use
                      <a
                        href="https://www.sciencedirect.com/topics/mathematics/highest-density-interval"
                        >highest density intervals</a
                      >.
                    </p>
                    <blockquote>
                      <p>
                        Another way of summarizing a distribution is the highest
                        density interval, which summarizes the distribution by
                        specifying an interval that spans most of the
                        distribution, say 95% of it, such that every point
                        inside the interval has higher credibility than any
                        point outside the interval.
                      </p>
                    </blockquote>
                    <p>
                      In his article, Kevin implemented a brute force algorithm
                      to compute HDI. R users are more fortunate that there is
                      already a package, <code>HDInterval</code>, out there with
                      an implementation üéâ.
                    </p>
                    <p>
                      We will now estimate the most likely value of $R_t$, and
                      the highest density interval surrounding it. Since the
                      <code>HDInterval::hdi</code> function only works with a
                      vector of random values from a distribution, and we only
                      estimated the posterior probabilities, we will need to
                      simulate random values of $R_t$ using the posterior
                      probabilities in order to compute the highest-density
                      intervals.
                    </p>
                    <pre><code class="lang-python"># Install and load HDInterval package
install.packages("HDInterval")
library(HDInterval)

# Compute the most likely value of r_t and the highest-density interval
estimates &lt;- posteriors %&gt;%
  group_by(day) %&gt;%
  summarize(
    r_t_simulated = list(sample(r_t_range, 10000, replace = TRUE, prob = posterior)),
    r_t_most_likely = r_t_range[which.max(posterior)]
  ) %&gt;%
  mutate(
    r_t_lo = map_dbl(r_t_simulated, ~ hdi(.x)[1]),
    r_t_hi = map_dbl(r_t_simulated, ~ hdi(.x)[2])
  ) %&gt;%
  select(-r_t_simulated)

display_head(estimates)
</code></pre>
                    <pre><code>Installing package into ‚Äò/usr/local/lib/R/site-library‚Äô
(as ‚Äòlib‚Äô is unspecified)
</code></pre>
                    <div class="output_wrapper">
                      <table class="dataframe">
                        <thead>
                          <tr>
                            <th style="text-align: right">day</th>
                            <th style="text-align: right">r_t_most_likely</th>
                            <th style="text-align: right">r_t_lo</th>
                            <th style="text-align: right">r_t_hi</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td style="text-align: right">1</td>
                            <td style="text-align: right">3.77</td>
                            <td style="text-align: right">2.45</td>
                            <td style="text-align: right">4.96</td>
                          </tr>
                          <tr>
                            <td style="text-align: right">2</td>
                            <td style="text-align: right">2.84</td>
                            <td style="text-align: right">2.04</td>
                            <td style="text-align: right">3.65</td>
                          </tr>
                          <tr>
                            <td style="text-align: right">3</td>
                            <td style="text-align: right">2.90</td>
                            <td style="text-align: right">2.28</td>
                            <td style="text-align: right">3.44</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>

                    <p>
                      We can visualize these estimates and the uncertainty
                      surrounding them using a line plot with ribbons.
                    </p>
                    <pre><code class="lang-python">estimates %&gt;%
  ggplot(aes(x = day, y = r_t_most_likely)) +
  geom_point(color = "#ffc844", size = 5) +
  geom_line(color = 'black') +
  geom_ribbon(aes(ymin = r_t_lo, ymax = r_t_hi), fill = "#ffc844", alpha = 0.3) +
  labs(
    title = expression(paste('R'[t], ' by day')),
    subtitle = "The band represents the highest density interval",
    x = 'Day', y = NULL
  )
</code></pre>
                    <center>
                      <img
                        src="https://res.cloudinary.com/dyd911kmh/image/upload/f_auto,q_auto:best/v1587080366/output_29_0_knpcet.png"
                      />
                    </center>

                    <p>
                      While Bettencourt and Ribeiro's approach works fine, Kevin
                      points out a practical problem with it (that is also noted
                      in the paper), that it is possible for the
                      <strong
                        >posterior to get stuck and asympotically approach
                        1</strong
                      >, due to its inability to forget the times with a high
                      $R_t$.
                    </p>
                    <p>
                      To counter this problem, Kevin suggests the following
                      approach.
                    </p>
                    <blockquote>
                      <p>
                        So, I propose to only incorporate the last $m$ days of
                        the likelihood function. By doing this, the algorithm's
                        prior is built based on the recent past which is a much
                        more useful prior than the entire history of the
                        epidemic. So this simple, but important change leads to
                        the following: $$ P(R_t|k_t) \propto {\displaystyle
                        \prod^{T}_{t=T-m}}\mathcal{L}\left(k_t|R_t\right) $$
                      </p>
                    </blockquote>
                    <p>
                      We will use this modification to estimate the values of
                      $R_t$ across different states in the US.
                    </p>
                    <h2 id="application-to-us-data">Application to US Data</h2>
                    <p>
                      It is now time to take all this machinery we built and
                      apply it on COVID data from US states to estimate the
                      effective infection rate, $R_t$. Let us begin by fetching
                      the data. We will use the COVID dataset for the US
                      constructed by the New York Times.
                    </p>
                    <pre><code class="lang-python">url = 'https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-states.csv'
covid_cases &lt;- readr::read_csv(url)

display_head(covid_cases)
</code></pre>
                    <pre><code>Parsed with column specification:
cols(
  date = [34mcol_date(format = "")[39m,
  state = [31mcol_character()[39m,
  fips = [31mcol_character()[39m,
  cases = [32mcol_double()[39m,
  deaths = [32mcol_double()[39m
)
</code></pre>
                    <div class="output_wrapper">
                      <table class="dataframe">
                        <thead>
                          <tr>
                            <th style="text-align: left">date</th>
                            <th style="text-align: left">state</th>
                            <th style="text-align: left">fips</th>
                            <th style="text-align: right">cases</th>
                            <th style="text-align: right">deaths</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td style="text-align: left">2020-01-21</td>
                            <td style="text-align: left">Washington</td>
                            <td style="text-align: left">53</td>
                            <td style="text-align: right">1</td>
                            <td style="text-align: right">0</td>
                          </tr>
                          <tr>
                            <td style="text-align: left">2020-01-22</td>
                            <td style="text-align: left">Washington</td>
                            <td style="text-align: left">53</td>
                            <td style="text-align: right">1</td>
                            <td style="text-align: right">0</td>
                          </tr>
                          <tr>
                            <td style="text-align: left">2020-01-23</td>
                            <td style="text-align: left">Washington</td>
                            <td style="text-align: left">53</td>
                            <td style="text-align: right">1</td>
                            <td style="text-align: right">0</td>
                          </tr>
                          <tr>
                            <td style="text-align: left">2020-01-24</td>
                            <td style="text-align: left">Illinois</td>
                            <td style="text-align: left">17</td>
                            <td style="text-align: right">1</td>
                            <td style="text-align: right">0</td>
                          </tr>
                          <tr>
                            <td style="text-align: left">2020-01-24</td>
                            <td style="text-align: left">Washington</td>
                            <td style="text-align: left">53</td>
                            <td style="text-align: right">1</td>
                            <td style="text-align: right">0</td>
                          </tr>
                          <tr>
                            <td style="text-align: left">2020-01-25</td>
                            <td style="text-align: left">California</td>
                            <td style="text-align: left">06</td>
                            <td style="text-align: right">1</td>
                            <td style="text-align: right">0</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>

                    <h3 id="smooth-new-cases">Smooth new cases</h3>
                    <p>
                      The first step is to prepare the data by computing the
                      number of new cases every day, and smoothing it over a
                      rolling window. The smoothing is essential to account for
                      lags in reporting. The lag has been found to be especially
                      pronounced over weekends.
                    </p>
                    <p>
                      Following Kevin's approach, I utilize a gaussian smoother
                      with a 7-day rolling window.
                    </p>
                    <p>
                      Note that we will implement all data processing steps as
                      standalone functions. While this adds some overhead, it
                      will allow us to compose these steps cleanly, and also
                      apply them across one or more states, which will come very
                      handy.
                    </p>
                    <p>
                      We will apply these steps to one selected state, so it is
                      easier to look at the results and make sense out of them.
                      I have selected New York, but feel free to switch it to a
                      state of your choice!
                    </p>
                    <pre><code class="lang-python"># Install the smoother package
install.packages("smoother")

#' Compute new cases and smooth them
smooth_new_cases &lt;- function(cases){
  cases %&gt;%
    arrange(date) %&gt;%
    mutate(new_cases = c(cases[1], diff(cases))) %&gt;%
    mutate(new_cases_smooth = round(
      smoother::smth(new_cases, window = 7, tails = TRUE)
    )) %&gt;%
    select(state, date, new_cases, new_cases_smooth)
}

state_selected &lt;- "New York"
covid_cases %&gt;%
  filter(state == state_selected) %&gt;%
  smooth_new_cases() %&gt;%
  display_head()
</code></pre>
                    <pre><code>Installing package into ‚Äò/usr/local/lib/R/site-library‚Äô
(as ‚Äòlib‚Äô is unspecified)
</code></pre>
                    <div class="output_wrapper">
                      <table class="dataframe">
                        <thead>
                          <tr>
                            <th style="text-align: left">state</th>
                            <th style="text-align: left">date</th>
                            <th style="text-align: right">new_cases</th>
                            <th style="text-align: right">new_cases_smooth</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td style="text-align: left">New York</td>
                            <td style="text-align: left">2020-03-01</td>
                            <td style="text-align: right">1</td>
                            <td style="text-align: right">1</td>
                          </tr>
                          <tr>
                            <td style="text-align: left">New York</td>
                            <td style="text-align: left">2020-03-02</td>
                            <td style="text-align: right">0</td>
                            <td style="text-align: right">2</td>
                          </tr>
                          <tr>
                            <td style="text-align: left">New York</td>
                            <td style="text-align: left">2020-03-03</td>
                            <td style="text-align: right">1</td>
                            <td style="text-align: right">4</td>
                          </tr>
                          <tr>
                            <td style="text-align: left">New York</td>
                            <td style="text-align: left">2020-03-04</td>
                            <td style="text-align: right">9</td>
                            <td style="text-align: right">9</td>
                          </tr>
                          <tr>
                            <td style="text-align: left">New York</td>
                            <td style="text-align: left">2020-03-05</td>
                            <td style="text-align: right">11</td>
                            <td style="text-align: right">15</td>
                          </tr>
                          <tr>
                            <td style="text-align: left">New York</td>
                            <td style="text-align: left">2020-03-06</td>
                            <td style="text-align: right">22</td>
                            <td style="text-align: right">23</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>

                    <p>
                      Let us plot the raw values as well as the smoothed values
                      for <code>new_cases</code> so we can visualize what the
                      smoothing process is doing.
                    </p>
                    <p>
                      üé© It is always good practice to visualize the results
                      after you make some data transformations. This allows you
                      to build intuition and also sanity check that your
                      transformation is doing what you intended it to do!
                    </p>
                    <pre><code class="lang-python">plot_new_cases &lt;- function(cases){
  cases %&gt;%
    ggplot(aes(x = date, y = new_cases)) +
    geom_line(linetype = 'dotted', color = 'gray40') +
    geom_line(aes(y = new_cases_smooth), color = "#14243e") +
    labs(
      title = "New cases per day",
      subtitle = unique(cases$state),
      x = NULL, y = NULL
    )
}

covid_cases %&gt;%
  filter(state == state_selected) %&gt;%
  smooth_new_cases() %&gt;%
  plot_new_cases()
</code></pre>
                    <center>
                      <img
                        src="https://res.cloudinary.com/dyd911kmh/image/upload/f_auto,q_auto:best/v1587080366/output_36_0_g8lpdt.png"
                      />
                    </center>

                    <h3 id="compute-likelihoods">Compute Likelihoods</h3>
                    <p>
                      The second step is to compute the likelihoods. We will use
                      the same approach we followed previously, but with one
                      notable difference. We will compute log-likelihoods
                      instead of the likelihoods. This will make it easier to
                      smooth them over a rolling window to apply the
                      modification suggested by Kevin, of only using the latest
                      $m$ intervals to compute $R_t$.
                    </p>
                    <p>
                      As before, we will compute the likelihoods for each day as
                      a nested list and then flatten the results to a table
                      using <code>tidyr::unnest</code>.
                    </p>
                    <p>
                      üé©List columns are extremely handy when working with data.
                      The design pattern used here is very useful in many
                      situations.
                    </p>
                    <pre><code class="lang-python">compute_likelihood &lt;- function(cases){
  likelihood &lt;- cases %&gt;%
    filter(new_cases_smooth &gt; 0) %&gt;%
    mutate(
      r_t = list(r_t_range),
      lambda = map(lag(new_cases_smooth, 1), ~ .x * exp(GAMMA * (r_t_range - 1))),
      likelihood_r_t = map2(new_cases_smooth, lambda, dpois, log = TRUE)
    ) %&gt;%
    slice(-1) %&gt;%
    select(-lambda) %&gt;%
    unnest(c(likelihood_r_t, r_t))
}

covid_cases %&gt;%
  filter(state == state_selected) %&gt;%
  smooth_new_cases() %&gt;%
  compute_likelihood() %&gt;%
  display_random()
</code></pre>
                    <div class="output_wrapper">
                      <table class="dataframe">
                        <thead>
                          <tr>
                            <th style="text-align: left">state</th>
                            <th style="text-align: left">date</th>
                            <th style="text-align: right">new_cases</th>
                            <th style="text-align: right">new_cases_smooth</th>
                            <th style="text-align: right">r_t</th>
                            <th style="text-align: right">likelihood_r_t</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td style="text-align: left">New York</td>
                            <td style="text-align: left">2020-03-24</td>
                            <td style="text-align: right">4790</td>
                            <td style="text-align: right">5677</td>
                            <td style="text-align: right">5.36</td>
                            <td style="text-align: right">-4010.9111</td>
                          </tr>
                          <tr>
                            <td style="text-align: left">New York</td>
                            <td style="text-align: left">2020-03-21</td>
                            <td style="text-align: right">3254</td>
                            <td style="text-align: right">3614</td>
                            <td style="text-align: right">7.33</td>
                            <td style="text-align: right">-5054.4656</td>
                          </tr>
                          <tr>
                            <td style="text-align: left">New York</td>
                            <td style="text-align: left">2020-04-07</td>
                            <td style="text-align: right">9378</td>
                            <td style="text-align: right">9094</td>
                            <td style="text-align: right">5.90</td>
                            <td style="text-align: right">-10331.2552</td>
                          </tr>
                          <tr>
                            <td style="text-align: left">New York</td>
                            <td style="text-align: left">2020-03-13</td>
                            <td style="text-align: right">95</td>
                            <td style="text-align: right">118</td>
                            <td style="text-align: right">7.01</td>
                            <td style="text-align: right">-144.3349</td>
                          </tr>
                          <tr>
                            <td style="text-align: left">New York</td>
                            <td style="text-align: left">2020-04-10</td>
                            <td style="text-align: right">10575</td>
                            <td style="text-align: right">9895</td>
                            <td style="text-align: right">11.69</td>
                            <td style="text-align: right">-107594.6949</td>
                          </tr>
                          <tr>
                            <td style="text-align: left">New York</td>
                            <td style="text-align: left">2020-04-10</td>
                            <td style="text-align: right">10575</td>
                            <td style="text-align: right">9895</td>
                            <td style="text-align: right">8.46</td>
                            <td style="text-align: right">-35816.2131</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>

                    <h3 id="compute-posteriors">Compute Posteriors</h3>
                    <p>
                      The third step is to compute the posterior probabilities.
                      Recall that
                    </p>
                    <p>
                      $$ P(R_t|k_t) \propto {\displaystyle
                      \prod^{T}_{t=T-m}}\mathcal{L}\left(k_t|R_t\right) $$
                    </p>
                    <p>We can rewrite this in terms of the log-likelihoods</p>
                    <p>
                      $$ P(R_t|k_t) \propto {\displaystyle \exp \big(
                      \sum^{T}_{t=T-m}}\log(\mathcal{L}\left(k_t|R_t\right))
                      \big) $$
                    </p>
                    <p>
                      We can use the <code>rollapplyr</code> function from the
                      <code>zoo</code> package to compute a rolling 7-day sum of
                      the log likelihoods, and then exponentiate it to compute
                      the posterior. Finally, we normalize the posteriors to
                      1.0.
                    </p>
                    <pre><code class="lang-python">compute_posterior &lt;- function(likelihood){
  likelihood %&gt;%
    arrange(date) %&gt;%
    group_by(r_t) %&gt;%
    mutate(posterior = exp(
      zoo::rollapplyr(likelihood_r_t, 7, sum, partial = TRUE)
    )) %&gt;%
    group_by(date) %&gt;%
    mutate(posterior = posterior / sum(posterior, na.rm = TRUE)) %&gt;%
    # HACK: NaNs in the posterior create issues later on. So we remove them.
    mutate(posterior = ifelse(is.nan(posterior), 0, posterior)) %&gt;%
    ungroup() %&gt;%
    select(-likelihood_r_t)
}

covid_cases %&gt;%
  filter(state == state_selected) %&gt;%
  smooth_new_cases() %&gt;%
  compute_likelihood() %&gt;%
  compute_posterior() %&gt;%
  display_random()
</code></pre>
                    <div class="output_wrapper">
                      <table class="dataframe">
                        <thead>
                          <tr>
                            <th style="text-align: left">state</th>
                            <th style="text-align: left">date</th>
                            <th style="text-align: right">new_cases</th>
                            <th style="text-align: right">new_cases_smooth</th>
                            <th style="text-align: right">r_t</th>
                            <th style="text-align: right">posterior</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td style="text-align: left">New York</td>
                            <td style="text-align: left">2020-04-14</td>
                            <td style="text-align: right">7177</td>
                            <td style="text-align: right">8311</td>
                            <td style="text-align: right">0.51</td>
                            <td style="text-align: right">0.0000000</td>
                          </tr>
                          <tr>
                            <td style="text-align: left">New York</td>
                            <td style="text-align: left">2020-03-19</td>
                            <td style="text-align: right">1770</td>
                            <td style="text-align: right">1921</td>
                            <td style="text-align: right">11.62</td>
                            <td style="text-align: right">0.0000000</td>
                          </tr>
                          <tr>
                            <td style="text-align: left">New York</td>
                            <td style="text-align: left">2020-03-25</td>
                            <td style="text-align: right">7401</td>
                            <td style="text-align: right">6094</td>
                            <td style="text-align: right">5.46</td>
                            <td style="text-align: right">0.0000000</td>
                          </tr>
                          <tr>
                            <td style="text-align: left">New York</td>
                            <td style="text-align: left">2020-03-22</td>
                            <td style="text-align: right">4812</td>
                            <td style="text-align: right">4455</td>
                            <td style="text-align: right">0.53</td>
                            <td style="text-align: right">0.0000000</td>
                          </tr>
                          <tr>
                            <td style="text-align: left">New York</td>
                            <td style="text-align: left">2020-03-20</td>
                            <td style="text-align: right">2950</td>
                            <td style="text-align: right">2753</td>
                            <td style="text-align: right">8.64</td>
                            <td style="text-align: right">0.0000000</td>
                          </tr>
                          <tr>
                            <td style="text-align: left">New York</td>
                            <td style="text-align: left">2020-03-05</td>
                            <td style="text-align: right">11</td>
                            <td style="text-align: right">15</td>
                            <td style="text-align: right">2.44</td>
                            <td style="text-align: right">0.0020211</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>

                    <p>
                      Let us visualize the posterior probabilities we computed.
                      Note how we set <code>alpha = 0.2</code> to reduce the
                      amount of overplotting. This allows us to visualize the
                      shifting posteriors.
                    </p>
                    <pre><code class="lang-python">plot_posteriors &lt;- function(posteriors){
  posteriors %&gt;%
    ggplot(aes(x = r_t, y = posterior, group = date)) +
    geom_line(alpha = 0.2) +
    labs(
      title = expression(paste("Daily Posterior of R"[t], " by day")),
      subtitle = unique(posteriors$state),
      x = '',
      y = ''
    ) +
    coord_cartesian(xlim = c(0.4, 4)) +
    theme(legend.position = 'none')
}

covid_cases %&gt;%
  filter(state == state_selected) %&gt;%
  smooth_new_cases() %&gt;%
  compute_likelihood() %&gt;%
  compute_posterior() %&gt;%
  plot_posteriors()
</code></pre>
                    <center>
                      <img
                        src="https://res.cloudinary.com/dyd911kmh/image/upload/f_auto,q_auto:best/v1587080368/output_42_0_cp294y.png"
                      />
                    </center>

                    <h3 id="estimate-rt">Estimate Rt</h3>
                    <p>
                      The final step is to estimate the values of $R_t$ and the
                      highest density intervals surrounding them. Recall that we
                      need to simulate random values for $r_t$ using the
                      posterior probabilities in order to apply the
                      <code>HDIInterval::hdi</code> function to compute the
                      highest density intervals.
                    </p>
                    <pre><code class="lang-python"># Estimate R_t and a 95% highest-density interval around it
estimate_rt &lt;- function(posteriors){
  posteriors %&gt;%
    group_by(state, date) %&gt;%
    summarize(
      r_t_simulated = list(sample(r_t_range, 10000, replace = TRUE, prob = posterior)),
      r_t_most_likely = r_t_range[which.max(posterior)]
    ) %&gt;%
    mutate(
      r_t_lo = map_dbl(r_t_simulated, ~ hdi(.x)[1]),
      r_t_hi = map_dbl(r_t_simulated, ~ hdi(.x)[2])
    ) %&gt;%
    select(-r_t_simulated)
}

covid_cases %&gt;%
  filter(state == state_selected) %&gt;%
  smooth_new_cases() %&gt;%
  compute_likelihood() %&gt;%
  compute_posterior() %&gt;%
  estimate_rt() %&gt;%
  display_random()
</code></pre>
                    <div class="output_wrapper">
                      <table class="dataframe">
                        <thead>
                          <tr>
                            <th style="text-align: left">state</th>
                            <th style="text-align: left">date</th>
                            <th style="text-align: right">r_t_most_likely</th>
                            <th style="text-align: right">r_t_lo</th>
                            <th style="text-align: right">r_t_hi</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td style="text-align: left">New York</td>
                            <td style="text-align: left">2020-03-14</td>
                            <td style="text-align: right">2.05</td>
                            <td style="text-align: right">1.68</td>
                            <td style="text-align: right">2.36</td>
                          </tr>
                          <tr>
                            <td style="text-align: left">New York</td>
                            <td style="text-align: left">2020-03-22</td>
                            <td style="text-align: right">2.33</td>
                            <td style="text-align: right">2.27</td>
                            <td style="text-align: right">2.39</td>
                          </tr>
                          <tr>
                            <td style="text-align: left">New York</td>
                            <td style="text-align: left">2020-03-07</td>
                            <td style="text-align: right">2.62</td>
                            <td style="text-align: right">1.73</td>
                            <td style="text-align: right">3.46</td>
                          </tr>
                          <tr>
                            <td style="text-align: left">New York</td>
                            <td style="text-align: left">2020-03-09</td>
                            <td style="text-align: right">2.01</td>
                            <td style="text-align: right">1.32</td>
                            <td style="text-align: right">2.63</td>
                          </tr>
                          <tr>
                            <td style="text-align: left">New York</td>
                            <td style="text-align: left">2020-04-04</td>
                            <td style="text-align: right">1.18</td>
                            <td style="text-align: right">1.15</td>
                            <td style="text-align: right">1.21</td>
                          </tr>
                          <tr>
                            <td style="text-align: left">New York</td>
                            <td style="text-align: left">2020-04-06</td>
                            <td style="text-align: right">1.08</td>
                            <td style="text-align: right">1.05</td>
                            <td style="text-align: right">1.11</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>

                    <p>
                      Finally, we come to the moment of truth! Let us visualize
                      the estimated values of $R_t$
                    </p>
                    <pre><code class="lang-python">plot_estimates &lt;- function(estimates){
  estimates %&gt;%
    ggplot(aes(x = date, y = r_t_most_likely)) +
    geom_point(color = "darkorange", alpha = 0.8, size = 4) +
    geom_line(color = "#14243e") +
    geom_hline(yintercept = 1, linetype = 'dashed') +
    geom_ribbon(
      aes(ymin = r_t_lo, ymax = r_t_hi),
      fill = 'darkred',
      alpha = 0.2
    ) +
    labs(
      title = expression('Real time R'[t]), x = '', y = '',
      subtitle = unique(estimates$state)
    ) +
    coord_cartesian(ylim = c(0, 4))
}

covid_cases %&gt;%
  filter(state == state_selected) %&gt;%
  smooth_new_cases() %&gt;%
  compute_likelihood() %&gt;%
  compute_posterior() %&gt;%
  estimate_rt() %&gt;%
  plot_estimates()
</code></pre>
                    <center>
                      <img
                        src="https://res.cloudinary.com/dyd911kmh/image/upload/f_auto,q_auto:best/v1587080366/output_46_0_ppnxc7.png"
                      />
                    </center>

                    <p>
                      So how does this compare with the estimates from Kevin's
                      article. It seems like the initial estimates in my model
                      are off from Kevin's estimates. However, that could be a
                      function of differences in the smoothing algorithm, or the
                      large uncertainty surrounding the initial estimates. The
                      overall shape of the curve and the peaks seem to match up
                      pretty closely. Mission accomplished! üéâ
                    </p>
                    <p>
                      <img
                        src="http://systrom.com/wp-content/uploads/2020/04/image-2.png"
                        width="60%"
                        align="center"
                      />
                    </p>
                    <h3 id="loop-across-all-states">Loop across all states</h3>
                    <p>
                      It is now time to loop across all states and compute these
                      estimates. We can do this easily by grouping by
                      <code>state</code>, splitting the data into one table per
                      state, and using <code>purrr::map_df</code> to estimate
                      $R_t$ for each state and combine them back into a single
                      table.
                    </p>
                    <pre><code class="lang-python"># ‚ö†Ô∏èThis function can take a couple of minutes to run
#   as it loops across all states
estimates_all &lt;- covid_cases %&gt;%
  filter(date &gt;= "2020-03-01") %&gt;%
  group_by(state) %&gt;%
  # Ignore states that have not reached 100 infections
  filter(max(cases) &gt; 100 ) %&gt;%
  group_split() %&gt;%
  map_df(~ {
    .x %&gt;%
      smooth_new_cases() %&gt;%
      compute_likelihood() %&gt;%
      compute_posterior() %&gt;%
      estimate_rt()
  }) %&gt;%
  ungroup()
</code></pre>
                    <pre><code class="lang-python">estimates_all %&gt;%
  display_random()
</code></pre>
                    <div class="output_wrapper">
                      <table class="dataframe">
                        <thead>
                          <tr>
                            <th style="text-align: left">state</th>
                            <th style="text-align: left">date</th>
                            <th style="text-align: right">r_t_most_likely</th>
                            <th style="text-align: right">r_t_lo</th>
                            <th style="text-align: right">r_t_hi</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td style="text-align: left">New Jersey</td>
                            <td style="text-align: left">2020-03-15</td>
                            <td style="text-align: right">2.72</td>
                            <td style="text-align: right">2.01</td>
                            <td style="text-align: right">3.42</td>
                          </tr>
                          <tr>
                            <td style="text-align: left">Alaska</td>
                            <td style="text-align: left">2020-04-02</td>
                            <td style="text-align: right">0.80</td>
                            <td style="text-align: right">0.04</td>
                            <td style="text-align: right">1.54</td>
                          </tr>
                          <tr>
                            <td style="text-align: left">Maryland</td>
                            <td style="text-align: left">2020-03-12</td>
                            <td style="text-align: right">1.67</td>
                            <td style="text-align: right">0.00</td>
                            <td style="text-align: right">3.33</td>
                          </tr>
                          <tr>
                            <td style="text-align: left">Washington</td>
                            <td style="text-align: left">2020-03-10</td>
                            <td style="text-align: right">2.01</td>
                            <td style="text-align: right">1.49</td>
                            <td style="text-align: right">2.52</td>
                          </tr>
                          <tr>
                            <td style="text-align: left">New Mexico</td>
                            <td style="text-align: left">2020-03-28</td>
                            <td style="text-align: right">1.58</td>
                            <td style="text-align: right">0.89</td>
                            <td style="text-align: right">2.17</td>
                          </tr>
                          <tr>
                            <td style="text-align: left">South Dakota</td>
                            <td style="text-align: left">2020-04-08</td>
                            <td style="text-align: right">1.63</td>
                            <td style="text-align: right">1.12</td>
                            <td style="text-align: right">2.09</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>

                    <p>
                      We can now create a small multiples plot of the estimates
                      across all states. The use of <code>ggplot2</code> makes
                      this really easy and all we had to add was an extra line
                      of code!
                    </p>
                    <pre><code class="lang-python"># Increase plot height and width
options(repr.plot.height = 40, repr.plot.width = 20)
estimates_all %&gt;%
  plot_estimates() +
  facet_wrap(~ state, ncol = 4) +
  labs(subtitle = "")

# Reset plot dimensions
options(repr.plot.height = 12, repr.plot.width = 8)
</code></pre>
                    <center>
                      <img
                        src="https://res.cloudinary.com/dyd911kmh/image/upload/f_auto,q_auto:best/v1587080368/output_52_0_wz69k9.png"
                      />
                    </center>

                    <p>
                      While the small multiples plot is perfect, it is hard to
                      navigate to a state based on its geographic location. What
                      if we could plot each state close to its geographic
                      location?
                    </p>
                    <p>
                      Thankfully, Ryan Hafen has created the
                      <code>geofacet</code> package that allows us to lay out
                      these small multiples on a geographic grid with a single
                      line of code.
                    </p>
                    <p>
                      ‚ö†Ô∏è Unfortunately, I was not able to install the
                      <code>geofacet</code> package on colab (I suspect it is
                      because of system dependencies required by the
                      <code>sf</code> package), and hence the code chunk below
                      will fail to execute. I have included a saved version of
                      the plot I generated locally, so you can get a sense of
                      how it looks.
                    </p>
                    <pre><code class="lang-python"># ‚ö†Ô∏è CAUTION: This code will error on colab
# options(repr.plot.height = 40, repr.plot.width = 20)
# estimates_all %&gt;%
#  mutate(state = state.abb[match(state, state.name)]) %&gt;%
#  plot_estimates() +
#  geofacet::facet_geo(~ state, ncol = 4) +
#  labs(subtitle = "") +
#  theme(strip.text = element_text(hjust = 0))
# options(repr.plot.height = 12, repr.plot.width = 8)
</code></pre>
                    <p>
                      <img
                        src="https://i.imgur.com/9Op2GLt.png"
                        alt="geofacet"
                      />
                    </p>
                    <p>
                      Finally, let us recreate the plot in Kevin's article that
                      orders the states based on the most likely estimated value
                      of $R_t$, and colors them based on the state of lockdown.
                    </p>
                    <p>
                      ‚ö†Ô∏è Please note that this is a purely descriptive plot and
                      one cannot draw any conclusions on the efficacy of
                      lockdowns
                    </p>
                    <pre><code class="lang-python">options(repr.plot.width = 20, repr.plot.height = 8)
no_lockdown = c('North Dakota', 'South Dakota', 'Nebraska', 'Iowa', 'Arkansas')
partial_lockdown = c('Utah', 'Wyoming', 'Oklahoma')
estimates_all %&gt;%
  group_by(state) %&gt;%
  filter(date == max(date)) %&gt;%
  ungroup() %&gt;%
  mutate(state = forcats::fct_reorder(state, r_t_most_likely)) %&gt;%
  mutate(lockdown = case_when(
    state %in% no_lockdown ~ 'None',
    state %in% partial_lockdown ~ 'Partial',
    TRUE ~ "Full"
  )) %&gt;%
  ggplot(aes(x = state, y = r_t_most_likely)) +
  geom_col(aes(fill = lockdown)) +
  geom_hline(yintercept = 1, linetype = 'dotted') +
  geom_errorbar(aes(ymin = r_t_lo, ymax = r_t_hi), width = 0.2) +
  scale_fill_manual(values = c(None = 'darkred', Partial = 'gray50', Full = 'gray70')) +
  labs(
    title = expression(paste("Most Recent R"[t], " by state")),
    x = '', y = ''
  ) +
  theme(axis.text.x.bottom = element_text(angle = 90, hjust = 1, vjust = 0.5))
options(repr.plot.width = 12, repr.plot.height = 5)
</code></pre>
                    <center>
                      <img
                        src="https://res.cloudinary.com/dyd911kmh/image/upload/f_auto,q_auto:best/v1587080366/output_57_0_dwjo9u.png"
                      />
                    </center>

                    <h2 id="conclusions-and-next-steps">
                      Conclusions and Next Steps
                    </h2>
                    <p>
                      In this article, we replicated Kevin's analysis in R,
                      using the <code>tidyverse</code>. We learned some useful
                      tricks to compute likelihoods and posteriors. I learned a
                      ton in this process!
                    </p>
                    <p>
                      I can think of several next steps, but will highlighting
                      one major one that comes to mind. Given that the functions
                      developed in this article rely on a fairly simple input
                      table with three columns: <code>location</code>,
                      <code>date</code>, <code>cases</code>, an interesting next
                      step would be to turn this into an R package. This will
                      make it easier to estimate $R_t$ for other geographies.
                    </p>
                    <p>
                      I would like to end by thanking
                      <a href="https://twitter.com/kevin">Kevin Systrom</a> for
                      publishing an interesting post and sharing his code. I
                      would also like to thank my colleagues at
                      <a href="http://dataamp.com/">DataCamp</a> for their
                      excellent feedback on an initial version of this article.
                    </p>
                    <p>
                      If you have any feedback/comments on this article, or
                      would like to suggest other extensions, you can find me on
                      twitter
                      <a href="https://twitter.com/ramnath_vaidya"
                        >@ramnath_vaidya</a
                      >
                      and <a href="https://github.com/ramnathv">github</a>.
                    </p>
                    <center>
                      <a
                        target="‚Äú_blank‚Äù"
                        href="https://www.datacamp.com/learn/r/"
                        ><img
                          src="https://res.cloudinary.com/dyd911kmh/image/upload/f_auto,q_auto:best/v1583330891/r_3_ijnnwq.png"
                      /></a>
                    </center>
                  </div>
                  <link
                    href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/solarized-dark.min.css"
                    rel="stylesheet"
                  />
                  <link
                    href="https://fonts.googleapis.com/css?family=Lora"
                    rel="stylesheet"
                  />
                  <link
                    href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,400i,700,700i"
                    rel="stylesheet"
                  />
                </div>
                <div class="jsx-1851940463 social__bottom mobileOnly">
                  <div class="jsx-1851940463 voteAndSocial">
                    <div class="jsx-1851940463">
                      <div class="jsx-1727309017 Upvote">
                        <div class="jsx-1727309017">
                          <div class="jsx-1727309017 normal">
                            <span class="jsx-1727309017 icon"
                              ><svg
                                xmlns="http://www.w3.org/2000/svg"
                                width="12"
                                height="12"
                                viewBox="0 0 12 12"
                              >
                                <path d="M1 10L6 0l5 10z"></path></svg></span
                            ><span class="jsx-1727309017 count">28</span>
                          </div>
                          <div class="jsx-1727309017 voted">
                            <span class="jsx-1727309017 icon"
                              ><svg
                                xmlns="http://www.w3.org/2000/svg"
                                width="12"
                                height="12"
                                viewBox="0 0 12 12"
                              >
                                <path d="M1 10L6 0l5 10z"></path></svg></span
                            ><span class="jsx-1727309017 count">28</span>
                          </div>
                        </div>
                      </div>
                      <a href="#comments" class="jsx-765279523 CommentCounter"
                        ><span class="jsx-765279523 icon"
                          ><svg
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 18 18"
                          >
                            <path
                              d="M12.595 13.364c.01-.111.02-.197.028-.251.058-.405.372-.702.74-.702h1.257c1.035-.002 1.875-.934 1.88-2.082V4.764c-.001-1.155-.842-2.092-1.878-2.094H3.38c-1.034.002-1.873.931-1.88 2.076v5.565c.001 1.156.842 2.092 1.878 2.094h6.626c.292 0 .557.189.68.484.408.977 1.07 1.576 1.94 1.85a6.004 6.004 0 0 1-.03-1.375zm1.51 1.119c.048.314.136.521.235.606.566.487.258 1.497-.458 1.497-1.87 0-3.423-.785-4.33-2.51H3.376C1.513 14.07.004 12.39 0 10.311V4.74C.014 2.673 1.52 1.004 3.378 1h11.245c1.864.004 3.373 1.686 3.377 3.763v5.57c-.01 2.07-1.518 3.744-3.378 3.748h-.551c.004.138.016.273.035.402zm-8.423-5.81a1.114 1.114 0 1 0 0-2.229 1.114 1.114 0 0 0 0 2.229zm3.268 0a1.114 1.114 0 1 0 0-2.229 1.114 1.114 0 0 0 0 2.229zm3.318 0a1.114 1.114 0 1 0 0-2.229 1.114 1.114 0 0 0 0 2.229z"
                            ></path></svg></span
                        ><span class="jsx-765279523 count">0</span></a
                      >
                    </div>
                    <div class="jsx-2027482828 Social">
                      <div class="jsx-2027482828 icons">
                        <a
                          href="https://www.facebook.com/sharer.php?u=https://www.datacamp.com/community/tutorials/replicating-in-r-covid19"
                          target="_blank"
                          rel="noopener noreferrer"
                          class="jsx-2027482828 icon"
                          ><svg
                            height="12"
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 11.73 22.58"
                          >
                            <path
                              d="M7.61 22.58v-10.3h3.46l.52-4h-4V5.7c0-1.16.32-2 2-2h2.13V.16A28.47 28.47 0 0 0 8.63 0C5.56 0 3.47 1.87 3.47 5.31v3H0v4h3.47v10.3h4.14z"
                            ></path></svg></a
                        ><a
                          href="https://twitter.com/intent/tweet?url=https://www.datacamp.com/community/tutorials/replicating-in-r-covid19"
                          target="_blank"
                          rel="noopener noreferrer"
                          class="jsx-2027482828 icon centerIcon"
                          ><svg
                            height="10"
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 20.42 16.67"
                          >
                            <path
                              d="M10 5.18c0-.28-.06-.53-.07-.78a4 4 0 0 1 .73-2.57A4.08 4.08 0 0 1 13.93 0 4 4 0 0 1 17 1.15a.43.43 0 0 0 .46.12 8.68 8.68 0 0 0 2.2-.84l.2-.1a4.36 4.36 0 0 1-1.75 2.28A9 9 0 0 0 20.42 2l-.21.3a3.83 3.83 0 0 1-.23.3A8.45 8.45 0 0 1 18.5 4a.28.28 0 0 0-.13.27A12 12 0 0 1 17 10.18a11.8 11.8 0 0 1-3.37 4.11 11.17 11.17 0 0 1-4.39 2.06 12.53 12.53 0 0 1-4.44.22 11.87 11.87 0 0 1-4.74-1.73L0 14.79a8.6 8.6 0 0 0 6.16-1.74 4.28 4.28 0 0 1-3.91-2.91h.95a6.18 6.18 0 0 0 .89-.12A4.2 4.2 0 0 1 .8 5.88a4 4 0 0 0 1.81.49 4.23 4.23 0 0 1-1.78-3A4.07 4.07 0 0 1 1.38.79 12.06 12.06 0 0 0 10 5.18z"
                              id="iOjKBC.tif"
                            ></path></svg></a
                        ><a
                          href="https://www.linkedin.com/cws/share?url=https://www.datacamp.com/community/tutorials/replicating-in-r-covid19"
                          target="_blank"
                          rel="noopener noreferrer"
                          class="jsx-2027482828 icon"
                          ><svg
                            height="10"
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 16.99 17"
                          >
                            <path
                              d="M3.85 17H.34V5.67h3.51zM2.07 4.18a2.09 2.09 0 1 1 2.08-2.09 2.08 2.08 0 0 1-2.08 2.09zM17 17h-3.5v-5.95c0-1.63-.62-2.54-1.91-2.54s-2.14.95-2.14 2.54V17H6.09V5.67h3.36v1.52a4 4 0 0 1 3.42-1.87c2.4 0 4.12 1.47 4.12 4.5V17z"
                            ></path></svg
                        ></a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </main>
          <div class="jsx-2326038540 SidebarSocial">
            <div class="jsx-2326038540 rss">
              <a href="../rss.xml" class="jsx-2326038540"
                ><svg
                  height="13"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 18 18"
                >
                  <circle cx="3.08" cy="14.92" r="3.08"></circle>
                  <path
                    d="M16.46 18a1.54 1.54 0 0 1-1.54-1.54c0-8.25-5.13-13.38-13.38-13.38A1.59 1.59 0 0 1 .46 1.15 1.72 1.72 0 0 1 1.54 0a16.45 16.45 0 0 1 12 4.51c3 2.95 4.51 7.08 4.51 12A1.54 1.54 0 0 1 16.46 18z"
                  ></path>
                  <path
                    d="M10.63 18a1.54 1.54 0 0 1-1.54-1.54c0-5-2.54-7.54-7.54-7.54a1.54 1.54 0 0 1 0-3.08c6.75 0 10.63 3.87 10.63 10.62A1.54 1.54 0 0 1 10.63 18z"
                  ></path></svg
                >Subscribe to RSS</a
              >
            </div>
            <div class="jsx-2326038540 icons">
              <a
                href="https://www.facebook.com/pages/DataCamp/726282547396228"
                target="_blank"
                rel="noopener noreferrer"
                class="jsx-2326038540 icon"
                ><svg
                  height="16"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 11.73 22.58"
                >
                  <path
                    d="M7.61 22.58v-10.3h3.46l.52-4h-4V5.7c0-1.16.32-2 2-2h2.13V.16A28.47 28.47 0 0 0 8.63 0C5.56 0 3.47 1.87 3.47 5.31v3H0v4h3.47v10.3h4.14z"
                  ></path></svg></a
              ><a
                href="https://twitter.com/datacamp"
                target="_blank"
                rel="noopener noreferrer"
                class="jsx-2326038540 icon"
                ><svg
                  height="13"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 20.42 16.67"
                >
                  <path
                    d="M10 5.18c0-.28-.06-.53-.07-.78a4 4 0 0 1 .73-2.57A4.08 4.08 0 0 1 13.93 0 4 4 0 0 1 17 1.15a.43.43 0 0 0 .46.12 8.68 8.68 0 0 0 2.2-.84l.2-.1a4.36 4.36 0 0 1-1.75 2.28A9 9 0 0 0 20.42 2l-.21.3a3.83 3.83 0 0 1-.23.3A8.45 8.45 0 0 1 18.5 4a.28.28 0 0 0-.13.27A12 12 0 0 1 17 10.18a11.8 11.8 0 0 1-3.37 4.11 11.17 11.17 0 0 1-4.39 2.06 12.53 12.53 0 0 1-4.44.22 11.87 11.87 0 0 1-4.74-1.73L0 14.79a8.6 8.6 0 0 0 6.16-1.74 4.28 4.28 0 0 1-3.91-2.91h.95a6.18 6.18 0 0 0 .89-.12A4.2 4.2 0 0 1 .8 5.88a4 4 0 0 0 1.81.49 4.23 4.23 0 0 1-1.78-3A4.07 4.07 0 0 1 1.38.79 12.06 12.06 0 0 0 10 5.18z"
                    id="iOjKBC.tif"
                  ></path></svg></a
              ><a
                href="https://www.linkedin.com/company/datacampinc"
                target="_blank"
                rel="noopener noreferrer"
                class="jsx-2326038540 icon"
                ><svg
                  height="12"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 16.99 17"
                >
                  <path
                    d="M3.85 17H.34V5.67h3.51zM2.07 4.18a2.09 2.09 0 1 1 2.08-2.09 2.08 2.08 0 0 1-2.08 2.09zM17 17h-3.5v-5.95c0-1.63-.62-2.54-1.91-2.54s-2.14.95-2.14 2.54V17H6.09V5.67h3.36v1.52a4 4 0 0 1 3.42-1.87c2.4 0 4.12 1.47 4.12 4.5V17z"
                  ></path></svg></a
              ><a
                href="https://www.youtube.com/channel/UC79Gv3mYp6zKiSwYemEik9A"
                target="_blank"
                rel="noopener noreferrer"
                class="jsx-2326038540 icon"
                ><svg
                  height="12"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 25.19 17.73"
                >
                  <path
                    d="M24.21 1.52C23.3.44 21.62 0 18.42 0H6.78C3.5 0 1.79.47.88 1.62S0 4.4 0 6.68V11c0 4.43 1 6.68 6.78 6.68h11.64c2.78 0 4.32-.39 5.32-1.34S25.2 13.76 25.2 11V6.68c-.01-2.41-.08-4.07-.99-5.16zm-8 7.94l-5.29 2.76a.81.81 0 0 1-1.19-.72V6a.81.81 0 0 1 1.19-.72L16.17 8a.81.81 0 0 1 0 1.44z"
                  ></path></svg
              ></a>
            </div>
            <div class="jsx-2326038540 menu">
              <a
                href="https://www.datacamp.com/about"
                class="jsx-2326038540 menuItem"
                >About</a
              ><a
                href="https://www.datacamp.com/terms-of-use"
                class="jsx-2326038540 menuItem"
                >Terms</a
              ><a
                href="https://www.datacamp.com/privacy-policy"
                class="jsx-2326038540 menuItem"
                >Privacy</a
              >
            </div>
          </div>
        </div>
        <link
          href="https://fonts.googleapis.com/css?family=Lato:300,400i,400,700"
          rel="stylesheet"
        />
        <div class="Analytics">
          <script>
            (function (p, l, o, w, i, n, g) {
              if (!p[i]) {
                p.GlobalSnowplowNamespace = p.GlobalSnowplowNamespace || [];
                p.GlobalSnowplowNamespace.push(i);
                p[i] = function () {
                  (p[i].q = p[i].q || []).push(arguments);
                };
                p[i].q = p[i].q || [];
                n = l.createElement(o);
                g = l.getElementsByTagName(o)[0];
                n.async = 1;
                n.src = w;
                g.parentNode.insertBefore(n, g);
              }
            })(
              window,
              document,
              "script",
              "http://cdn.datacamp.com/sp/2.10.2.js",
              "snowplow"
            );

            var options = {
              appId: "community",
              platform: "web",
              post: true,
              discoverRootDomain: true,
              contexts: {
                webPage: true,
                performanceTiming: true,
              },
              forceSecureTracker: true,
              postPath: "/spevent",
            };

            window.snowplow("newTracker", "co", "www.datacamp.com", options);
            window.snowplow("enableActivityTracking", 10, 10);
            window.snowplow("enableLinkClickTracking");
          </script>
          <script data-cfasync="false">
            (function (W, i, s, e, P, o, p) {
              W["WisePopsObject"] = P;
              (W[P] =
                W[P] ||
                function () {
                  (W[P].q = W[P].q || []).push(arguments);
                }),
                (W[P].l = 1 * new Date());
              (o = i.createElement(s)), (p = i.getElementsByTagName(s)[0]);
              o.async = 1;
              o.src = e;
              p.parentNode.insertBefore(o, p);
            })(
              window,
              document,
              "script",
              "http://loader.wisepops.com/get-loader.js?v=1&amp;site=VswVJn7o4J",
              "wisepops"
            );
          </script>
        </div>
      </div>
    </div>
    <script id="__NEXT_DATA__" type="application/json">
      {
        "props": {
          "pageProps": {
            "isServer": true,
            "store": {},
            "initialState": {
              "adminContent": {
                "isFetching": false,
                "isFetched": false,
                "statusMessage": "",
                "content": {},
                "form": {
                  "isSaving": false,
                  "isSucceeded": false,
                  "statusMessage": "",
                  "isAdminFormModalOpen": false,
                  "previewSlug": ""
                },
                "delete": {
                  "isDeleting": false,
                  "isSucceeded": false,
                  "statusMessage": "",
                  "isDeleteAdminContentModalOpen": false
                },
                "update": {
                  "isApprovingArticle": false,
                  "isSucceeded": false,
                  "statusMessage": "",
                  "isApproveArticleModalOpen": false
                }
              },
              "adminList": {
                "isFetched": false,
                "isFetching": false,
                "statusMessage": ""
              },
              "auth": {
                "isAuthModalOpen": false,
                "isLogin": false,
                "isAuthorized": false,
                "isSubscriber": false,
                "user": {},
                "loginTitle": "",
                "signUpTitle": ""
              },
              "clientConfig": {
                "isDevelopment": false,
                "absoluteUrl": "https://www.datacamp.com",
                "isNewsActive": true,
                "ALGOLIA_APP_ID": "7H5IORUQLD",
                "ALGOLIA_API_KEY": "ae4f7a78b4914ef37d11dc177ad2eb13",
                "ALGOLIA_API_INDEX": "community_prod",
                "DC_COMMUNITY_AUTHOR_APP_URL": "https://community-author-app.new.datacamp.com/",
                "DC_LIGHT_URL": "https://cdn.datacamp.com/datacamp-light-latest.min.js",
                "ANALYTICS_SNOWPLOW_ENDPOINT": "www.datacamp.com",
                "COOKIE_BANNER_URL": "https://compliance.datacamp.com",
                "WISEPOPS": "VswVJn7o4J",
                "CHAT_SUBSCRIBER_REDIRECT": "https://www.datacamp.com/slack/join",
                "CHAT_NONSUBSCRIBER_LINK": "https://www.datacamp.com/pricing",
                "CHAT_SUBSCRIBE_TEAM": "https://www.datacamp.com/groups/business"
              },
              "comment": {
                "isFetching": false,
                "isFetched": false,
                "statusMessage": "",
                "comments": [],
                "commentsTotal": 0,
                "form": {
                  "isSaving": false,
                  "isSucceeded": false,
                  "statusMessage": "",
                  "id": "new",
                  "parentId": null,
                  "commentText": ""
                },
                "delete": {
                  "isDeleting": false,
                  "isSucceeded": false,
                  "statusMessage": "",
                  "isDeleteCommentModalOpen": false
                },
                "isBottomBarOpen": true,
                "bottomBarView": "bar"
              },
              "content": {
                "content": {
                  "id": 23638,
                  "externalId": null,
                  "type": "Tutorial",
                  "status": "published",
                  "authorId": "ramnath",
                  "title": "Estimating COVID-19's ùëÖùë° in Real-Time (Replicating in R)",
                  "slug": "replicating-in-r-covid19",
                  "previewSlug": "49a548c1-1b77-4641-8a1a-1fa9af10e6fc",
                  "description": " ",
                  "articles": [],
                  "courses": [],
                  "redirectSlug": null,
                  "contentHtml": "\u003cp\u003eGive \u003ca href=\"https://twitter.com/ramnath_vaidya\"\u003eRamnath Vaidyanathan\u003c/a\u003e a follow on Twitter. This analysis was originally published on \u003ca href=\"https://colab.research.google.com/drive/1iV1eRHaxirA--kmGIGbR1D67t8z8dUWN#scrollTo=KBj5NShH9hOw\"\u003eGoogle Colab\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://twitter.com/kevin\"\u003eKevin Systrom\u003c/a\u003e published a \u003ca href=\"http://systrom.com/blog/the-metric-we-need-to-manage-covid-19/\"\u003ereally interesting article\u003c/a\u003e on estimating $R_t$, the measure known as effective reproduction number. In his article, Kevin describes this number as:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThe number of people who become infected per infectious person at time  ùë°\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eKevin was kind enough to publish his code as a \u003ca href=\"https://github.com/k-sys/covid-19/blob/master/Realtime%20R0.ipynb\"\u003enotebook on github\u003c/a\u003e. I wanted to do more with his model, and also apply it to other countries. However, given that I am a lot more proficient in \u003ca href=\"https://cran.r-project.org/\"\u003eR\u003c/a\u003e, I wanted to first replicate his results in R.\u003c/p\u003e\n\u003cp\u003eBefore you read the rest of this post, I would strongly recommend that you read the \u003ca href=\"http://systrom.com/blog/the-metric-we-need-to-manage-covid-19/\"\u003eoriginal article\u003c/a\u003e to get a more detailed sense of the modeling approach used, as this post is more focused on the code.\u003c/p\u003e\n\u003cp\u003eAll credit for the modeling approach and code goes to Kevin üëç. This notebook is my humble attempt at translating his model into R. Any mistakes that remain are solely mine.\u003c/p\u003e\n\u003ch2 id=\"bettencourt-ribeiro\"\u003eBettencourt \u0026amp; Ribeiro\u003c/h2\u003e\n\u003cp\u003eWe will use the same approach outlined by Kevin in his article, which uses the paper by \u003ca href=\"https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0002185\"\u003eBettencourt \u0026amp; Ribeiro\u003c/a\u003e as its underlying basis.\u003c/p\u003e\n\u003ch3 id=\"modeling-arrivals\"\u003eModeling arrivals\u003c/h3\u003e\n\u003cp\u003eThe first step is to model the \u0026#39;arrival\u0026#39; process of infections. A popular choice for the distribution of arrivals amongst statisticians is the \u003ca href=\"https://en.wikipedia.org/wiki/Poisson_distribution\"\u003ePoisson Distribution\u003c/a\u003e. Accordingly, if we let $\\lambda$ represent the average rate of infections per day, then the probability that we are likely to see $k$ new cases on a day, is given by\u003c/p\u003e\n\u003cp\u003e$$P(k|\\lambda) = \\frac{\\lambda^k e^{-\\lambda}}{k!}$$\u003c/p\u003e\n\u003cp\u003eGiven this setup, we can construct the probability distribution of new cases  for a set of $\\lambda$s. Before we can start writing code, we need to load the \u003ccode\u003etidyverse\u003c/code\u003e set of packages, and customize some plotting options (plot dimensions, plotting them etc). You can feel free to skip reading this section, as it is not critical to the narrative, but do make sure to execute the code.\u003c/p\u003e\n\u003ch3 id=\"packages-options\"\u003ePackages \u0026amp; options\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"lang-python\"\u003e# Load packages\nlibrary(tidyverse)\n\n# Plot options\n\n## Jupyter notebooks use the repr package to create viewable representations\n## of R objects (https://github.com/IRkernel/repr). I am updating the default\n## plot dimensions to 12 x 6.\noptions(repr.plot.width = 12, repr.plot.height = 6)\n\n## We will use ggplot2 for all plots. I am defining a custom theme here\n## that mainly updates the backgrounds and legend position. We set this\n## custom theme as the default, and also update the default for line size.\ntheme_custom \u0026lt;- function(base_size, ...){\n  ggplot2::theme_gray(base_size = base_size, ...) +\n  ggplot2::theme(\n    plot.title = element_text(face = \u0026#39;bold\u0026#39;),\n    plot.subtitle = element_text(color = \u0026#39;#333333\u0026#39;),\n    panel.background = element_rect(fill = \u0026quot;#EBF4F7\u0026quot;),\n    strip.background = element_rect(fill = \u0026quot;#33AACC\u0026quot;),\n    legend.position = \u0026quot;bottom\u0026quot;\n  )\n}\nggplot2::theme_set(theme_custom(base_size = 20))\nggplot2::update_geom_defaults(\u0026quot;line\u0026quot;, list(size = 1.5))\n\n# Utility functions\n\n## We will use a utility function to display the head of dataframes.\n## Note that we need this hack mainly to add the class \u0026#39;dataframe\u0026#39; to\n## the tables that are printed. This should ideally be handled\n## by the `repr` package, and I will be sending a PR.\ndisplay_df \u0026lt;- function(x){\n  d \u0026lt;- as.character(\n    knitr::kable(x, format = \u0026#39;html\u0026#39;, table.attr = \u0026quot;class=\u0026#39;dataframe\u0026#39;\u0026quot;)\n  )\n  IRdisplay::display_html(d)\n}\n\ndisplay_head \u0026lt;- function(x, n = 6){\n   display_df(head(x, n))\n}\n\ndisplay_random \u0026lt;- function(x, n = 6){\n   display_df(dplyr::sample_n(x, n))\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode\u003e‚îÄ‚îÄ \u001b[1mAttaching packages\u001b[22m ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse 1.3.0 ‚îÄ‚îÄ\n\n\u001b[32m‚úî\u001b[39m \u001b[34mggplot2\u001b[39m 3.3.0     \u001b[32m‚úî\u001b[39m \u001b[34mpurrr  \u001b[39m 0.3.3\n\u001b[32m‚úî\u001b[39m \u001b[34mtibble \u001b[39m 3.0.0     \u001b[32m‚úî\u001b[39m \u001b[34mdplyr  \u001b[39m 0.8.5\n\u001b[32m‚úî\u001b[39m \u001b[34mtidyr  \u001b[39m 1.0.2     \u001b[32m‚úî\u001b[39m \u001b[34mstringr\u001b[39m 1.4.0\n\u001b[32m‚úî\u001b[39m \u001b[34mreadr  \u001b[39m 1.3.1     \u001b[32m‚úî\u001b[39m \u001b[34mforcats\u001b[39m 0.5.0\n\n‚îÄ‚îÄ \u001b[1mConflicts\u001b[22m ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse_conflicts() ‚îÄ‚îÄ\n\u001b[31m‚úñ\u001b[39m \u001b[34mdplyr\u001b[39m::\u001b[32mfilter()\u001b[39m masks \u001b[34mstats\u001b[39m::filter()\n\u001b[31m‚úñ\u001b[39m \u001b[34mdplyr\u001b[39m::\u001b[32mlag()\u001b[39m    masks \u001b[34mstats\u001b[39m::lag()\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"poisson-distribution\"\u003ePoisson distribution\u003c/h3\u003e\n\u003cp\u003eWe can use the \u003ccode\u003ecrossing\u003c/code\u003e function from \u003ccode\u003epurrr\u003c/code\u003e to compute probability densities across a combination of $k$s and $\\lambda$s. This is an elegant approach, although computationally suboptimal, since we are not really taking advantage of the vectorization capabilities of \u003ccode\u003edpois\u003c/code\u003e. You will see a more computationally efficient approach in a later section.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-python\"\u003e# Number of new cases observed in a day\nk = 0:69\n\n# Arrival rate of new infections per day\nlambda = c(10, 20, 30, 40)\n\npoisson_densities = crossing(lambda = lambda, k = k) %\u0026gt;%\n  mutate(p = dpois(k, lambda))\n\ndisplay_head(poisson_densities)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"output_wrapper\"\u003e\u003ctable class='dataframe'\u003e\n \u003cthead\u003e\n  \u003ctr\u003e\n   \u003cth style=\"text-align:right;\"\u003e lambda \u003c/th\u003e\n   \u003cth style=\"text-align:right;\"\u003e k \u003c/th\u003e\n   \u003cth style=\"text-align:right;\"\u003e p \u003c/th\u003e\n  \u003c/tr\u003e\n \u003c/thead\u003e\n\u003ctbody\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 10 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.0000454 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 10 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.0004540 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 10 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 2 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.0022700 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 10 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 3 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.0075667 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 10 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 4 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.0189166 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 10 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 5 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.0378333 \u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/div\u003e\n\n\n\u003cp\u003eWe can visualize these probabilities using \u003ccode\u003eggplot2\u003c/code\u003e. Note how we make use of \u003ca href=\"https://www.rdocumentation.org/packages/base/topics/expression\"\u003eexpression\u003c/a\u003e to render math symbols in plots. You can read more about this in the documentation for \u003ca href=\"https://www.rdocumentation.org/packages/grDevices/topics/plotmath\"\u003eplotmath\u003c/a\u003e.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-python\"\u003epoisson_densities %\u0026gt;%\n  # We convert lambda to a factor so that each line gets a discrete color\n  mutate(lambda = factor(lambda)) %\u0026gt;%\n  ggplot(aes(x = k, y = p, color = lambda)) +\n  geom_line() +\n  labs(\n    title = expression(paste(\u0026quot;Probability of k new cases P(k|\u0026quot;, lambda, \u0026quot;)\u0026quot;)),\n    x = \u0026#39;Number of new cases\u0026#39;,\n    y = NULL,\n    color = expression(lambda)\n  )\n\u003c/code\u003e\u003c/pre\u003e\n\u003ccenter\u003e\u003cimg src=\"https://res.cloudinary.com/dyd911kmh/image/upload/f_auto,q_auto:best/v1587080366/output_10_0_vhfi4y.png\" /\u003e\u003c/center\u003e\n\n\n\u003ch3 id=\"poisson-likelihood\"\u003ePoisson likelihood\u003c/h3\u003e\n\u003cp\u003eModeling the arrival process as a Poisson distribution allows us to predict the distribution of new cases in a day as a function of the arrival rate $\\lambda$. However, in reality, we only observe the number of arrivals. So the key question now is how do we go from the observed number of arrivals to get a sense of the distribution of $\\lambda$. Thankfully, the answer to this question is simple.\u003c/p\u003e\n\u003cp\u003e$$L(\\lambda| k) = \\frac{\\lambda^k e^{-\\lambda}}{k!}$$\u003c/p\u003e\n\u003cp\u003eThe distribution of $\\lambda$ over k is called the \u003cstrong\u003elikelihood\u003c/strong\u003e function, and it has the same mathematical expression as the \u003cstrong\u003eprobability mass function\u003c/strong\u003e we used earlier. We can visualize the likelihood function by fixing the number of new cases observed (k), and computing the likelihood function over a range of values of $\\lambda$. \u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-python\"\u003e# Number of new cases observed in a day\nk = 20\n\n# Arrival rates of new infections per day\nlambdas = seq(1, 45, length = 90)\n\n# Compute likelihood and visualize them\ntibble(lambda = lambdas, p = dpois(k, lambdas)) %\u0026gt;%\n  ggplot(aes(x = lambda, y = p)) +\n  geom_line(color = \u0026#39;black\u0026#39;) +\n  labs(\n    title = expression(paste(\u0026quot;Poisson Likelihood L(\u0026quot;, lambda, \u0026quot; | k\u0026quot;[t], \u0026quot;)\u0026quot;)),\n    x = expression(lambda),\n    y = NULL\n  )\n\u003c/code\u003e\u003c/pre\u003e\n\u003ccenter\u003e\u003cimg src=\"https://res.cloudinary.com/dyd911kmh/image/upload/f_auto,q_auto:best/v1587080366/output_13_0_n1hnih.png\" /\u003e\u003c/center\u003e\n\n\n\u003ch3 id=\"connecting-lambda-and-r_t-\"\u003eConnecting $\\lambda$ and $R_t$\u003c/h3\u003e\n\u003cp\u003eAll this is good, but you might be wondering where is the effective infection rate, $R_t$, we talked about in the beginning. How is it related to the arrival rate $\\lambda$. According to this paper by \u003ca href=\"https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0002185\"\u003eBettencourt \u0026amp; Ribeiro\u003c/a\u003e, the relationship is rather simple\u003c/p\u003e\n\u003cp\u003e$$ \\lambda = k_{t-1}e^{\\gamma(R_t-1)}$$\u003c/p\u003e\n\u003cp\u003eNote that $\\gamma$ here is the reciprocal of the serial interval (\u003ca href=\"https://wwwnc.cdc.gov/eid/article/26/6/20-0357_article\"\u003eabout 4 days for COVID19\u003c/a\u003e), and $k_{t-1}$ is the number of new cases observed in the time interval $t-1$.\u003c/p\u003e\n\u003cp\u003eWe can use this expression for $\\lambda$ and reformulate the likelihood function in terms of $R_t$.\u003c/p\u003e\n\u003cp\u003e$$\\mathcal{L}\\left(R_t|k\\right) = \\frac{\\lambda^k e^{-\\lambda}}{k!}$$\u003c/p\u003e\n\u003cp\u003eBefore we move on, let us set up some core parameters.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-python\"\u003e# r_t_range is a vector of possible values for R_t\nR_T_MAX = 12\nr_t_range = seq(0, R_T_MAX, length = R_T_MAX*100 + 1)\n\n# Gamma is 1/serial interval\n# https://wwwnc.cdc.gov/eid/article/26/6/20-0357_article\nGAMMA = 1/4\n\n# New cases by day\nk =  c(20, 40, 55, 90)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe code below showcases a more computationally efficient way to compute the likelihoods. Rather than generating the lambdas and likelihoods for each combination separately, we use the vectorized nature of functions in R, and the ability to have nested dataframes. This allows us to generate a vector of lambdas and likelihoods for each day, and then use \u003ccode\u003etidyr::unnest\u003c/code\u003e to unpack it into a flat table.\u003c/p\u003e\n\u003cp\u003eApart from the computational efficiency, I would argue that this code is more readable and translates the mathematical formulae with minimal overhead.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-python\"\u003elikelihoods \u0026lt;- tibble(day = seq_along(k) - 1, k = k) %\u0026gt;%\n  # Compute a vector of likelihoods\n  mutate(\n    r_t = list(r_t_range),\n    lambda = map(lag(k, 1), ~ .x * exp(GAMMA * (r_t_range - 1))),\n    likelihood_r_t = map2(k, lambda, ~ dpois(.x, .y)/sum(dpois(.x, .y)))\n  ) %\u0026gt;%\n  # Ignore the 0th day\n  filter(day \u0026gt; 0) %\u0026gt;%\n  # Unnest the data to flatten it.\n  select(-lambda) %\u0026gt;%\n  unnest(c(r_t, likelihood_r_t))\n\ndisplay_random(likelihoods)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"output_wrapper\"\u003e\u003ctable class='dataframe'\u003e\n \u003cthead\u003e\n  \u003ctr\u003e\n   \u003cth style=\"text-align:right;\"\u003e day \u003c/th\u003e\n   \u003cth style=\"text-align:right;\"\u003e k \u003c/th\u003e\n   \u003cth style=\"text-align:right;\"\u003e r_t \u003c/th\u003e\n   \u003cth style=\"text-align:right;\"\u003e likelihood_r_t \u003c/th\u003e\n  \u003c/tr\u003e\n \u003c/thead\u003e\n\u003ctbody\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 40 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 7.26 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.0000000 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 40 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 2.54 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.0011292 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 2 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 55 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 3.54 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.0003426 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 2 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 55 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 5.62 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.0000000 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 40 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 7.03 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.0000000 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 3 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 90 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 10.84 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.0000000 \u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/div\u003e\n\n\n\u003cp\u003eWe can now plot the likelihood conditional on the number of new cases observed.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-python\"\u003elikelihoods %\u0026gt;%  \n  ggplot(aes(x = r_t, y = likelihood_r_t, color = factor(k))) +\n  geom_line() +\n  labs(\n    title = expression(paste(\u0026quot;Likelihood of R\u0026quot;[t], \u0026quot; given k\u0026quot;)),\n    subtitle = expression(paste(\u0026quot;L(R\u0026quot;[t], \u0026quot;|k)\u0026quot;)),\n    x = expression(\u0026quot;R\u0026quot;[t]),\n    y = NULL, color = \u0026#39;k\u0026#39;\n  )\n\u003c/code\u003e\u003c/pre\u003e\n\u003ccenter\u003e\u003cimg src=\"https://res.cloudinary.com/dyd911kmh/image/upload/f_auto,q_auto:best/v1587080366/output_20_0_xq1fvw.png\" /\u003e\u003c/center\u003e\n\n\n\u003ch3 id=\"estimating-r_t-\"\u003eEstimating $R_t$\u003c/h3\u003e\n\u003cp\u003eWe have made good progress in linking the number of new cases, $k$, and the effective infection rate, $R_t$. However, we still don\u0026#39;t have a tangible approach to estimate its values from the time series of observed new cases. Here is where the ubiquitous \u003ca href=\"https://en.wikipedia.org/wiki/Bayes%27_theorem\"\u003eBayes\u0026#39; rule\u003c/a\u003e comes extremely handy. Bettencourt \u0026amp; Ribeiro express the probability distribution of $R_t$ as\u003c/p\u003e\n\u003cp\u003e$$ P(R_t|k_t)=\\frac{P(R_t)\\cdot\\mathcal{L}(k_t|R_t)}{P(k_t)} $$\u003c/p\u003e\n\u003cp\u003eKevin unpacks this complex equation in much simpler terms.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThis says that, having seen  ùëò  new cases, we believe the distribution of  ùëÖùë°  is equal to:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe \u003cstrong\u003eprior\u003c/strong\u003e beliefs of the value of $P(R_t)$ without the data ...\u003c/li\u003e\n\u003cli\u003etimes the \u003cstrong\u003elikelihood\u003c/strong\u003e of seeing $k$ new cases given $R_t$ ...\u003c/li\u003e\n\u003cli\u003edivided by the probability of seeing this many cases in general.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eIf we use the posterior probability of the previous period, $P(R_{t-1} | k_{t-1})$, as the prior, $P(R_t)$, for the current period, then we can rewrite the previous equation as:\u003c/p\u003e\n\u003cp\u003e$$ P(R_t|k_t) \\propto P(R_{t-1}|k_{t-1})\\cdot\\mathcal{L}(k_t|R_t) $$\u003c/p\u003e\n\u003cp\u003eIterating across periods all the way back to $t = 0$, we get\u003c/p\u003e\n\u003cp\u003e$$ P(R_t|k_t) \\propto P(R_0) \\cdot {\\displaystyle \\prod^{T}_{t=0}}\\mathcal{L}(k_t|R_t) $$\u003c/p\u003e\n\u003cp\u003eWith a uniform prior $P(R_0)$, this reduces to:\u003c/p\u003e\n\u003cp\u003e$$ P(R_t|k_t) \\propto {\\displaystyle \\prod^{T}_{t=0}}\\mathcal{L}\\left(k_t|R_t\\right) $$\u003c/p\u003e\n\u003cp\u003eWe can now use this mathematical expression to compute the posterior from the likelihoods. Once again, we use the vectorized function \u003ccode\u003ecumprod\u003c/code\u003e to generate posteriors for all days at once, and then normalize it.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-python\"\u003eposteriors \u0026lt;- likelihoods %\u0026gt;%\n  group_by(r_t) %\u0026gt;%\n  arrange(day) %\u0026gt;%\n  mutate(posterior = cumprod(likelihood_r_t)) %\u0026gt;%\n  group_by(k) %\u0026gt;%\n  mutate(posterior = posterior / sum(posterior)) %\u0026gt;%\n  ungroup()\n\ndisplay_random(posteriors)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"output_wrapper\"\u003e\u003ctable class='dataframe'\u003e\n \u003cthead\u003e\n  \u003ctr\u003e\n   \u003cth style=\"text-align:right;\"\u003e day \u003c/th\u003e\n   \u003cth style=\"text-align:right;\"\u003e k \u003c/th\u003e\n   \u003cth style=\"text-align:right;\"\u003e r_t \u003c/th\u003e\n   \u003cth style=\"text-align:right;\"\u003e likelihood_r_t \u003c/th\u003e\n   \u003cth style=\"text-align:right;\"\u003e posterior \u003c/th\u003e\n  \u003c/tr\u003e\n \u003c/thead\u003e\n\u003ctbody\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 3 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 90 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 5.85 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.0000000 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.0000000 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 3 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 90 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 2.35 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.0033847 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.0025235 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 3 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 90 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 7.68 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.0000000 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.0000000 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 2 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 55 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.01 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.0000047 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.0000000 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 40 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.79 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.0000009 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.0000009 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 3 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 90 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 10.81 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.0000000 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.0000000 \u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/div\u003e\n\n\n\u003cp\u003eWe can now visualize the posterior distribution.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-python\"\u003eposteriors %\u0026gt;%\n  ggplot(aes(x = r_t, y = posterior, color = factor(day))) +\n  geom_line() +\n  labs(\n    title = expression(paste(\u0026quot;Posterior probability of R\u0026quot;[t], \u0026quot; given k\u0026quot;)),\n    subtitle = expression(paste(\u0026quot;P(R\u0026quot;[t], \u0026quot;| k)\u0026quot;)),\n    x = expression(\u0026quot;R\u0026quot;[t]), y = NULL, color = \u0026#39;day\u0026#39;\n  )\n\u003c/code\u003e\u003c/pre\u003e\n\u003ccenter\u003e\u003cimg src=\"https://res.cloudinary.com/dyd911kmh/image/upload/f_auto,q_auto:best/v1587080366/output_25_0_pu0oiu.png\" /\u003e\u003c/center\u003e\n\n\n\u003cp\u003eThese posteriors now allow us to answer the all important question:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eWhat is the most likely value of $R_t$ each day?\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eWhile estimating any quantity, it is very important to provide a sense of the error surrounding the estimate. A popular way of doing this is to use \u003ca href=\"https://www.sciencedirect.com/topics/mathematics/highest-density-interval\"\u003ehighest density intervals\u003c/a\u003e.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eAnother way of summarizing a distribution is the highest density interval, which summarizes the distribution by specifying an interval that spans most of the distribution, say 95% of it, such that every point inside the interval has higher credibility than any point outside the interval.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eIn his article, Kevin implemented a brute force algorithm to compute HDI. R users are more fortunate that there is already a package, \u003ccode\u003eHDInterval\u003c/code\u003e, out there with an implementation üéâ.\u003c/p\u003e\n\u003cp\u003eWe will now estimate the most likely value of $R_t$, and the highest density interval surrounding it. Since the \u003ccode\u003eHDInterval::hdi\u003c/code\u003e function only works with a vector of random values from a distribution, and we only estimated the posterior probabilities, we will need to simulate random values of $R_t$ using the posterior probabilities in order to compute the highest-density intervals.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-python\"\u003e# Install and load HDInterval package\ninstall.packages(\u0026quot;HDInterval\u0026quot;)\nlibrary(HDInterval)\n\n# Compute the most likely value of r_t and the highest-density interval\nestimates \u0026lt;- posteriors %\u0026gt;%\n  group_by(day) %\u0026gt;%\n  summarize(\n    r_t_simulated = list(sample(r_t_range, 10000, replace = TRUE, prob = posterior)),\n    r_t_most_likely = r_t_range[which.max(posterior)]\n  ) %\u0026gt;%\n  mutate(\n    r_t_lo = map_dbl(r_t_simulated, ~ hdi(.x)[1]),\n    r_t_hi = map_dbl(r_t_simulated, ~ hdi(.x)[2])\n  ) %\u0026gt;%\n  select(-r_t_simulated)\n\ndisplay_head(estimates)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode\u003eInstalling package into ‚Äò/usr/local/lib/R/site-library‚Äô\n(as ‚Äòlib‚Äô is unspecified)\n\u003c/code\u003e\u003c/pre\u003e\u003cdiv class=\"output_wrapper\"\u003e\u003ctable class='dataframe'\u003e\n \u003cthead\u003e\n  \u003ctr\u003e\n   \u003cth style=\"text-align:right;\"\u003e day \u003c/th\u003e\n   \u003cth style=\"text-align:right;\"\u003e r_t_most_likely \u003c/th\u003e\n   \u003cth style=\"text-align:right;\"\u003e r_t_lo \u003c/th\u003e\n   \u003cth style=\"text-align:right;\"\u003e r_t_hi \u003c/th\u003e\n  \u003c/tr\u003e\n \u003c/thead\u003e\n\u003ctbody\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 3.77 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 2.45 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 4.96 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 2 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 2.84 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 2.04 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 3.65 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 3 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 2.90 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 2.28 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 3.44 \u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/div\u003e\n\n\n\u003cp\u003eWe can visualize these estimates and the uncertainty surrounding them using a line plot with ribbons.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-python\"\u003eestimates %\u0026gt;%\n  ggplot(aes(x = day, y = r_t_most_likely)) +\n  geom_point(color = \u0026quot;#ffc844\u0026quot;, size = 5) +\n  geom_line(color = \u0026#39;black\u0026#39;) +\n  geom_ribbon(aes(ymin = r_t_lo, ymax = r_t_hi), fill = \u0026quot;#ffc844\u0026quot;, alpha = 0.3) +\n  labs(\n    title = expression(paste(\u0026#39;R\u0026#39;[t], \u0026#39; by day\u0026#39;)),\n    subtitle = \u0026quot;The band represents the highest density interval\u0026quot;,\n    x = \u0026#39;Day\u0026#39;, y = NULL\n  )\n\u003c/code\u003e\u003c/pre\u003e\n\u003ccenter\u003e\u003cimg src=\"https://res.cloudinary.com/dyd911kmh/image/upload/f_auto,q_auto:best/v1587080366/output_29_0_knpcet.png\" /\u003e\u003c/center\u003e\n\n\n\u003cp\u003eWhile Bettencourt and Ribeiro\u0026#39;s approach works fine, Kevin points out a practical problem with it (that is also noted in the paper), that it is possible for the \u003cstrong\u003eposterior to get stuck and asympotically approach 1\u003c/strong\u003e, due to its inability to forget the times with a high $R_t$.\u003c/p\u003e\n\u003cp\u003eTo counter this problem, Kevin suggests the following approach.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eSo, I propose to only incorporate the last $m$ days of the likelihood function. By doing this, the algorithm\u0026#39;s prior is built based on the recent past which is a much more useful prior than the entire history of the epidemic. So this simple, but important change leads to the following:\n$$ P(R_t|k_t) \\propto {\\displaystyle \\prod^{T}_{t=T-m}}\\mathcal{L}\\left(k_t|R_t\\right) $$\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eWe will use this modification to estimate the values of $R_t$ across different states in the US.\u003c/p\u003e\n\u003ch2 id=\"application-to-us-data\"\u003eApplication to US Data\u003c/h2\u003e\n\u003cp\u003eIt is now time to take all this machinery we built and apply it on COVID data from US states to estimate the effective infection rate, $R_t$. Let us begin by fetching the data. We will use the COVID dataset for the US constructed by the New York Times.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-python\"\u003eurl = \u0026#39;https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-states.csv\u0026#39;\ncovid_cases \u0026lt;- readr::read_csv(url)\n\ndisplay_head(covid_cases)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode\u003eParsed with column specification:\ncols(\n  date = \u001b[34mcol_date(format = \u0026quot;\u0026quot;)\u001b[39m,\n  state = \u001b[31mcol_character()\u001b[39m,\n  fips = \u001b[31mcol_character()\u001b[39m,\n  cases = \u001b[32mcol_double()\u001b[39m,\n  deaths = \u001b[32mcol_double()\u001b[39m\n)\n\u003c/code\u003e\u003c/pre\u003e\u003cdiv class=\"output_wrapper\"\u003e\u003ctable class='dataframe'\u003e\n \u003cthead\u003e\n  \u003ctr\u003e\n   \u003cth style=\"text-align:left;\"\u003e date \u003c/th\u003e\n   \u003cth style=\"text-align:left;\"\u003e state \u003c/th\u003e\n   \u003cth style=\"text-align:left;\"\u003e fips \u003c/th\u003e\n   \u003cth style=\"text-align:right;\"\u003e cases \u003c/th\u003e\n   \u003cth style=\"text-align:right;\"\u003e deaths \u003c/th\u003e\n  \u003c/tr\u003e\n \u003c/thead\u003e\n\u003ctbody\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-01-21 \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e Washington \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 53 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-01-22 \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e Washington \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 53 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-01-23 \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e Washington \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 53 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-01-24 \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e Illinois \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 17 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-01-24 \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e Washington \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 53 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-01-25 \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e California \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 06 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0 \u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/div\u003e\n\n\n\u003ch3 id=\"smooth-new-cases\"\u003eSmooth new cases\u003c/h3\u003e\n\u003cp\u003eThe first step is to prepare the data by computing the number of new cases every day, and smoothing it over a rolling window. The smoothing is essential to account for lags in reporting. The lag has been found to be especially pronounced over weekends.\u003c/p\u003e\n\u003cp\u003eFollowing Kevin\u0026#39;s approach, I utilize a gaussian smoother with a 7-day rolling window.\u003c/p\u003e\n\u003cp\u003eNote that we will implement all data processing steps as standalone functions. While this adds some overhead, it will allow us to compose these steps cleanly, and also apply them across one or more states, which will come very handy.\u003c/p\u003e\n\u003cp\u003eWe will apply these steps to one selected state, so it is easier to look at the results and make sense out of them. I have selected New York, but feel free to switch it to a state of your choice!\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-python\"\u003e# Install the smoother package\ninstall.packages(\u0026quot;smoother\u0026quot;)\n\n#\u0026#39; Compute new cases and smooth them\nsmooth_new_cases \u0026lt;- function(cases){\n  cases %\u0026gt;%\n    arrange(date) %\u0026gt;%\n    mutate(new_cases = c(cases[1], diff(cases))) %\u0026gt;%\n    mutate(new_cases_smooth = round(\n      smoother::smth(new_cases, window = 7, tails = TRUE)\n    )) %\u0026gt;%\n    select(state, date, new_cases, new_cases_smooth)\n}\n\nstate_selected \u0026lt;- \u0026quot;New York\u0026quot;\ncovid_cases %\u0026gt;%\n  filter(state == state_selected) %\u0026gt;%\n  smooth_new_cases() %\u0026gt;%\n  display_head()\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode\u003eInstalling package into ‚Äò/usr/local/lib/R/site-library‚Äô\n(as ‚Äòlib‚Äô is unspecified)\n\u003c/code\u003e\u003c/pre\u003e\u003cdiv class=\"output_wrapper\"\u003e\u003ctable class='dataframe'\u003e\n \u003cthead\u003e\n  \u003ctr\u003e\n   \u003cth style=\"text-align:left;\"\u003e state \u003c/th\u003e\n   \u003cth style=\"text-align:left;\"\u003e date \u003c/th\u003e\n   \u003cth style=\"text-align:right;\"\u003e new_cases \u003c/th\u003e\n   \u003cth style=\"text-align:right;\"\u003e new_cases_smooth \u003c/th\u003e\n  \u003c/tr\u003e\n \u003c/thead\u003e\n\u003ctbody\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e New York \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-03-01 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e New York \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-03-02 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 2 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e New York \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-03-03 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 4 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e New York \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-03-04 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 9 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 9 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e New York \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-03-05 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 11 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 15 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e New York \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-03-06 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 22 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 23 \u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/div\u003e\n\n\n\u003cp\u003eLet us plot the raw values as well as the smoothed values for \u003ccode\u003enew_cases\u003c/code\u003e so we can visualize what the smoothing process is doing.\u003c/p\u003e\n\u003cp\u003eüé© It is always good practice to visualize the results after you make some data transformations. This allows you to build intuition and also sanity check that your transformation is doing what you intended it to do!\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-python\"\u003eplot_new_cases \u0026lt;- function(cases){\n  cases %\u0026gt;%\n    ggplot(aes(x = date, y = new_cases)) +\n    geom_line(linetype = \u0026#39;dotted\u0026#39;, color = \u0026#39;gray40\u0026#39;) +\n    geom_line(aes(y = new_cases_smooth), color = \u0026quot;#14243e\u0026quot;) +\n    labs(\n      title = \u0026quot;New cases per day\u0026quot;,\n      subtitle = unique(cases$state),\n      x = NULL, y = NULL\n    )\n}\n\ncovid_cases %\u0026gt;%\n  filter(state == state_selected) %\u0026gt;%\n  smooth_new_cases() %\u0026gt;%\n  plot_new_cases()\n\u003c/code\u003e\u003c/pre\u003e\n\u003ccenter\u003e\u003cimg src=\"https://res.cloudinary.com/dyd911kmh/image/upload/f_auto,q_auto:best/v1587080366/output_36_0_g8lpdt.png\" /\u003e\u003c/center\u003e\n\n\n\u003ch3 id=\"compute-likelihoods\"\u003eCompute Likelihoods\u003c/h3\u003e\n\u003cp\u003eThe second step is to compute the likelihoods. We will use the same approach we followed previously, but with one notable difference. We will compute log-likelihoods instead of the likelihoods. This will make it easier to smooth them over a rolling window to apply the modification suggested by Kevin, of only using the latest $m$ intervals to compute $R_t$.\u003c/p\u003e\n\u003cp\u003eAs before, we will compute the likelihoods for each day as a nested list and then flatten the results to a table using \u003ccode\u003etidyr::unnest\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eüé©List columns are extremely handy when working with data. The design pattern used here is very useful in many situations.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-python\"\u003ecompute_likelihood \u0026lt;- function(cases){\n  likelihood \u0026lt;- cases %\u0026gt;%\n    filter(new_cases_smooth \u0026gt; 0) %\u0026gt;%\n    mutate(\n      r_t = list(r_t_range),\n      lambda = map(lag(new_cases_smooth, 1), ~ .x * exp(GAMMA * (r_t_range - 1))),\n      likelihood_r_t = map2(new_cases_smooth, lambda, dpois, log = TRUE)\n    ) %\u0026gt;%\n    slice(-1) %\u0026gt;%\n    select(-lambda) %\u0026gt;%\n    unnest(c(likelihood_r_t, r_t))\n}\n\ncovid_cases %\u0026gt;%\n  filter(state == state_selected) %\u0026gt;%\n  smooth_new_cases() %\u0026gt;%\n  compute_likelihood() %\u0026gt;%\n  display_random()\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"output_wrapper\"\u003e\u003ctable class='dataframe'\u003e\n \u003cthead\u003e\n  \u003ctr\u003e\n   \u003cth style=\"text-align:left;\"\u003e state \u003c/th\u003e\n   \u003cth style=\"text-align:left;\"\u003e date \u003c/th\u003e\n   \u003cth style=\"text-align:right;\"\u003e new_cases \u003c/th\u003e\n   \u003cth style=\"text-align:right;\"\u003e new_cases_smooth \u003c/th\u003e\n   \u003cth style=\"text-align:right;\"\u003e r_t \u003c/th\u003e\n   \u003cth style=\"text-align:right;\"\u003e likelihood_r_t \u003c/th\u003e\n  \u003c/tr\u003e\n \u003c/thead\u003e\n\u003ctbody\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e New York \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-03-24 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 4790 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 5677 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 5.36 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e -4010.9111 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e New York \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-03-21 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 3254 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 3614 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 7.33 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e -5054.4656 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e New York \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-04-07 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 9378 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 9094 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 5.90 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e -10331.2552 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e New York \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-03-13 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 95 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 118 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 7.01 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e -144.3349 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e New York \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-04-10 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 10575 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 9895 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 11.69 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e -107594.6949 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e New York \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-04-10 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 10575 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 9895 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 8.46 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e -35816.2131 \u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/div\u003e\n\n\n\u003ch3 id=\"compute-posteriors\"\u003eCompute Posteriors\u003c/h3\u003e\n\u003cp\u003eThe third step is to compute the posterior probabilities. Recall that\u003c/p\u003e\n\u003cp\u003e$$ P(R_t|k_t) \\propto {\\displaystyle \\prod^{T}_{t=T-m}}\\mathcal{L}\\left(k_t|R_t\\right) $$\u003c/p\u003e\n\u003cp\u003eWe can rewrite this in terms of the log-likelihoods\u003c/p\u003e\n\u003cp\u003e$$ P(R_t|k_t) \\propto {\\displaystyle \\exp \\big( \\sum^{T}_{t=T-m}}\\log(\\mathcal{L}\\left(k_t|R_t\\right)) \\big) $$\u003c/p\u003e\n\u003cp\u003eWe can use the \u003ccode\u003erollapplyr\u003c/code\u003e function from the \u003ccode\u003ezoo\u003c/code\u003e package to compute a rolling 7-day sum of the log likelihoods, and then exponentiate it to compute the posterior. Finally, we normalize the posteriors to 1.0.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-python\"\u003ecompute_posterior \u0026lt;- function(likelihood){\n  likelihood %\u0026gt;%\n    arrange(date) %\u0026gt;%\n    group_by(r_t) %\u0026gt;%\n    mutate(posterior = exp(\n      zoo::rollapplyr(likelihood_r_t, 7, sum, partial = TRUE)\n    )) %\u0026gt;%\n    group_by(date) %\u0026gt;%\n    mutate(posterior = posterior / sum(posterior, na.rm = TRUE)) %\u0026gt;%\n    # HACK: NaNs in the posterior create issues later on. So we remove them.\n    mutate(posterior = ifelse(is.nan(posterior), 0, posterior)) %\u0026gt;%\n    ungroup() %\u0026gt;%\n    select(-likelihood_r_t)\n}\n\ncovid_cases %\u0026gt;%\n  filter(state == state_selected) %\u0026gt;%\n  smooth_new_cases() %\u0026gt;%\n  compute_likelihood() %\u0026gt;%\n  compute_posterior() %\u0026gt;%\n  display_random()\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"output_wrapper\"\u003e\u003ctable class='dataframe'\u003e\n \u003cthead\u003e\n  \u003ctr\u003e\n   \u003cth style=\"text-align:left;\"\u003e state \u003c/th\u003e\n   \u003cth style=\"text-align:left;\"\u003e date \u003c/th\u003e\n   \u003cth style=\"text-align:right;\"\u003e new_cases \u003c/th\u003e\n   \u003cth style=\"text-align:right;\"\u003e new_cases_smooth \u003c/th\u003e\n   \u003cth style=\"text-align:right;\"\u003e r_t \u003c/th\u003e\n   \u003cth style=\"text-align:right;\"\u003e posterior \u003c/th\u003e\n  \u003c/tr\u003e\n \u003c/thead\u003e\n\u003ctbody\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e New York \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-04-14 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 7177 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 8311 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.51 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.0000000 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e New York \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-03-19 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1770 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1921 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 11.62 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.0000000 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e New York \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-03-25 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 7401 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 6094 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 5.46 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.0000000 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e New York \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-03-22 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 4812 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 4455 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.53 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.0000000 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e New York \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-03-20 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 2950 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 2753 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 8.64 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.0000000 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e New York \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-03-05 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 11 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 15 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 2.44 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.0020211 \u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/div\u003e\n\n\n\u003cp\u003eLet us visualize the posterior probabilities we computed. Note how we set \u003ccode\u003ealpha = 0.2\u003c/code\u003e to reduce the amount of overplotting. This allows us to visualize the shifting posteriors.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-python\"\u003eplot_posteriors \u0026lt;- function(posteriors){\n  posteriors %\u0026gt;%\n    ggplot(aes(x = r_t, y = posterior, group = date)) +\n    geom_line(alpha = 0.2) +\n    labs(\n      title = expression(paste(\u0026quot;Daily Posterior of R\u0026quot;[t], \u0026quot; by day\u0026quot;)),\n      subtitle = unique(posteriors$state),\n      x = \u0026#39;\u0026#39;,\n      y = \u0026#39;\u0026#39;\n    ) +\n    coord_cartesian(xlim = c(0.4, 4)) +\n    theme(legend.position = \u0026#39;none\u0026#39;)\n}\n\ncovid_cases %\u0026gt;%\n  filter(state == state_selected) %\u0026gt;%\n  smooth_new_cases() %\u0026gt;%\n  compute_likelihood() %\u0026gt;%\n  compute_posterior() %\u0026gt;%\n  plot_posteriors()\n\u003c/code\u003e\u003c/pre\u003e\n\u003ccenter\u003e\u003cimg src=\"https://res.cloudinary.com/dyd911kmh/image/upload/f_auto,q_auto:best/v1587080368/output_42_0_cp294y.png\" /\u003e\u003c/center\u003e\n\n\n\u003ch3 id=\"estimate-rt\"\u003eEstimate Rt\u003c/h3\u003e\n\u003cp\u003eThe final step is to estimate the values of $R_t$ and the highest density intervals surrounding them. Recall that we need to simulate random values for $r_t$ using the posterior probabilities in order to apply the \u003ccode\u003eHDIInterval::hdi\u003c/code\u003e function to compute the highest density intervals.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-python\"\u003e# Estimate R_t and a 95% highest-density interval around it\nestimate_rt \u0026lt;- function(posteriors){\n  posteriors %\u0026gt;%\n    group_by(state, date) %\u0026gt;%\n    summarize(\n      r_t_simulated = list(sample(r_t_range, 10000, replace = TRUE, prob = posterior)),\n      r_t_most_likely = r_t_range[which.max(posterior)]\n    ) %\u0026gt;%\n    mutate(\n      r_t_lo = map_dbl(r_t_simulated, ~ hdi(.x)[1]),\n      r_t_hi = map_dbl(r_t_simulated, ~ hdi(.x)[2])\n    ) %\u0026gt;%\n    select(-r_t_simulated)\n}\n\ncovid_cases %\u0026gt;%\n  filter(state == state_selected) %\u0026gt;%\n  smooth_new_cases() %\u0026gt;%\n  compute_likelihood() %\u0026gt;%\n  compute_posterior() %\u0026gt;%\n  estimate_rt() %\u0026gt;%\n  display_random()\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"output_wrapper\"\u003e\u003ctable class='dataframe'\u003e\n \u003cthead\u003e\n  \u003ctr\u003e\n   \u003cth style=\"text-align:left;\"\u003e state \u003c/th\u003e\n   \u003cth style=\"text-align:left;\"\u003e date \u003c/th\u003e\n   \u003cth style=\"text-align:right;\"\u003e r_t_most_likely \u003c/th\u003e\n   \u003cth style=\"text-align:right;\"\u003e r_t_lo \u003c/th\u003e\n   \u003cth style=\"text-align:right;\"\u003e r_t_hi \u003c/th\u003e\n  \u003c/tr\u003e\n \u003c/thead\u003e\n\u003ctbody\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e New York \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-03-14 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 2.05 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1.68 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 2.36 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e New York \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-03-22 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 2.33 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 2.27 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 2.39 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e New York \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-03-07 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 2.62 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1.73 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 3.46 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e New York \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-03-09 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 2.01 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1.32 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 2.63 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e New York \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-04-04 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1.18 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1.15 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1.21 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e New York \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-04-06 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1.08 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1.05 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1.11 \u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/div\u003e\n\n\n\u003cp\u003eFinally, we come to the moment of truth! Let us visualize the estimated values of $R_t$\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-python\"\u003eplot_estimates \u0026lt;- function(estimates){\n  estimates %\u0026gt;%\n    ggplot(aes(x = date, y = r_t_most_likely)) +\n    geom_point(color = \u0026quot;darkorange\u0026quot;, alpha = 0.8, size = 4) +\n    geom_line(color = \u0026quot;#14243e\u0026quot;) +\n    geom_hline(yintercept = 1, linetype = \u0026#39;dashed\u0026#39;) +\n    geom_ribbon(\n      aes(ymin = r_t_lo, ymax = r_t_hi),\n      fill = \u0026#39;darkred\u0026#39;,\n      alpha = 0.2\n    ) +\n    labs(\n      title = expression(\u0026#39;Real time R\u0026#39;[t]), x = \u0026#39;\u0026#39;, y = \u0026#39;\u0026#39;,\n      subtitle = unique(estimates$state)\n    ) +\n    coord_cartesian(ylim = c(0, 4))\n}\n\ncovid_cases %\u0026gt;%\n  filter(state == state_selected) %\u0026gt;%\n  smooth_new_cases() %\u0026gt;%\n  compute_likelihood() %\u0026gt;%\n  compute_posterior() %\u0026gt;%\n  estimate_rt() %\u0026gt;%\n  plot_estimates()\n\u003c/code\u003e\u003c/pre\u003e\n\u003ccenter\u003e\u003cimg src=\"https://res.cloudinary.com/dyd911kmh/image/upload/f_auto,q_auto:best/v1587080366/output_46_0_ppnxc7.png\" /\u003e\u003c/center\u003e\n\n\n\u003cp\u003eSo how does this compare with the estimates from Kevin\u0026#39;s article. It seems like the initial estimates in my model are off from Kevin\u0026#39;s estimates. However, that could be a function of differences in the smoothing algorithm, or the large uncertainty surrounding the initial estimates. The overall shape of the curve and the peaks seem to match up pretty closely. Mission accomplished! üéâ\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"http://systrom.com/wp-content/uploads/2020/04/image-2.png\" width=\"60%\" align=\"center\"/\u003e\u003c/p\u003e\n\u003ch3 id=\"loop-across-all-states\"\u003eLoop across all states\u003c/h3\u003e\n\u003cp\u003eIt is now time to loop across all states and compute these estimates. We can do this easily by grouping by \u003ccode\u003estate\u003c/code\u003e, splitting the data into one table per state, and using \u003ccode\u003epurrr::map_df\u003c/code\u003e to estimate $R_t$ for each state and combine them back into a single table.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-python\"\u003e# ‚ö†Ô∏èThis function can take a couple of minutes to run\n#   as it loops across all states\nestimates_all \u0026lt;- covid_cases %\u0026gt;%\n  filter(date \u0026gt;= \u0026quot;2020-03-01\u0026quot;) %\u0026gt;%\n  group_by(state) %\u0026gt;%\n  # Ignore states that have not reached 100 infections\n  filter(max(cases) \u0026gt; 100 ) %\u0026gt;%\n  group_split() %\u0026gt;%\n  map_df(~ {\n    .x %\u0026gt;%\n      smooth_new_cases() %\u0026gt;%\n      compute_likelihood() %\u0026gt;%\n      compute_posterior() %\u0026gt;%\n      estimate_rt()\n  }) %\u0026gt;%\n  ungroup()\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"lang-python\"\u003eestimates_all %\u0026gt;%\n  display_random()\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"output_wrapper\"\u003e\u003ctable class='dataframe'\u003e\n \u003cthead\u003e\n  \u003ctr\u003e\n   \u003cth style=\"text-align:left;\"\u003e state \u003c/th\u003e\n   \u003cth style=\"text-align:left;\"\u003e date \u003c/th\u003e\n   \u003cth style=\"text-align:right;\"\u003e r_t_most_likely \u003c/th\u003e\n   \u003cth style=\"text-align:right;\"\u003e r_t_lo \u003c/th\u003e\n   \u003cth style=\"text-align:right;\"\u003e r_t_hi \u003c/th\u003e\n  \u003c/tr\u003e\n \u003c/thead\u003e\n\u003ctbody\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e New Jersey \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-03-15 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 2.72 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 2.01 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 3.42 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e Alaska \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-04-02 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.80 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.04 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1.54 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e Maryland \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-03-12 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1.67 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.00 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 3.33 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e Washington \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-03-10 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 2.01 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1.49 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 2.52 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e New Mexico \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-03-28 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1.58 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 0.89 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 2.17 \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd style=\"text-align:left;\"\u003e South Dakota \u003c/td\u003e\n   \u003ctd style=\"text-align:left;\"\u003e 2020-04-08 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1.63 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 1.12 \u003c/td\u003e\n   \u003ctd style=\"text-align:right;\"\u003e 2.09 \u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/div\u003e\n\n\n\u003cp\u003eWe can now create a small multiples plot of the estimates across all states. The use of \u003ccode\u003eggplot2\u003c/code\u003e makes this really easy and all we had to add was an extra line of code!\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-python\"\u003e# Increase plot height and width\noptions(repr.plot.height = 40, repr.plot.width = 20)\nestimates_all %\u0026gt;%\n  plot_estimates() +\n  facet_wrap(~ state, ncol = 4) +\n  labs(subtitle = \u0026quot;\u0026quot;)\n\n# Reset plot dimensions\noptions(repr.plot.height = 12, repr.plot.width = 8)\n\u003c/code\u003e\u003c/pre\u003e\n\u003ccenter\u003e\u003cimg src=\"https://res.cloudinary.com/dyd911kmh/image/upload/f_auto,q_auto:best/v1587080368/output_52_0_wz69k9.png\" /\u003e\u003c/center\u003e\n\n\n\u003cp\u003eWhile the small multiples plot is perfect, it is hard to navigate to a state based on its geographic location. What if we could plot each state close to its geographic location?\u003c/p\u003e\n\u003cp\u003eThankfully, Ryan Hafen has  created the \u003ccode\u003egeofacet\u003c/code\u003e package that allows us to lay out these small multiples on a geographic grid with a single line of code.\u003c/p\u003e\n\u003cp\u003e‚ö†Ô∏è Unfortunately, I was not able to install the \u003ccode\u003egeofacet\u003c/code\u003e package on colab (I suspect it is because of system dependencies required by the \u003ccode\u003esf\u003c/code\u003e package), and hence the code chunk below will fail to execute. I have included a saved version of the plot I generated locally, so you can get a sense of how it looks.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-python\"\u003e# ‚ö†Ô∏è CAUTION: This code will error on colab\n# options(repr.plot.height = 40, repr.plot.width = 20)\n# estimates_all %\u0026gt;%\n#  mutate(state = state.abb[match(state, state.name)]) %\u0026gt;%\n#  plot_estimates() +\n#  geofacet::facet_geo(~ state, ncol = 4) +\n#  labs(subtitle = \u0026quot;\u0026quot;) +\n#  theme(strip.text = element_text(hjust = 0))\n# options(repr.plot.height = 12, repr.plot.width = 8)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"https://i.imgur.com/9Op2GLt.png\" alt=\"geofacet\"\u003e\u003c/p\u003e\n\u003cp\u003eFinally, let us recreate the plot in Kevin\u0026#39;s article that orders the states based on the most likely estimated value of $R_t$, and colors them based on the state of lockdown.\u003c/p\u003e\n\u003cp\u003e‚ö†Ô∏è Please note that this is a purely descriptive plot and one cannot draw any conclusions on the efficacy of lockdowns\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-python\"\u003eoptions(repr.plot.width = 20, repr.plot.height = 8)\nno_lockdown = c(\u0026#39;North Dakota\u0026#39;, \u0026#39;South Dakota\u0026#39;, \u0026#39;Nebraska\u0026#39;, \u0026#39;Iowa\u0026#39;, \u0026#39;Arkansas\u0026#39;)\npartial_lockdown = c(\u0026#39;Utah\u0026#39;, \u0026#39;Wyoming\u0026#39;, \u0026#39;Oklahoma\u0026#39;)\nestimates_all %\u0026gt;%\n  group_by(state) %\u0026gt;%\n  filter(date == max(date)) %\u0026gt;%\n  ungroup() %\u0026gt;%\n  mutate(state = forcats::fct_reorder(state, r_t_most_likely)) %\u0026gt;%\n  mutate(lockdown = case_when(\n    state %in% no_lockdown ~ \u0026#39;None\u0026#39;,\n    state %in% partial_lockdown ~ \u0026#39;Partial\u0026#39;,\n    TRUE ~ \u0026quot;Full\u0026quot;\n  )) %\u0026gt;%\n  ggplot(aes(x = state, y = r_t_most_likely)) +\n  geom_col(aes(fill = lockdown)) +\n  geom_hline(yintercept = 1, linetype = \u0026#39;dotted\u0026#39;) +\n  geom_errorbar(aes(ymin = r_t_lo, ymax = r_t_hi), width = 0.2) +\n  scale_fill_manual(values = c(None = \u0026#39;darkred\u0026#39;, Partial = \u0026#39;gray50\u0026#39;, Full = \u0026#39;gray70\u0026#39;)) +\n  labs(\n    title = expression(paste(\u0026quot;Most Recent R\u0026quot;[t], \u0026quot; by state\u0026quot;)),\n    x = \u0026#39;\u0026#39;, y = \u0026#39;\u0026#39;\n  ) +\n  theme(axis.text.x.bottom = element_text(angle = 90, hjust = 1, vjust = 0.5))\noptions(repr.plot.width = 12, repr.plot.height = 5)\n\u003c/code\u003e\u003c/pre\u003e\n\u003ccenter\u003e\u003cimg src=\"https://res.cloudinary.com/dyd911kmh/image/upload/f_auto,q_auto:best/v1587080366/output_57_0_dwjo9u.png\" /\u003e\u003c/center\u003e\n\n\n\u003ch2 id=\"conclusions-and-next-steps\"\u003eConclusions and Next Steps\u003c/h2\u003e\n\u003cp\u003eIn this article, we replicated Kevin\u0026#39;s analysis in R, using the \u003ccode\u003etidyverse\u003c/code\u003e. We learned some useful tricks to compute likelihoods and posteriors. I learned a ton in this process!\u003c/p\u003e\n\u003cp\u003eI can think of several next steps, but will highlighting one major one that comes to mind. Given that the functions developed in this article rely on a fairly simple input table with three columns: \u003ccode\u003elocation\u003c/code\u003e, \u003ccode\u003edate\u003c/code\u003e, \u003ccode\u003ecases\u003c/code\u003e, an interesting next step would be to turn this into an R package. This will make it easier to estimate $R_t$ for other geographies.\u003c/p\u003e\n\u003cp\u003eI would like to end by thanking \u003ca href=\"https://twitter.com/kevin\"\u003eKevin Systrom\u003c/a\u003e for publishing an interesting post and sharing his code. I would also like to thank my colleagues at \u003ca href=\"http://dataamp.com\"\u003eDataCamp\u003c/a\u003e for their excellent feedback on an initial version of this article.\u003c/p\u003e\n\u003cp\u003eIf you have any feedback/comments on this article, or would like to suggest other extensions, you can find me on twitter \u003ca href=\"https://twitter.com/ramnath_vaidya\"\u003e@ramnath_vaidya\u003c/a\u003e and \u003ca href=\"https://github.com/ramnathv\"\u003egithub\u003c/a\u003e.\u003c/p\u003e\n\u003ccenter\u003e\n\u003ca target=‚Äú_blank‚Äù href=\"https://www.datacamp.com/learn/r/\"\u003e\u003cimg src=\"https://res.cloudinary.com/dyd911kmh/image/upload/f_auto,q_auto:best/v1583330891/r_3_ijnnwq.png\" /\u003e\u003c/a\u003e\n\u003c/center\u003e   \n",
                  "contentUrl": "https://www.datacamp.com/community/tutorials/replicating-in-r-covid19",
                  "userContentUrl": null,
                  "illustrationUrl": null,
                  "seoTitle": "(Tutorial) Estimating COVID-19's ùëÖùë° in Real-Time (Replicating in R)",
                  "seoMetaDescription": " ",
                  "seoKeyword": "r, replicating, r programming, statistics, covid-19",
                  "mustRead": true,
                  "programmingLanguage": null,
                  "submissionDate": "2020-04-16T23:58:49.154Z",
                  "publishDate": "2020-04-17T16:00:00.000Z",
                  "episode": null,
                  "isLatest": null,
                  "externalUrl": null,
                  "transcriptUrl": null,
                  "guests": [],
                  "links": null,
                  "isSpam": false,
                  "xp": 0,
                  "flaggingUsers": [],
                  "isDisabled": false,
                  "connectedInternalContentId": null,
                  "createdAt": "2020-04-16T23:58:49.150Z",
                  "updatedAt": "2020-04-18T00:37:11.348Z",
                  "upvoting": {
                    "voteCount": 28,
                    "voted": false
                  },
                  "tags": ["r programming"],
                  "author": {
                    "id": 837953,
                    "slug": "ramnath",
                    "avatarUrlSquare": "https://assets.datacamp.com/users/avatars/000/837/953/square/ramnathaboutpic.jpg?1493158575",
                    "fullName": "Ramnath Vaidyanathan",
                    "nameFromEmail": "ramnath",
                    "isAdmin": false
                  },
                  "recommendedArticles": []
                },
                "isFetched": true,
                "isFetching": false,
                "statusMessage": ""
              },
              "form": {},
              "list": {
                "isFetched": false,
                "isFetching": false,
                "statusMessage": ""
              },
              "menu": {
                "isSidebarMenuOpen": false
              },
              "notifications": {
                "isFetched": false,
                "isFetching": false,
                "isReadFetched": false,
                "isReadFetching": false,
                "statusMessage": "",
                "readStatusMessage": "",
                "Notifications": [],
                "NotificationsTotal": 0,
                "unReadCount": 0
              },
              "preview": {
                "isFetching": false,
                "isFetched": false,
                "statusMessage": "",
                "content": {}
              },
              "recommendCS": {
                "isPosting": false,
                "isPosted": false,
                "statusMessage": "",
                "isModalOpen": false,
                "currentStep": "form"
              },
              "spam": {
                "isFlagging": false,
                "isSucceeded": false,
                "statusMessage": "",
                "isSpamModalOpen": false,
                "isUnSpamModalOpen": false
              },
              "tag": {
                "isRequesting": false,
                "isSucceeded": false,
                "statusMessage": "",
                "isDeleteTagModalOpen": false
              },
              "tagList": {
                "isFetched": false,
                "isFetching": false,
                "statusMessage": "",
                "list": [],
                "total": 0
              },
              "tagSearch": {
                "isFetching": false,
                "isFetched": false,
                "statusMessage": "",
                "content": {}
              },
              "user": {
                "isFetching": false,
                "isFetched": false,
                "statusMessage": "",
                "unBan": {
                  "isUnBanning": false,
                  "isSucceeded": false,
                  "statusMessage": "",
                  "isUnBanUserModalOpen": false
                },
                "ban": {
                  "isBanning": false,
                  "isSucceeded": false,
                  "statusMessage": "",
                  "isBanUserModalOpen": false
                }
              },
              "submitArticle": {
                "isPosting": false,
                "isPosted": false,
                "statusMessage": "",
                "timer": 0,
                "articleSlug": "",
                "isModalOpen": false,
                "currentStep": "form",
                "slug": "",
                "externalUrl": ""
              },
              "rss": {
                "isCreating": false,
                "isSucceeded": false,
                "statusMessage": ""
              },
              "rssFeedList": {
                "isFetched": false,
                "isFetching": false,
                "statusMessage": "",
                "list": [],
                "disconnectModal": {
                  "isFetched": true,
                  "isFetching": false,
                  "isOpen": false,
                  "rssFeedIdToDisconnect": null,
                  "statusMessage": ""
                }
              },
              "setAsHomePage": {
                "isSetAsHomePageModalOpen": false
              },
              "analytics": {}
            },
            "initialProps": {
              "asPath": "/community/tutorials/replicating-in-r-covid19"
            }
          }
        },
        "page": "/community/tutorial",
        "query": {
          "slug": "replicating-in-r-covid19"
        },
        "buildId": "hfz2jJVqP9kStsLDnKa6g",
        "assetPrefix": "/community",
        "isFallback": false,
        "customServer": true,
        "gip": true
      }
    </script>
    <script
      nomodule=""
      src="../_next/static/chunks/polyfills-ce007b75707b1f3589a8.js"
    ></script>
    <script
      src="../_next/static/chunks/main-f0b5624c3014889b3762.js"
      async=""
    ></script>
    <script
      src="../_next/static/chunks/webpack-8da9cabe58c6d2aa3bdd.js"
      async=""
    ></script>
    <script
      src="../_next/static/chunks/framework.ad7002b3a551c278f5f0.js"
      async=""
    ></script>
    <script
      src="../_next/static/chunks/commons.aeba1b501ee5096455a7.js"
      async=""
    ></script>
    <script
      src="../_next/static/chunks/pages/_app-87c1170f38154f9c4d0d.js"
      async=""
    ></script>
    <script
      src="../_next/static/chunks/ac46388c.70f445eb5557aa9dec72.js"
      async=""
    ></script>
    <script
      src="../_next/static/chunks/68f504b0.bba56c4f391a1db0815a.js"
      async=""
    ></script>
    <script
      src="../_next/static/chunks/78537f27.8279c7505c61cb8fea60.js"
      async=""
    ></script>
    <script
      src="../_next/static/chunks/adf1b103b565b7865a0f98ea967b51b3e3660c18.095266edfcdd9f646efd.js"
      async=""
    ></script>
    <script
      src="../_next/static/chunks/8ffc5858bf71a15f52361e7319c3ad5ceec7c325.576033b2f3878dbe8c10.js"
      async=""
    ></script>
    <script
      src="../_next/static/chunks/1ea862844a52e07ea30f2afd84cc366b3979d6b4.e27afa73a93d521c36e1.js"
      async=""
    ></script>
    <script
      src="../_next/static/chunks/de2bd6607f0d09174f6b5f6ccd214f4f3c8d6fb9.e2051ed48ad4791c2328.js"
      async=""
    ></script>
    <script
      src="../_next/static/chunks/0f6d78b899a1ada8a069577d0a0f2d60f5d91117.4019acfb783e806a75cb.js"
      async=""
    ></script>
    <script
      src="../_next/static/chunks/pages/community/tutorial-ab49573adb58f7e29045.js"
      async=""
    ></script>
    <script
      src="../_next/static/hfz2jJVqP9kStsLDnKa6g/_buildManifest.js"
      async=""
    ></script>
    <script
      src="../_next/static/hfz2jJVqP9kStsLDnKa6g/_ssgManifest.js"
      async=""
    ></script>
    <script type="text/javascript">
      (function () {
        window["__CF$cv$params"] = {
          r: "623ad3daafc70ce5",
          m: "ce6e928719a8132e3244eade09debbded0487c7c-1613683598-1800-ASh5/5dQ3wGm0j2TnlWviCAJZXQDmAvkgpGLuD34m7bp6KLu8GMzJIsnurzv4utghuBinwqiwc4iydiHzW5AJeRXU0MJay1yeJK/a3eYALLiIty4WCrFVnBsiJT9FJiP8iNgMsp5Aiba+lcj2zmbTf9yWkEfWz/BBWKoudbQyoZV",
          s: [0xebed243770, 0x9262a3ae13],
        };
      })();
    </script>
  </body>
  <!-- Mirrored from www.datacamp.com/community/tutorials/replicating-in-r-covid19 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 18 Feb 2021 21:27:24 GMT -->
</html>
